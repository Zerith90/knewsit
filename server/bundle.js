!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=209)}([function(e,t){e.exports=require("lodash")},function(e,t,r){"use strict";(function(t){var n=r(7),i=r(15),o=r(0),s=r(13),a=r(39);global.rootPath=n.normalize(n.join(t,"..","..")),console.log("process.argv: "+process.argv),console.log("Application root path: "+global.rootPath),e.exports={isDevMode:function(){return!process.env.NODE_ENV||"development"===process.env.NODE_ENV},isProductionMode:function(){return"production"===process.env.NODE_ENV},isTestMode:function(){return"test"===process.env.NODE_ENV}};var u={},l=n.join(global.rootPath,"config.js");try{if(!i.existsSync(l)){console.warn(s.yellow.bold("External production configuration not found!. Create a default `config.js` file..."));var c=void 0;o.templateSettings.interpolate=/{{([\s\S]+?)}}/g;var p=o.template(c),h={hashSecret:a(),sessionSecret:a()};i.writeFileSync(l,p(h)),console.warn(s.green.bold("The `config.js` file created! Please update the settings in the file!"))}u=r(159)}catch(e){console.warn(s.red.bold("\r\n==============================================")),console.warn(s.red.bold("  Unable to load external `config.js` file!")),console.warn(s.red.bold(" ",e)),console.warn(s.red.bold("==============================================\r\n")),process.exit(1)}var d=r(127),f={};e.exports.isTestMode()?(console.log("Load test config..."),u={}):e.exports.isProductionMode()&&(console.log("Load production config..."),f=r(128)),e.exports=o.defaultsDeep(u,f,d,e.exports)}).call(t,"server\\config")},function(e,t,r){"use strict";var n=r(206),i=(r(7),r(15)),o=r(68),s=r(1),a=[];if(a.push(new n.transports.Console({level:s.logging.console.level,colorize:!0,prettyPrint:!0,handleExceptions:"production"===process.env.NODE_ENV})),s.logging.logentries.enabled&&s.logging.logentries.token){console.log("Logentries log transport enabled!");r(179)}if(s.logging.papertrail.enabled){console.log("Papertrail log transport enabled!"),r(208).Papertrail;var u=new n.transports.Papertrail(s.logging.papertrail);a.push(u)}if(s.logging.file.enabled){var l=s.logging.file.path;i.existsSync(l)||o(l),s.logging.file.exceptionFile}var c=new n.Logger({level:"debug",transports:a,exitOnError:!1});if(s.logging.loggly.enabled&&s.logging.loggly.token){console.log("Loggly log transport enabled!");r(207)}s.logging.logsene.enabled&&s.logging.logsene.token,s.logging.logzio.enabled&&s.logging.logzio.token,s.logging.graylog.enabled,e.exports=c},function(e,t,r){"use strict";var n=r(4),i=r(38),o=r(0).runInContext(),s=r(118),a=r(177),u=r(43),l=r(167)("Utils"),c=["string","number","boolean"],p=e.exports={inflection:a,_:o,camelizeIf:function(e,t){var r=e;return t&&(r=p.camelize(e)),r},underscoredIf:function(e,t){var r=e;return t&&(r=a.underscore(e)),r},isPrimitive:function(e){return-1!==c.indexOf(typeof e)},mergeDefaults:function(e,t){return o.mergeWith(e,t,function(e,t){if(!this._.isPlainObject(e)&&void 0!==e)return e}.bind(this))},merge:function(){var e={};return Array.prototype.slice.apply(arguments).forEach(function(t){o.forOwn(t,function(t,r){void 0!==t&&(e[r]?o.isPlainObject(t)&&o.isPlainObject(e[r])?e[r]=p.merge(e[r],t):Array.isArray(t)&&Array.isArray(e[r])?e[r]=t.concat(e[r]):e[r]=t:e[r]=t)})}),e},lowercaseFirst:function(e){return e[0].toLowerCase()+e.slice(1)},uppercaseFirst:function(e){return e[0].toUpperCase()+e.slice(1)},spliceStr:function(e,t,r,n){return e.slice(0,t)+n+e.slice(t+r)},camelize:function(e){return e.trim().replace(/[-_\s]+(.)?/g,function(e,t){return t.toUpperCase()})},format:function(e,t){return i.format(e[0],e.slice(1),null,t)},formatNamedParameters:function(e,t,r){return i.formatNamedParameters(e,t,null,r)},cloneDeep:function(e){return e=e||{},o.cloneDeepWith(e,function(e){if(!Array.isArray(e)&&!o.isPlainObject(e))return"object"==typeof e?e:e&&"function"==typeof e.clone?e.clone():void 0})},mapFinderOptions:function(e,t){return t._hasVirtualAttributes&&Array.isArray(e.attributes)&&(e.attributes.forEach(function(r){t._isVirtualAttribute(r)&&t.rawAttributes[r].type.fields&&(e.attributes=e.attributes.concat(t.rawAttributes[r].type.fields))}.bind(t)),e.attributes=o.without.apply(o,[e.attributes].concat(t._virtualAttributes)),e.attributes=o.uniq(e.attributes)),p.mapOptionFieldNames(e,t),e},mapOptionFieldNames:function(e,t){return Array.isArray(e.attributes)&&(e.attributes=e.attributes.map(function(e){return"string"!=typeof e?e:t.rawAttributes[e]&&e!==t.rawAttributes[e].field?[t.rawAttributes[e].field,e]:e})),e.where&&o.isPlainObject(e.where)&&(e.where=p.mapWhereFieldNames(e.where,t)),Array.isArray(e.order)&&e.order.forEach(function(e){var r,n,i;Array.isArray(e)&&(r=t,i="string"==typeof e[e.length-2]?2:1,n=e[e.length-i],e.length>i&&(r=e[e.length-(i+1)],r.model&&(r=r.model)),r.rawAttributes&&r.rawAttributes[n]&&n!==r.rawAttributes[n].field&&(e[e.length-i]=r.rawAttributes[n].field))}),e},mapWhereFieldNames:function(e,t){var r,n;if(e)for(r in e)n=t.rawAttributes[r],n&&n.field!==n.fieldName&&(e[n.field]=e[r],delete e[r]),o.isPlainObject(e[r])&&(e[r]=p.mapOptionFieldNames({where:e[r]},t).where),Array.isArray(e[r])&&(e[r]=e[r].map(function(e){return o.isPlainObject(e)?p.mapWhereFieldNames(e,t):e}));return e},mapValueFieldNames:function(e,t,r){var n={};return t.forEach(function(t){void 0===e[t]||r._isVirtualAttribute(t)||(r.rawAttributes[t]&&r.rawAttributes[t].field&&r.rawAttributes[t].field!==t?n[r.rawAttributes[t].field]=e[t]:n[t]=e[t])}),n},isColString:function(e){return"string"==typeof e&&"$"===e.substr(0,1)&&"$"===e.substr(e.length-1,1)},argsArePrimaryKeys:function(e,t){var r=e.length===Object.keys(t).length;return r&&p._.each(e,function(e){r&&(r=-1!==["number","string"].indexOf(typeof e)||(e instanceof Date||Buffer.isBuffer(e)))}),r},canTreatArrayAsAnd:function(e){return e.reduce(function(e,t){return e||p._.isPlainObject(t)},!1)},combineTableNames:function(e,t){return e.toLowerCase()<t.toLowerCase()?e+t:t+e},singularize:function(e){return a.singularize(e)},pluralize:function(e){return a.pluralize(e)},removeCommentsFromFunctionString:function(e){return e=e.replace(/\s*(\/\/.*)/g,""),e=e.replace(/(\/\*[\n\r\s\S]*?\*\/)/gm,"")},toDefaultValue:function(e){if("function"==typeof e){var t=e();return t instanceof n.ABSTRACT?t.toSql():t}return e instanceof n.UUIDV1?u.v1():e instanceof n.UUIDV4?u.v4():e instanceof n.NOW?p.now():o.isPlainObject(e)||o.isArray(e)?o.clone(e):e},defaultValueSchemable:function(e){return void 0!==e&&(!(e instanceof n.NOW)&&(!(e instanceof n.UUIDV1||e instanceof n.UUIDV4)&&!o.isFunction(e)))},removeNullValuesFromHash:function(e,t,r){var n=e;if(r=r||{},r.allowNull=r.allowNull||[],t){var i={};p._.forIn(e,function(e,t){(r.allowNull.indexOf(t)>-1||t.match(/Id$/)||null!==e&&void 0!==e)&&(i[t]=e)}),n=i}return n},inherit:function(e,t){return t.constructor===Function?(e.prototype=new t,e.prototype.constructor=e,e.prototype.parent=t.prototype):(e.prototype=t,e.prototype.constructor=e,e.prototype.parent=t),e},stack:function e(){var t=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t};var r=new Error;Error.captureStackTrace(r,e);var n=r.stack;return Error.prepareStackTrace=t,n},sliceArgs:function(e,t){t=t||0;for(var r=new Array(e.length-t),n=t;n<e.length;++n)r[n-t]=e[n];return r},now:function(e){var t=new Date;return-1===["postgres","sqlite"].indexOf(e)&&t.setMilliseconds(0),t},tick:function(e){(global.hasOwnProperty("setImmediate")?global.setImmediate:process.nextTick)(e)},TICK_CHAR:"`",addTicks:function(e,t){return(t=t||p.TICK_CHAR)+p.removeTicks(e,t)+t},removeTicks:function(e,t){return t=t||p.TICK_CHAR,e.replace(new RegExp(t,"g"),"")},fn:function(e,t){this.fn=e,this.args=t},col:function(e){arguments.length>1&&(e=this.sliceArgs(arguments)),this.col=e},cast:function(e,t){this.val=e,this.type=(t||"").trim()},literal:function(e){this.val=e},json:function(e,t){p._.isObject(e)?this.conditions=e:(this.path=e,t&&(this.value=t))},where:function(e,t,r){void 0===r&&(r=t,t="="),this.attribute=e,this.comparator=t,this.logic=r},validateParameter:s,formatReferences:function(e){return o.isPlainObject(e.references)||(l('Non-object references property found. Support for that will be removed in version 4. Expected { references: { model: "value", key: "key" } } instead of { references: "value", referencesKey: "key" }.'),e.references={model:e.references,key:e.referencesKey,deferrable:e.referencesDeferrable},e.referencesKey=void 0,e.referencesDeferrable=void 0),e}};p.where.prototype._isSequelizeMethod=p.literal.prototype._isSequelizeMethod=p.cast.prototype._isSequelizeMethod=p.fn.prototype._isSequelizeMethod=p.col.prototype._isSequelizeMethod=p.json.prototype._isSequelizeMethod=!0,p.fn.prototype.clone=function(){return new p.fn(this.fn,this.args)},p.Promise=r(5)},function(e,t,r){"use strict";var n=r(8),i=r(0),o=r(199),s=r(6),a={},u=r(44),l=r(42),c=r(11),p=function(e){};p.prototype.dialectTypes="",p.prototype.toString=function(e){return this.toSql(e)},p.prototype.toSql=function(){return this.key},p.warn=function(e,t){a[t]||(a[t]=!0,console.warn(">> WARNING:",t,"\n>> Check:",e))},p.prototype.stringify=function(e,t){return this.$stringify?this.$stringify(e,t):e},p.inherits=function(e){var t=this;return e||(e=function(){if(!(this instanceof e)){var r=[null].concat(arguments);return new(e.bind.apply(e,r))}t.apply(this,arguments)}),n.inherits(e,t),i.extend(e,this),e};var h=p.inherits(function(e,t){var r="object"==typeof e&&e||{length:e,binary:t};if(!(this instanceof h))return new h(r);this.options=r,this._binary=r.binary,this._length=r.length||255});h.prototype.key=h.key="STRING",h.prototype.toSql=function(){return"VARCHAR("+this._length+")"+(this._binary?" BINARY":"")},h.prototype.validate=function(e){if("[object String]"!==Object.prototype.toString.call(e)){if(this.options.binary&&Buffer.isBuffer(e)||i.isNumber(e))return!0;throw new s.ValidationError(n.format("%j is not a valid string",e))}return!0},Object.defineProperty(h.prototype,"BINARY",{get:function(){return this._binary=!0,this.options.binary=!0,this}});var d=h.inherits(function(e,t){var r="object"==typeof e&&e||{length:e,binary:t};if(!(this instanceof d))return new d(r);h.apply(this,arguments)});d.prototype.key=d.key="CHAR",d.prototype.toSql=function(){return"CHAR("+this._length+")"+(this._binary?" BINARY":"")};var f=p.inherits(function(e){var t="object"==typeof e&&e||{length:e};if(!(this instanceof f))return new f(t);this.options=t,this._length=t.length||""});f.prototype.key=f.key="TEXT",f.prototype.toSql=function(){switch(this._length.toLowerCase()){case"tiny":return"TINYTEXT";case"medium":return"MEDIUMTEXT";case"long":return"LONGTEXT";default:return this.key}},f.prototype.validate=function(e){if(!i.isString(e))throw new s.ValidationError(n.format("%j is not a valid string",e));return!0};var m=p.inherits(function(e){this.options=e,this._length=e.length,this._zerofill=e.zerofill,this._decimals=e.decimals,this._precision=e.precision,this._scale=e.scale,this._unsigned=e.unsigned});m.prototype.key=m.key="NUMBER",m.prototype.toSql=function(){var e=this.key;return this._length&&(e+="("+this._length,"number"==typeof this._decimals&&(e+=","+this._decimals),e+=")"),this._unsigned&&(e+=" UNSIGNED"),this._zerofill&&(e+=" ZEROFILL"),e},m.prototype.validate=function(e){if(!u.isFloat(String(e)))throw new s.ValidationError(n.format("%j is not a valid number",e));return!0},Object.defineProperty(m.prototype,"UNSIGNED",{get:function(){return this._unsigned=!0,this.options.unsigned=!0,this}}),Object.defineProperty(m.prototype,"ZEROFILL",{get:function(){return this._zerofill=!0,this.options.zerofill=!0,this}});var y=m.inherits(function(e){var t="object"==typeof e&&e||{length:e};if(!(this instanceof y))return new y(t);m.call(this,t)});y.prototype.key=y.key="INTEGER",y.prototype.validate=function(e){if(!u.isInt(String(e)))throw new s.ValidationError(n.format("%j is not a valid integer",e));return!0};var g=m.inherits(function(e){var t="object"==typeof e&&e||{length:e};if(!(this instanceof g))return new g(t);m.call(this,t)});g.prototype.key=g.key="BIGINT",g.prototype.validate=function(e){if(!u.isInt(String(e)))throw new s.ValidationError(n.format("%j is not a valid bigint",e));return!0};var E=m.inherits(function(e,t){var r="object"==typeof e&&e||{length:e,decimals:t};if(!(this instanceof E))return new E(r);m.call(this,r)});E.prototype.key=E.key="FLOAT",E.prototype.validate=function(e){if(!u.isFloat(String(e)))throw new s.ValidationError(n.format("%j is not a valid float",e));return!0};var v=m.inherits(function(e,t){var r="object"==typeof e&&e||{length:e,decimals:t};if(!(this instanceof v))return new v(r);m.call(this,r)});v.prototype.key=v.key="REAL";var b=m.inherits(function(e,t){var r="object"==typeof e&&e||{length:e,decimals:t};if(!(this instanceof b))return new b(r);m.call(this,r)});b.prototype.key=b.key="DOUBLE PRECISION";var A=m.inherits(function(e,t){var r="object"==typeof e&&e||{precision:e,scale:t};if(!(this instanceof A))return new A(r);m.call(this,r)});A.prototype.key=A.key="DECIMAL",A.prototype.toSql=function(){return this._precision||this._scale?"DECIMAL("+[this._precision,this._scale].filter(i.identity).join(",")+")":"DECIMAL"},A.prototype.validate=function(e){if(!u.isDecimal(String(e)))throw new s.ValidationError(n.format("%j is not a valid decimal",e));return!0},[E,b,v].forEach(function(e){e.prototype.escape=!1,e.prototype.$stringify=function(e){if(isNaN(e))return"'NaN'";if(!isFinite(e)){return"'"+(e<0?"-":"")+"Infinity'"}return e}});var T=p.inherits();T.prototype.key=T.key="BOOLEAN",T.prototype.toSql=function(){return"TINYINT(1)"},T.prototype.validate=function(e){if(!u.isBoolean(String(e)))throw new s.ValidationError(n.format("%j is not a valid boolean",e));return!0};var N=p.inherits();N.prototype.key=N.key="TIME",N.prototype.toSql=function(){return"TIME"};var I=p.inherits(function(e){var t="object"==typeof e&&e||{length:e};if(!(this instanceof I))return new I(t);this.options=t,this._length=t.length||""});I.prototype.key=I.key="DATE",I.prototype.toSql=function(){return"DATETIME"},I.prototype.validate=function(e){if(!u.isDate(String(e)))throw new s.ValidationError(n.format("%j is not a valid date",e));return!0},I.prototype.$applyTimezone=function(e,t){return e=t.timezone?l.tz.zone(t.timezone)?l(e).tz(t.timezone):c(e).utcOffset(t.timezone):l(e)},I.prototype.$stringify=function(e,t){return e=this.$applyTimezone(e,t),e.format("YYYY-MM-DD HH:mm:ss.SSS Z")};var w=function(){if(!(this instanceof w))return new w;p.apply(this,arguments)};n.inherits(w,p),w.prototype.key=w.key="DATEONLY",w.prototype.toSql=function(){return"DATE"};var O=p.inherits();O.prototype.key=O.key="HSTORE",O.prototype.validate=function(e){if(!i.isPlainObject(e))throw new s.ValidationError(n.format("%j is not a valid hstore",e));return!0};var _=function(){if(!(this instanceof _))return new _;p.apply(this,arguments)};n.inherits(_,p),_.prototype.key=_.key="JSON",_.prototype.validate=function(e){return!0},_.prototype.$stringify=function(e,t){return JSON.stringify(e)};var R=function(){if(!(this instanceof R))return new R;_.apply(this,arguments)};n.inherits(R,_),R.prototype.key=R.key="JSONB";var S=p.inherits();S.prototype.key=S.key="NOW";var q=p.inherits(function(e){var t="object"==typeof e&&e||{length:e};if(!(this instanceof q))return new q(t);this.options=t,this._length=t.length||""});q.prototype.key=q.key="BLOB",q.prototype.toSql=function(){switch(this._length.toLowerCase()){case"tiny":return"TINYBLOB";case"medium":return"MEDIUMBLOB";case"long":return"LONGBLOB";default:return this.key}},q.prototype.validate=function(e){if(!i.isString(e)&&!Buffer.isBuffer(e))throw new s.ValidationError(n.format("%j is not a valid blob",e));return!0},q.prototype.escape=!1,q.prototype.$stringify=function(e){Buffer.isBuffer(e)||(e=Array.isArray(e)?new Buffer(e):new Buffer(e.toString()));var t=e.toString("hex");return this.$hexify(t)},q.prototype.$hexify=function(e){return"X'"+e+"'"};var k=p.inherits(function(e){var t=i.isPlainObject(e)?e:{subtype:e};if(t.subtype||(t.subtype=new y),i.isFunction(t.subtype)&&(t.subtype=new t.subtype),!(this instanceof k))return new k(t);p.apply(this,arguments),this._subtype=t.subtype.key,this.options=t}),D={integer:"int4range",bigint:"int8range",decimal:"numrange",dateonly:"daterange",date:"tstzrange",datenotz:"tsrange"};k.prototype.key=k.key="RANGE",k.prototype.toSql=function(){return D[this._subtype.toLowerCase()]},k.prototype.validate=function(e){if(i.isPlainObject(e)&&e.inclusive&&(e=e.inclusive),!i.isArray(e))throw new s.ValidationError(n.format("%j is not a valid range",e));if(2!==e.length)throw new s.ValidationError("A range must be an array with two elements");return!0};var C=p.inherits();C.prototype.key=C.key="UUID",C.prototype.validate=function(e,t){if(!(i.isString(e)&&(u.isUUID(e)||t&&t.acceptStrings)))throw new s.ValidationError(n.format("%j is not a valid uuid",e));return!0};var L=function(){if(!(this instanceof L))return new L;p.apply(this,arguments)};n.inherits(L,p),L.prototype.key=L.key="UUIDV1",L.prototype.validate=function(e,t){if(!(i.isString(e)&&(u.isUUID(e)||t&&t.acceptStrings)))throw new s.ValidationError(n.format("%j is not a valid uuid",e));return!0};var M=function(){if(!(this instanceof M))return new M;p.apply(this,arguments)};n.inherits(M,p),M.prototype.key=M.key="UUIDV4",M.prototype.validate=function(e,t){if(!(i.isString(e)&&(u.isUUID(e,4)||t&&t.acceptStrings)))throw new s.ValidationError(n.format("%j is not a valid uuidv4",e));return!0};var x=function(e,t){if(!(this instanceof x))return new x(e,t);"function"==typeof e&&(e=new e),this.returnType=e,this.fields=t};n.inherits(x,p),x.prototype.key=x.key="VIRTUAL";var P=p.inherits(function(e){var t="object"==typeof e&&!Array.isArray(e)&&e||{values:Array.prototype.slice.call(arguments).reduce(function(e,t){return e.concat(Array.isArray(t)?t:[t])},[])};if(!(this instanceof P))return new P(t);this.values=t.values,this.options=t});P.prototype.key=P.key="ENUM",P.prototype.validate=function(e){if(!i.includes(this.values,e))throw new s.ValidationError(n.format("%j is not a valid choice in %j",e,this.values));return!0};var K=function(e){var t=i.isPlainObject(e)?e:{type:e};if(!(this instanceof K))return new K(t);this.type="function"==typeof t.type?new t.type:t.type};n.inherits(K,p),K.prototype.key=K.key="ARRAY",K.prototype.toSql=function(){return this.type.toSql()+"[]"},K.prototype.validate=function(e){if(!i.isArray(e))throw new s.ValidationError(n.format("%j is not a valid array",e));return!0},K.is=function(e,t){return e instanceof K&&e.type instanceof t};var U={BINARY:[h,d],UNSIGNED:[m,y,g,E,b,v],ZEROFILL:[m,y,g,E,b,v],PRECISION:[A],SCALE:[A]},j=p.inherits(function(e,t){var r=i.isPlainObject(e)?e:{type:e,srid:t};if(!(this instanceof j))return new j(r);this.options=r,this.type=r.type,this.srid=r.srid});j.prototype.key=j.key="GEOMETRY",j.prototype.escape=!1,j.prototype.$stringify=function(e,t){return"GeomFromText("+t.escape(o.convert(e))+")"};var F=p.inherits(function(e,t){var r=i.isPlainObject(e)?e:{type:e,srid:t};if(!(this instanceof F))return new F(r);this.options=r,this.type=r.type,this.srid=r.srid});F.prototype.key=F.key="GEOGRAPHY",F.prototype.escape=!1,F.prototype.$stringify=function(e,t){return"GeomFromText("+t.escape(o.convert(e))+")"},Object.keys(U).forEach(function(e){U[e].forEach(function(t){t[e]||Object.defineProperty(t,e,{get:function(){var r=new t;return"object"==typeof r[e]?r:r[e].apply(r,arguments)}})})});var Q={ABSTRACT:p,STRING:h,CHAR:d,TEXT:f,NUMBER:m,INTEGER:y,BIGINT:g,FLOAT:E,TIME:N,DATE:I,DATEONLY:w,BOOLEAN:T,NOW:S,BLOB:q,DECIMAL:A,NUMERIC:A,UUID:C,UUIDV1:L,UUIDV4:M,HSTORE:O,JSON:_,JSONB:R,VIRTUAL:x,ARRAY:K,NONE:x,ENUM:P,RANGE:k,REAL:v,DOUBLE:b,"DOUBLE PRECISION":b,GEOMETRY:j,GEOGRAPHY:F};i.each(Q,function(e){e.types={}}),Q.postgres=r(102)(Q),Q.mysql=r(97)(Q),Q.mariadb=Q.mysql,Q.sqlite=r(109)(Q),Q.mssql=r(89)(Q),e.exports=Q},function(e,t,r){"use strict";function n(e,t,r){o.wrap(e,t,function(e){return function(){if(i.Sequelize&&i.Sequelize.cls)for(var t=i.Sequelize.cls,n=0;n<r.length;n++){var o=r[n]<0?arguments.length+r[n]:r[n];o<arguments.length&&"function"==typeof arguments[o]&&(arguments[o]=t.bind(arguments[o]))}return e.apply(this,arguments)}})}var i=r(63),o=r(197);n(i,"join",[-1]),n(i.prototype,"then",[0,1,2]),n(i.prototype,"spread",[0,1]),n(i.prototype,"catch",[-1]),n(i.prototype,"error",[0]),n(i.prototype,"finally",[0]),n(i,"map",[1]),n(i,"mapSeries",[1]),n(i,"reduce",[1]),n(i,"filter",[1]),n(i,"each",[1]),n(i.prototype,"map",[0]),n(i.prototype,"mapSeries",[0]),n(i.prototype,"reduce",[0]),n(i.prototype,"filter",[0]),n(i.prototype,"each",[0]),n(i.prototype,"nodeify",[0]),n(i.prototype,"tap",[0]),n(i.prototype,"done",[0,1]),e.exports=i},function(e,t,r){"use strict";var n=r(8),i=e.exports={};i.BaseError=function(){var e=Error.apply(this,arguments);e.name=this.name="SequelizeBaseError",this.message=e.message,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)},n.inherits(i.BaseError,Error),i.ValidationError=function(e,t){i.BaseError.apply(this,arguments),this.name="SequelizeValidationError",this.message="Validation Error",this.errors=t||[],e?this.message=e:this.errors.length>0&&this.errors[0].message&&(this.message=this.errors.map(function(e){return e.type+": "+e.message}).join(",\n"))},n.inherits(i.ValidationError,i.BaseError),i.ValidationError.prototype.get=function(e){return this.errors.reduce(function(t,r){return r.path===e&&t.push(r),t},[])},i.DatabaseError=function(e){i.BaseError.apply(this,[e.message]),this.name="SequelizeDatabaseError",this.parent=e,this.original=e,this.sql=e.sql},n.inherits(i.DatabaseError,i.BaseError),i.TimeoutError=function(e){i.DatabaseError.call(this,e),this.name="SequelizeTimeoutError"},n.inherits(i.TimeoutError,i.BaseError),i.UniqueConstraintError=function(e){e=e||{},e.parent=e.parent||{sql:""},e.message=e.message||e.parent.message||"Validation Error",e.errors=e.errors||{},i.ValidationError.call(this,e.message,e.errors),this.name="SequelizeUniqueConstraintError",this.message=e.message,this.errors=e.errors,this.fields=e.fields,this.parent=e.parent,this.original=e.parent,this.sql=e.parent.sql},n.inherits(i.UniqueConstraintError,i.ValidationError),i.ForeignKeyConstraintError=function(e){e=e||{},e.parent=e.parent||{sql:""},i.DatabaseError.call(this,e.parent),this.name="SequelizeForeignKeyConstraintError",this.message=e.message||e.parent.message||"Database Error",this.fields=e.fields,this.table=e.table,this.value=e.value,this.index=e.index},n.inherits(i.ForeignKeyConstraintError,i.DatabaseError),i.ExclusionConstraintError=function(e){e=e||{},e.parent=e.parent||{sql:""},i.DatabaseError.call(this,e.parent),this.name="SequelizeExclusionConstraintError",this.message=e.message||e.parent.message,this.constraint=e.constraint,this.fields=e.fields,this.table=e.table},n.inherits(i.ExclusionConstraintError,i.DatabaseError),i.ValidationErrorItem=function(e,t,r,n){this.message=e||"",this.type=t||null,this.path=r||null,this.value=n||null},i.ConnectionError=function(e){i.BaseError.apply(this,[e?e.message:""]),this.name="SequelizeConnectionError",this.parent=e,this.original=e},n.inherits(i.ConnectionError,i.BaseError),i.ConnectionRefusedError=function(e){i.ConnectionError.call(this,e),this.name="SequelizeConnectionRefusedError"},n.inherits(i.ConnectionRefusedError,i.ConnectionError),i.AccessDeniedError=function(e){i.ConnectionError.call(this,e),this.name="SequelizeAccessDeniedError"},n.inherits(i.AccessDeniedError,i.ConnectionError),i.HostNotFoundError=function(e){i.ConnectionError.call(this,e),this.name="SequelizeHostNotFoundError"},n.inherits(i.HostNotFoundError,i.ConnectionError),i.HostNotReachableError=function(e){i.ConnectionError.call(this,e),this.name="SequelizeHostNotReachableError"},n.inherits(i.HostNotReachableError,i.ConnectionError),i.InvalidConnectionError=function(e){i.ConnectionError.call(this,e),this.name="SequelizeInvalidConnectionError"},n.inherits(i.InvalidConnectionError,i.ConnectionError),i.ConnectionTimedOutError=function(e){i.ConnectionError.call(this,e),this.name="SequelizeConnectionTimedOutError"},n.inherits(i.ConnectionTimedOutError,i.ConnectionError),i.InstanceError=function(e){i.BaseError.apply(this,arguments),this.name="SequelizeInstanceError",this.message=e},n.inherits(i.InstanceError,i.BaseError),i.EmptyResultError=function(e){i.BaseError.apply(this,arguments),this.name="SequelizeEmptyResultError",this.message=e},n.inherits(i.EmptyResultError,i.BaseError)},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("util")},function(e,t,r){"use strict";var n={};n.append=function(e,t){e.forEach(function(e){var r=e.toUpperCase();t&&(r=t+"_"+r),n[r]=e})},n.append(["admin","user","guest"],"ROLE"),n.append(["admin","owner","loggedIn","public"],"PERM"),n.append(["VALIDATION_ERROR","INVALID_CODE","MODEL_NOT_FOUND","ONLY_OWNER_CAN_EDIT_AND_DELETE"],"ERR"),e.exports=n},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("moment")},function(e,t,r){"use strict";r(1),r(2),r(9),r(15),r(7),r(0),r(34),r(161),r(142)("users"),r(181);e.exports=function(e,t){return e.define("user",{id:{type:t.INTEGER,primaryKey:!0,unique:!0},name:{type:t.STRING}})}},function(e,t){e.exports=require("chalk")},function(e,t,r){"use strict";e.exports={SELECT:"SELECT",INSERT:"INSERT",UPDATE:"UPDATE",BULKUPDATE:"BULKUPDATE",BULKDELETE:"BULKDELETE",DELETE:"DELETE",UPSERT:"UPSERT",VERSION:"VERSION",SHOWTABLES:"SHOWTABLES",SHOWINDEXES:"SHOWINDEXES",DESCRIBE:"DESCRIBE",RAW:"RAW",FOREIGNKEYS:"FOREIGNKEYS"}},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";(function(t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2),u=(r(1),r(168).EventEmitter),l=r(7),c=(r(15),r(8),r(0)),p=r(13),h=r(35),d=(r(9),r(140)),f=r(22),m=r(23),y=r(170),g=(r(163),r(173).GraphQLScalarType,r(55).Kind),E=r(141),v=function(e){function u(){n(this,u);var e=i(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));return e.setMaxListeners(0),e.app=null,e.db=null,e.services={},e}return o(u,e),s(u,[{key:"loadServices",value:function(e,n){var i=this;i.app=e,i.db=n;var o=function(t){var r=new E(t,e,n);i.services[r.name]=r};a.info(""),a.info(p.bold("Search built-in services..."));var s=r(158);s&&s.keys().map(function(e){a.info("  Load",l.relative(l.join(t,"..","services"),e),"service..."),o(s(e))}),a.info(""),a.info(p.bold("Search applogic services..."));var u=r(156);u&&u.keys().map(function(e){a.info("  Load",l.relative(l.join(t,"..","applogic","modules"),e),"service..."),o(u(e))}),c.forIn(i.services,function(e){c.isFunction(e.$schema.init)&&e.$schema.init.call(e,d.CreateToServiceInit(e))})}},{key:"registerRoutes",value:function(e){var t=this;c.forIn(this.services,function(r,n){if(!1!==r.$settings.rest&&r.actions){var i=h.Router();i.use(f.tryAuthenticateWithApiKey);var o=r.$settings.idParamName||"id",s=[];c.forIn(r.actions,function(n,u){var l=n.settings;if(l.handler=n,!c.isFunction(l.handler))throw new Error("Missing handler function in '"+u+"' action in '"+r.name+"' service!");var p=function(n,i){var o=d.CreateFromREST(r,l,e,n,i);a.debug("Request via REST '"+r.namespace+"/"+l.name+"' (ID: "+o.id+")",o.params),t.emit("request",o);r.getCacheKey(l.name,o.params);Promise.resolve().then(function(){return o.resolveModel()}).then(function(){return o.checkPermission()}).then(function(){return l.handler(o)}).then(function(e){i.append("Request-Id",o.id),m.json(i,e)}).catch(function(e){a.error(e),m.json(i,null,e)}).then(function(){t.emit("response",o)})};switch(i.get("/"+u,p),i.post("/"+u,p),i.get("/:"+o+"/"+u,p),i.post("/:"+o+"/"+u,p),u){case"find":i.get("/",p);break;case"get":s.push({method:"get",path:"/:"+o,handler:p});break;case"create":s.push({method:"post",path:"/:"+o,handler:p}),i.post("/",p);break;case"update":s.push({method:"put",path:"/:"+o,handler:p}),s.push({method:"patch",path:"/:"+o,handler:p}),i.put("/",p),i.patch("/",p);break;case"remove":s.push({method:"delete",path:"/:"+o,handler:p}),i.delete("/",p)}}),s.forEach(function(e){i[e.method](e.path,e.handler)}),e.use("/api/"+r.namespace,i),r.version&&e.use("/api/v"+r.version+"/"+r.namespace,i)}})}},{key:"registerSockets",value:function(e,t){}},{key:"registerGraphQLSchema",value:function(){var e=this,t={queries:[],types:[],mutations:[],resolvers:[]};return c.forIn(this.services,function(r,n){if(!1!==r.$settings.graphql&&c.isObject(r.$schema.graphql)){var i=r.$schema.graphql;i.resolvers=i.resolvers||{};var o=function(t){c.forIn(t,function(n,i){if(c.isString(n)&&r.actions[n]){var o=function(t,o,s){var u=r.actions[n],l=u.settings;if(l.handler=u,!c.isFunction(l.handler))throw new Error("Missing handler function in '"+i+"' action in '"+r.name+"' service!");var p=d.CreateFromGraphQL(r,l,t,o,s);a.debug("Request via GraphQL",p.params,s.query),e.emit("request",p);r.getCacheKey(l.name,p.params);return Promise.resolve().then(function(){return p.resolveModel()}).then(function(){return p.checkPermission()}).then(function(){return l.handler(p)}).catch(function(e){throw a.error(e),e}).then(function(t){return e.emit("response",p),console.timeEnd("GRAPHQL request"),t})};t[i]=o}})};i.resolvers.Query&&o(i.resolvers.Query),i.resolvers.Mutation&&o(i.resolvers.Mutation),t.queries.push(i.query),t.types.push(i.types),t.mutations.push(i.mutation),t.resolvers.push(i.resolvers)}}),0==t.queries.length?null:{schema:["\n\n\t\t\tscalar Timestamp\n\n\t\t\ttype Query {\n\t\t\t\t"+t.queries.join("\n")+"\n\t\t\t}\n\n\t\t\t"+t.types.join("\n")+"\n\n\t\t\ttype Mutation {\n\t\t\t\t"+t.mutations.join("\n")+"\n\t\t\t}\n\n\t\t\tschema {\n\t\t\t\tquery: Query\n\t\t\t\tmutation: Mutation\n\t\t\t}\n\t\t"],resolvers:function(e){return t.resolvers.forEach(function(t){e=c.merge(e,t)}),e}({Timestamp:{__parseValue:function(e){return new Date(e)},__serialize:function(e){return e.getTime()},__parseLiteral:function(e){return e.kind===g.INT?parseInt(e.value,10):null}}})}}},{key:"get",value:function(e){return this.services[e]}},{key:"printServicesInfo",value:function(){y(this.app)}}]),u}(u);e.exports=new v}).call(t,"server\\core")},function(e,t,r){"use strict";(function(e,t){var n=r(195),i=r(1),o=r(15),s=r(7),a=s.basename(e.filename),u={},l=s.join(t,"..","models"),c=i.sequelize.dag;o.readdirSync(l).filter(function(e){return 0!==e.indexOf(".")&&e!==a&&".js"===e.slice(-3)}).forEach(function(e){var t=c.import(s.join(l,e));u[t.name]=t}),Object.keys(u).forEach(function(e){u[e].associate&&u[e].associate(u)}),u.sequelize=c,u.Sequelize=n,e.exports=u}).call(t,r(155)(e),"server\\models")},function(e,t,r){"use strict";var n=function(){};n.prototype.toInstanceArray=function(e){return Array.isArray(e)||(e=[e]),e.map(function(e){if(!(e instanceof this.target.Instance)){var t={};return t[this.target.primaryKeyAttribute]=e,this.target.build(t,{isNewRecord:!1})}return e},this)},n.prototype.inspect=function(){return this.as},e.exports=n,e.exports.Association=n,e.exports.default=n},function(e,t,r){"use strict";var n=r(3),i=r(21),o=r(0),s=r(31),a=r(18),u=r(8),l=function(e,t,r){a.call(this),this.associationType="BelongsTo",this.source=e,this.target=t,this.options=r,this.scope=r.scope,this.isSingleAssociation=!0,this.isSelfAssociation=this.source===this.target,this.as=this.options.as,this.foreignKeyAttribute={},this.as?(this.isAliased=!0,this.options.name={singular:this.as}):(this.as=this.target.options.name.singular,this.options.name=this.target.options.name),o.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):this.options.foreignKey&&(this.foreignKey=this.options.foreignKey),this.foreignKey||(this.foreignKey=n.camelizeIf([n.underscoredIf(this.as,this.source.options.underscored),this.target.primaryKeyAttribute].join("_"),!this.source.options.underscored)),this.identifier=this.foreignKey,this.source.rawAttributes[this.identifier]&&(this.identifierField=this.source.rawAttributes[this.identifier].field||this.identifier),this.targetKey=this.options.targetKey||this.target.primaryKeyAttribute,this.targetKeyField=this.target.rawAttributes[this.targetKey].field||this.targetKey,this.targetKeyIsPrimary=this.targetKey===this.target.primaryKeyAttribute,this.targetIdentifier=this.targetKey,this.associationAccessor=this.as,this.options.useHooks=r.useHooks;var i=n.uppercaseFirst(this.options.name.singular);this.accessors={get:"get"+i,set:"set"+i,create:"create"+i}};u.inherits(l,a),l.prototype.injectAttributes=function(){var e={};if(e[this.foreignKey]=o.defaults({},this.foreignKeyAttribute,{type:this.options.keyType||this.target.rawAttributes[this.targetKey].type,allowNull:!0}),!1!==this.options.constraints){var t=this.source.rawAttributes[this.foreignKey]||e[this.foreignKey];this.options.onDelete=this.options.onDelete||(t.allowNull?"SET NULL":"NO ACTION"),this.options.onUpdate=this.options.onUpdate||"CASCADE"}return i.addForeignKeyConstraints(e[this.foreignKey],this.target,this.source,this.options,this.targetKeyField),n.mergeDefaults(this.source.rawAttributes,e),this.identifierField=this.source.rawAttributes[this.foreignKey].field||this.foreignKey,this.source.refreshAttributes(),i.checkNamingCollision(this),this},l.prototype.mixin=function(e){var t=this;e[this.accessors.get]=function(e){return t.get(this,e)},t.injectSetter(e),t.injectCreator(e)},l.prototype.get=function(e,t){var r,i=this,o=i.target,s={};if(t=n.cloneDeep(t),t.hasOwnProperty("scope")&&(o=t.scope?o.scope(t.scope):o.unscoped()),t.hasOwnProperty("schema")&&(o=o.schema(t.schema,t.schemaDelimiter)),Array.isArray(e)||(r=e,e=void 0),e)s[i.targetKey]={$in:e.map(function(e){return e.get(i.foreignKey)})};else{if(i.targetKeyIsPrimary&&!t.where)return o.findById(r.get(i.foreignKey),t);s[i.targetKey]=r.get(i.foreignKey),t.limit=null}return t.where=t.where?{$and:[s,t.where]}:s,e?o.findAll(t).then(function(t){var r={};return e.forEach(function(e){r[e.get(i.foreignKey,{raw:!0})]=null}),t.forEach(function(e){r[e.get(i.targetKey,{raw:!0})]=e}),r}):o.findOne(t)},l.prototype.injectSetter=function(e){var t=this;return e[this.accessors.set]=function(e,r){r=r||{};var n=e;if(e instanceof t.target.Instance&&(n=e[t.targetKey]),this.set(t.foreignKey,n),!1!==r.save)return r=o.extend({fields:[t.foreignKey],allowNull:[t.foreignKey],association:!0},r),this.save(r)},this},l.prototype.injectCreator=function(e){var t=this;return e[this.accessors.create]=function(e,r){var n=this,i={};return(r||{}).transaction instanceof s&&(i.transaction=r.transaction),i.logging=(r||{}).logging,t.target.create(e,r).then(function(e){return n[t.accessors.set](e,i)})},this},e.exports=l,e.exports.BelongsTo=l,e.exports.default=l},function(e,t,r){"use strict";var n=r(3),i=r(21),o=r(0),s=r(18),a=r(51),u=r(8),l=function(e,t,r){if(s.call(this),this.associationType="HasMany",this.source=e,this.target=t,this.targetAssociation=null,this.options=r||{},this.sequelize=e.modelManager.sequelize,this.through=r.through,this.scope=r.scope,this.isMultiAssociation=!0,this.isSelfAssociation=this.source===this.target,this.as=this.options.as,this.foreignKeyAttribute={},this.options.through)throw new Error("N:M associations are not supported with hasMany. Use belongsToMany instead");this.isSelfAssociation&&(this.targetAssociation=this),this.as?(this.isAliased=!0,o.isPlainObject(this.as)?(this.options.name=this.as,this.as=this.as.plural):this.options.name={plural:this.as,singular:n.singularize(this.as)}):(this.as=this.target.options.name.plural,this.options.name=this.target.options.name),o.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):this.options.foreignKey&&(this.foreignKey=this.options.foreignKey),this.foreignKey||(this.foreignKey=n.camelizeIf([n.underscoredIf(this.source.options.name.singular,this.source.options.underscored),this.source.primaryKeyAttribute].join("_"),!this.source.options.underscored)),this.target.rawAttributes[this.foreignKey]&&(this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,this.foreignKeyField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey),this.sourceKey=this.options.sourceKey||this.source.primaryKeyAttribute,this.target.rawAttributes[this.sourceKey]?this.sourceKeyField=this.source.rawAttributes[this.sourceKey].field||this.sourceKey:this.sourceKeyField=this.sourceKey,this.source.fieldRawAttributesMap[this.sourceKey]?this.sourceKeyAttribute=this.source.fieldRawAttributesMap[this.sourceKey].fieldName:this.sourceKeyAttribute=this.source.primaryKeyAttribute,this.sourceIdentifier=this.sourceKey,this.associationAccessor=this.as;var i=n.uppercaseFirst(this.options.name.plural),u=n.uppercaseFirst(this.options.name.singular);this.accessors={get:"get"+i,set:"set"+i,addMultiple:"add"+i,add:"add"+u,create:"create"+u,remove:"remove"+u,removeMultiple:"remove"+i,hasSingle:"has"+u,hasAll:"has"+i,count:"count"+i},this.options.counterCache&&(new a(this,!0!==this.options.counterCache?this.options.counterCache:{}),delete this.accessors.count)};u.inherits(l,s),l.prototype.injectAttributes=function(){var e={},t=o.clone(this.options);if(e[this.foreignKey]=o.defaults({},this.foreignKeyAttribute,{type:this.options.keyType||this.source.rawAttributes[this.sourceKeyAttribute].type,allowNull:!0}),!1!==this.options.constraints){var r=this.target.rawAttributes[this.foreignKey]||e[this.foreignKey];t.onDelete=t.onDelete||(r.allowNull?"SET NULL":"CASCADE"),t.onUpdate=t.onUpdate||"CASCADE"}return i.addForeignKeyConstraints(e[this.foreignKey],this.source,this.target,t,this.sourceKeyField),n.mergeDefaults(this.target.rawAttributes,e),this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,this.foreignKeyField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,this.target.refreshAttributes(),this.source.refreshAttributes(),i.checkNamingCollision(this),this},l.prototype.mixin=function(e){var t=this;e[this.accessors.get]=function(e){return t.get(this,e)},this.accessors.count&&(e[this.accessors.count]=function(e){return t.count(this,e)}),e[this.accessors.hasSingle]=e[this.accessors.hasAll]=function(e,r){return t.has(this,e,r)},e[this.accessors.set]=function(e,r){return t.set(this,e,r)},e[this.accessors.add]=e[this.accessors.addMultiple]=function(e,r){return t.add(this,e,r)},e[this.accessors.remove]=e[this.accessors.removeMultiple]=function(e,r){return t.remove(this,e,r)},e[this.accessors.create]=function(e,r){return t.create(this,e,r)}},l.prototype.get=function(e,t){var r,i,s=this,a={},u=s.target;return Array.isArray(e)||(r=e,e=void 0),t=n.cloneDeep(t)||{},s.scope&&o.assign(a,s.scope),e?(i=e.map(function(e){return e.get(s.sourceKey,{raw:!0})}),t.limit&&e.length>1?(t.groupedLimit={limit:t.limit,on:s.foreignKeyField,values:i},delete t.limit):(a[s.foreignKey]={$in:i},delete t.groupedLimit)):a[s.foreignKey]=r.get(s.sourceKey,{raw:!0}),t.where=t.where?{$and:[a,t.where]}:a,t.hasOwnProperty("scope")&&(u=t.scope?u.scope(t.scope):u.unscoped()),t.hasOwnProperty("schema")&&(u=u.schema(t.schema,t.schemaDelimiter)),u.findAll(t).then(function(t){if(r)return t;var n={};return e.forEach(function(e){n[e.get(s.sourceKey,{raw:!0})]=[]}),t.forEach(function(e){n[e.get(s.foreignKey,{raw:!0})].push(e)}),n})},l.prototype.count=function(e,t){var r=this,i=r.target,o=i.sequelize;return t=n.cloneDeep(t),t.attributes=[[o.fn("COUNT",o.col(i.primaryKeyField)),"count"]],t.raw=!0,t.plain=!0,this.get(e,t).then(function(e){return parseInt(e.count,10)})},l.prototype.has=function(e,t,r){var n=this,i={};return Array.isArray(t)||(t=[t]),r=o.assign({},r,{scope:!1,raw:!0}),i.$or=t.map(function(e){if(e instanceof n.target.Instance)return e.where();var t={};return t[n.target.primaryKeyAttribute]=e,t}),r.where={$and:[i,r.where]},this.get(e,r).then(function(e){return e.length===t.length})},l.prototype.set=function(e,t,r){var i=this;return t=null===t?[]:i.toInstanceArray(t),i.get(e,o.defaults({scope:!1,raw:!0},r)).then(function(s){var a,u,l=[],c=s.filter(function(e){return!o.find(t,function(t){return t[i.target.primaryKeyAttribute]===e[i.target.primaryKeyAttribute]})}),p=t.filter(function(e){return!o.find(s,function(t){return e[i.target.primaryKeyAttribute]===t[i.target.primaryKeyAttribute]})});return c.length>0&&(u={},u[i.foreignKey]=null,a={},a[i.target.primaryKeyAttribute]=c.map(function(e){return e[i.target.primaryKeyAttribute]}),l.push(i.target.unscoped().update(u,o.defaults({where:a},r)))),p.length>0&&(a={},u={},u[i.foreignKey]=e.get(i.sourceKey),o.assign(u,i.scope),a[i.target.primaryKeyAttribute]=p.map(function(e){return e[i.target.primaryKeyAttribute]}),l.push(i.target.unscoped().update(u,o.defaults({where:a},r)))),n.Promise.all(l).return(e)})},l.prototype.add=function(e,t,r){if(!t)return n.Promise.resolve();var i=this,s={},a={};return r=r||{},t=i.toInstanceArray(t),s[i.foreignKey]=e.get(i.sourceKey),o.assign(s,i.scope),a[i.target.primaryKeyAttribute]=t.map(function(e){return e.get(i.target.primaryKeyAttribute)}),i.target.unscoped().update(s,o.defaults({where:a},r)).return(e)},l.prototype.remove=function(e,t,r){var n=this,i={},s={};return r=r||{},t=n.toInstanceArray(t),i[n.foreignKey]=null,s[n.foreignKey]=e.get(n.sourceKey),s[n.target.primaryKeyAttribute]=t.map(function(e){return e.get(n.target.primaryKeyAttribute)}),n.target.unscoped().update(i,o.defaults({where:s},r)).return(this)},l.prototype.create=function(e,t,r){var n=this;return r=r||{},Array.isArray(r)&&(r={fields:r}),void 0===t&&(t={}),n.scope&&Object.keys(n.scope).forEach(function(e){t[e]=n.scope[e],r.fields&&r.fields.push(e)}),t[n.foreignKey]=e.get(n.sourceKey),r.fields&&r.fields.push(n.foreignKey),n.target.create(t,r)},e.exports=l,e.exports.HasMany=l,e.exports.default=l},function(e,t,r){"use strict";function n(e){if(e.source.rawAttributes.hasOwnProperty(e.as))throw new Error("Naming collision between attribute '"+e.as+"' and association '"+e.as+"' on model "+e.source.name+". To remedy this, change either foreignKey or as in your association definition")}function i(e,t,r,n,i){if(n.foreignKeyConstraint||n.onDelete||n.onUpdate){var s=o._.chain(t.rawAttributes).keys().filter(function(e){return t.rawAttributes[e].primaryKey}).map(function(e){return t.rawAttributes[e].field||e}).value();1===s.length&&(t.$schema?e.references={model:t.modelManager.sequelize.queryInterface.QueryGenerator.addSchema({tableName:t.tableName,$schema:t.$schema,$schemaDelimiter:t.$schemaDelimiter})}:e.references={model:t.tableName},e.references.key=i||s[0],e.onDelete=n.onDelete,e.onUpdate=n.onUpdate)}}var o=r(3);e.exports={checkNamingCollision:n,addForeignKeyConstraints:i}},function(e,t,r){"use strict";var n=r(2),i=r(1),o=r(10),s=r(12);e.exports.isAuthenticated=function(e,t,r){return e.isAuthenticated()?r():t.sendStatus(401)},e.exports.tryAuthenticateWithApiKey=function(e,t,r){e.isAuthenticated()?r():e.headers.apikey||e.query.apikey||e.body.apikey?o.authenticate("localapikey",function(t,i,o){i?e.login(i,function(e){r()}):(n.warn("Apikey error:",o),r())})(e,t,r):r()},e.exports.isAuthenticatedOrApiKey=function(e,t,r){return e.isAuthenticated()?r():e.headers.apikey||e.query.apikey||e.body.apikey?void o.authenticate("localapikey",function(n,i,o){return n?t.sendStatus(500):i?void e.login(i,function(e){return e?t.sendStatus(500):r()}):t.status(401).send(o.message||"")})(e,t,r):t.sendStatus(401)},e.exports.hasRole=function(t){if(!t)throw new Error("Required role needs to be set");return function(r,n,i){return e.exports.isAuthenticated(r,n,function(){r.user&&r.user.roles&&-1!==r.user.roles.indexOf(t)?i():n.sendStatus(403)})}},e.exports.hasAdminRole=function(){return e.exports.hasRole("admin")},e.exports.linkToSocialAccount=function(e){var t=e.req,r=(e.accessToken,e.refreshToken,e.profile),n=e.done,o=e.provider,a=(e.username,e.email),u=e.userData;if(t.user){var l={};l["socialLinks."+o]=r.id,s.findOne(l,function(e,i){if(i)return i._id!=t.user._id?(t.flash("error",{msg:t.t("SocialIDLinkedToOtherAccount")}),n(e)):n(e,i);s.findById(t.user.id,function(e,i){i.socialLinks=i.socialLinks||{},i.socialLinks[o]=r.id,i.profile=i.profile||{},i.profile.name=i.profile.name||u.name,i.profile.gender=i.profile.gender||u.gender,i.profile.picture=i.profile.picture||u.picture,i.profile.location=i.profile.location||u.location,i.save(function(e){t.flash("info",{msg:t.t("AccountHasBeenLinked")}),n(e,i)})})})}else{var c={};c["socialLinks."+o]=r.id,s.findOne(c,function(e,l){return l?1!==l.status?(t.flash("error",{msg:t.t("UserDisabledOrDeleted")}),n()):n(e,l):a?void s.findOne({email:a},function(e,l){if(l){if(1!==l.status)return t.flash("error",{msg:t.t("UserDisabledOrDeleted")}),n();var c=l;return c.socialLinks=c.socialLinks||{},c.socialLinks[o]=r.id,c.profile=c.profile||{},c.profile.name=c.profile.name||u.name,c.profile.gender=c.profile.gender||u.gender,c.profile.picture=c.profile.picture||u.picture,c.profile.location=c.profile.location||u.location,void c.save(function(e){t.flash("info",{msg:t.t("AccountHasBeenLinked")}),n(e,c)})}if(!0===i.features.disableSignUp)return t.flash("error",{msg:t.t("SignUpDisabledPleaseLogin")}),n();var p=new s;p.fullName=u.name,p.email=a,p.username=a,p.provider=o,p.verified=!0,p.passwordLess=!0,p.socialLinks={},p.socialLinks[o]=r.id,p.profile=u,p.save(function(e){n(e,p)})}):(t.flash("error",{msg:t.t("SocialMissingEmailAddress")}),n())})}}},function(e,t,r){"use strict";e.exports={BAD_REQUEST:{status:400,type:"BAD_REQUEST",message:"Invalid request"},UNAUTHORIZED:{status:401,type:"UNAUTHORIZED",message:"Unauthorized. Please login first!"},REQUEST_FAILED:{status:402,type:"REQUEST_FAILED",message:"Request failed!"},FORBIDDEN:{status:403,type:"FORBIDDEN",message:"You have not enough permission for this resource!"},NOT_FOUND:{status:404,type:"NOT_FOUND",message:"Not found!"},TOO_MANY_REQUEST:{status:429,type:"TOO_MANY_REQUEST",message:"Too many request!"},SERVER_ERROR:{status:500,type:"SERVER_ERROR",message:"Server error"},NOT_IMPLEMENTED:{status:501,type:"NOT_IMPLEMENTED",message:"This resource is not implemented!"},json:function(e,t,r,n){var i={};return r?(i.error=r,i.status=r.status||500,n&&(i.error.message=n.message||n),i.data=t,e?e.status(i.status).json(i):i):(i.status=200,i.data=t,e?e.json(i):i)}}},function(e,t){e.exports=require("semver")},function(e,t,r){"use strict";var n=r(3),i=r(21),o=r(0),s=r(18),a=r(19),u=r(20),l=r(36),c=r(51),p=r(8),h=function(e,t,r){if(s.call(this),r=r||{},void 0===r.through||!0===r.through||null===r.through)throw new Error("belongsToMany must be given a through option, either a string or a model");if(r.through.model||(r.through={model:r.through}),this.associationType="BelongsToMany",this.source=e,this.target=t,this.targetAssociation=null,this.options=r,this.sequelize=e.modelManager.sequelize,this.through=o.assign({},r.through),this.scope=r.scope,this.isMultiAssociation=!0,this.isSelfAssociation=this.source===this.target,this.doubleLinked=!1,this.as=this.options.as,!this.as&&this.isSelfAssociation)throw new Error("'as' must be defined for many-to-many self-associations");this.as?(this.isAliased=!0,n._.isPlainObject(this.as)?(this.options.name=this.as,this.as=this.as.plural):this.options.name={plural:this.as,singular:n.singularize(this.as)}):(this.as=this.target.options.name.plural,this.options.name=this.target.options.name),this.combinedTableName=n.combineTableNames(this.source.tableName,this.isSelfAssociation?this.as||this.target.tableName:this.target.tableName),this.isSelfAssociation&&(this.targetAssociation=this),o.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):(this.options.foreignKey||(this.foreignKeyDefault=!0),this.foreignKeyAttribute={},this.foreignKey=this.options.foreignKey||n.camelizeIf([n.underscoredIf(this.source.options.name.singular,this.source.options.underscored),this.source.primaryKeyAttribute].join("_"),!this.source.options.underscored)),o.isObject(this.options.otherKey)?(this.otherKeyAttribute=this.options.otherKey,this.otherKey=this.otherKeyAttribute.name||this.otherKeyAttribute.fieldName):(this.options.otherKey||(this.otherKeyDefault=!0),this.otherKeyAttribute={},this.otherKey=this.options.otherKey||n.camelizeIf([n.underscoredIf(this.isSelfAssociation?n.singularize(this.as):this.target.options.name.singular,this.target.options.underscored),this.target.primaryKeyAttribute].join("_"),!this.target.options.underscored)),o.each(this.target.associations,function(e){"BelongsToMany"===e.associationType&&e.target===this.source&&this.options.through.model===e.options.through.model&&(this.paired=e,e.paired=this)}.bind(this)),"string"==typeof this.through.model&&(this.sequelize.isDefined(this.through.model)?this.through.model=this.sequelize.model(this.through.model):this.through.model=this.sequelize.define(this.through.model,{},o.extend(this.options,{tableName:this.through.model,indexes:[],paranoid:!1,validate:{}}))),this.options=o.assign(this.options,o.pick(this.through.model.options,["timestamps","createdAt","updatedAt","deletedAt","paranoid"])),this.paired&&(this.otherKeyDefault&&(this.otherKey=this.paired.foreignKey),this.paired.otherKeyDefault&&(this.paired.otherKey!==this.foreignKey&&delete this.through.model.rawAttributes[this.paired.otherKey],this.paired.otherKey=this.foreignKey,this.paired.foreignIdentifier=this.foreignKey,delete this.paired.foreignIdentifierField)),this.through&&(this.throughModel=this.through.model),this.options.tableName=this.combinedName=this.through.model===Object(this.through.model)?this.through.model.tableName:this.through.model,this.associationAccessor=this.as;var i=n.uppercaseFirst(this.options.name.plural),a=n.uppercaseFirst(this.options.name.singular);this.accessors={get:"get"+i,set:"set"+i,addMultiple:"add"+i,add:"add"+a,create:"create"+a,remove:"remove"+a,removeMultiple:"remove"+i,hasSingle:"has"+a,hasAll:"has"+i,count:"count"+i},this.options.counterCache&&new c(this,!0!==this.options.counterCache?this.options.counterCache:{})};p.inherits(h,s),h.prototype.injectAttributes=function(){var e=this;this.identifier=this.foreignKey,this.foreignIdentifier=this.otherKey,o.each(this.through.model.rawAttributes,function(t,r){!0===t.primaryKey&&!0===t._autoGenerated&&(r===e.foreignKey||r===e.otherKey?t.primaryKey=!1:delete e.through.model.rawAttributes[r],e.primaryKeyDeleted=!0)});var t=this.source.rawAttributes[this.source.primaryKeyAttribute],r=t.type,n=t.field||this.source.primaryKeyAttribute,s=this.target.rawAttributes[this.target.primaryKeyAttribute],c=s.type,p=s.field||this.target.primaryKeyAttribute,h=o.defaults({},this.foreignKeyAttribute,{type:r}),d=o.defaults({},this.otherKeyAttribute,{type:c});if(!0===this.primaryKeyDeleted)d.primaryKey=h.primaryKey=!0;else if(!1!==this.through.unique){var f=[this.through.model.tableName,this.foreignKey,this.otherKey,"unique"].join("_");d.unique=h.unique=f}return this.through.model.rawAttributes[this.foreignKey]||(this.through.model.rawAttributes[this.foreignKey]={_autoGenerated:!0}),this.through.model.rawAttributes[this.otherKey]||(this.through.model.rawAttributes[this.otherKey]={_autoGenerated:!0}),!1!==this.options.constraints&&(h.references={model:this.source.getTableName(),key:n},h.onDelete=this.options.onDelete||this.through.model.rawAttributes[this.foreignKey].onDelete,h.onUpdate=this.options.onUpdate||this.through.model.rawAttributes[this.foreignKey].onUpdate,h.onDelete||(h.onDelete="CASCADE"),h.onUpdate||(h.onUpdate="CASCADE"),d.references={model:this.target.getTableName(),key:p},d.onDelete=this.through.model.rawAttributes[this.otherKey].onDelete||this.options.onDelete,d.onUpdate=this.through.model.rawAttributes[this.otherKey].onUpdate||this.options.onUpdate,d.onDelete||(d.onDelete="CASCADE"),d.onUpdate||(d.onUpdate="CASCADE")),this.through.model.rawAttributes[this.foreignKey]=o.extend(this.through.model.rawAttributes[this.foreignKey],h),this.through.model.rawAttributes[this.otherKey]=o.extend(this.through.model.rawAttributes[this.otherKey],d),this.identifierField=this.through.model.rawAttributes[this.foreignKey].field||this.foreignKey,this.foreignIdentifierField=this.through.model.rawAttributes[this.otherKey].field||this.otherKey,this.paired&&!this.paired.foreignIdentifierField&&(this.paired.foreignIdentifierField=this.through.model.rawAttributes[this.paired.otherKey].field||this.paired.otherKey),this.through.model.refreshAttributes(),this.toSource=new a(this.through.model,this.source,{foreignKey:this.foreignKey}),this.manyFromSource=new u(this.source,this.through.model,{foreignKey:this.foreignKey}),this.oneFromSource=new l(this.source,this.through.model,{foreignKey:this.foreignKey,as:this.through.model.name}),this.toTarget=new a(this.through.model,this.target,{foreignKey:this.otherKey}),this.manyFromTarget=new u(this.target,this.through.model,{foreignKey:this.otherKey}),this.oneFromTarget=new l(this.target,this.through.model,{foreignKey:this.otherKey,as:this.through.model.name}),this.paired&&this.paired.otherKeyDefault&&(this.paired.toTarget=new a(this.paired.through.model,this.paired.target,{foreignKey:this.paired.otherKey}),this.paired.oneFromTarget=new l(this.paired.target,this.paired.through.model,{foreignKey:this.paired.otherKey,as:this.paired.through.model.name})),i.checkNamingCollision(this),this},h.prototype.get=function(e,t){t=n.cloneDeep(t)||{};var r,i,s=this,a=s.through;s.scope&&(r=o.clone(s.scope)),t.where={$and:[r,t.where]},Object(a.model)===a.model&&(i={},i[s.foreignKey]=e.get(s.source.primaryKeyAttribute),a.scope&&o.assign(i,a.scope),t.through&&t.through.where&&(i={$and:[i,t.through.where]}),t.include=t.include||[],t.include.push({association:s.oneFromTarget,attributes:t.joinTableAttributes,required:!0,where:i}));var u=s.target;return t.hasOwnProperty("scope")&&(u=t.scope?u.scope(t.scope):u.unscoped()),t.hasOwnProperty("schema")&&(u=u.schema(t.schema,t.schemaDelimiter)),u.findAll(t)},h.prototype.injectGetter=function(e){var t=this;return e[this.accessors.get]=function(e){return t.get(this,e)},e[this.accessors.count]=function(r){var i=t.target,o=i.sequelize;return r=n.cloneDeep(r),r.attributes=[[o.fn("COUNT",o.col([t.target.name,i.primaryKeyAttribute].join("."))),"count"]],r.joinTableAttributes=[],r.raw=!0,r.plain=!0,e[t.accessors.get].call(this,r).then(function(e){return parseInt(e.count,10)})},e[this.accessors.hasSingle]=e[this.accessors.hasAll]=function(e,r){var n={};return Array.isArray(e)||(e=[e]),r=o.assign({raw:!0},r,{scope:!1}),n.$or=e.map(function(e){if(e instanceof t.target.Instance)return e.where();var r={};return r[t.target.primaryKeyAttribute]=e,r}),r.where={$and:[n,r.where]},this[t.accessors.get](r).then(function(t){return t.length===e.length})},this},h.prototype.injectSetter=function(e){var t=this;return e[this.accessors.set]=function(e,r){r=r||{};var i=this,s=t.source.primaryKeyAttribute,a=t.target.primaryKeyAttribute,u=t.identifier,l=t.foreignIdentifier,c={};return e=null===e?[]:t.toInstanceArray(e),c[u]=this.get(s),o.assign(c,t.through.scope),t.through.model.findAll(o.defaults({where:c,raw:!0},r)).then(function(c){var p,h=[],d=r,f=[];if(d=o.omit(d,["transaction","hooks","individualHooks","ignoreDuplicates","validate","fields","logging"]),p=e.filter(function(e){return!o.find(c,function(t){return t[l]===e.get(a)})}),c.forEach(function(n){var c=o.find(e,function(e){return n[l]===e.get(a)});if(c){var p=c[t.through.model.name];p instanceof t.through.model.Instance&&(p={});var m={},y=o.defaults({},p,d);m[u]=i.get(s),m[l]=c.get(a),Object.keys(y).length&&f.push(t.through.model.update(y,o.extend(r,{where:m})))}else h.push(n)}),h.length>0){var m={};m[u]=i.get(s),m[l]=h.map(function(e){return e[l]}),f.push(t.through.model.destroy(o.defaults({where:m},r)))}if(p.length>0){var y=p.map(function(e){var r={};return r[u]=i.get(s),r[l]=e.get(a),r=o.defaults(r,e[t.through.model.name],d),o.assign(r,t.through.scope),r}.bind(this));f.push(t.through.model.bulkCreate(y,o.assign({validate:!0},r)))}return n.Promise.all(f)})},e[this.accessors.addMultiple]=e[this.accessors.add]=function(e,r){if(!e)return n.Promise.resolve();r=o.clone(r)||{};var i=this,s=o.omit(r,["transaction","hooks","individualHooks","ignoreDuplicates","validate","fields","logging"]),a=t.source.primaryKeyAttribute,u=t.target.primaryKeyAttribute,l=t.identifier,c=t.foreignIdentifier,p=r;e=t.toInstanceArray(e);var h={};return h[l]=i.get(a),h[c]=e.map(function(e){return e.get(u)}),o.assign(h,t.through.scope),t.through.model.findAll(o.defaults({where:h,raw:!0},p)).then(function(r){var h=[],d=[],f=[];if(e.forEach(function(e){var n=o.find(r,function(t){return t[c]===e.get(u)});if(n){var i=e[t.through.model.name],a=o.defaults({},i,s);o.some(Object.keys(a),function(e){return a[e]!==n[e]})&&f.push(e)}else d.push(e)}),d.length>0){var m=d.map(function(e){var r=e[t.through.model.name],n=o.defaults({},r,s);return n[l]=i.get(a),n[c]=e.get(u),o.assign(n,t.through.scope),n}.bind(this));h.push(t.through.model.bulkCreate(m,o.assign({validate:!0},p)))}return f.forEach(function(e){var r=e[t.through.model.name],n=o.defaults({},r,s),d={};r instanceof t.through.model.Instance&&(r={}),d[l]=i.get(a),d[c]=e.get(u),h.push(t.through.model.update(n,o.extend(p,{where:d})))}),n.Promise.all(h)})},e[this.accessors.removeMultiple]=e[this.accessors.remove]=function(e,r){r=r||{},e=t.toInstanceArray(e);var n={};return n[t.identifier]=this.get(t.source.primaryKeyAttribute),n[t.foreignIdentifier]=e.map(function(e){return e.get(t.target.primaryKeyAttribute)}),t.through.model.destroy(o.defaults({where:n},r))},this},h.prototype.injectCreator=function(e){var t=this;return e[this.accessors.create]=function(e,r){var n=this;return r=r||{},e=e||{},Array.isArray(r)&&(r={fields:r}),t.scope&&(o.assign(e,t.scope),r.fields&&(r.fields=r.fields.concat(Object.keys(t.scope)))),t.target.create(e,r).then(function(e){return n[t.accessors.add](e,o.omit(r,["fields"])).return(e)})},this},e.exports=h,e.exports.BelongsToMany=h,e.exports.default=h},function(e,t,r){"use strict";var n,i=r(172),o=r(5),s=r(0),a=r(24),u={max:5,min:0,idle:1e4,handleDisconnects:!0};n=function(e,t){var r=s.cloneDeep(t.config);this.sequelize=t,this.config=r,this.dialect=e,this.versionPromise=null,this.dialectName=this.sequelize.options.dialect,r.pool?(r.pool=s.clone(r.pool),r.pool=s.defaults(r.pool,u,{validate:this.$validate.bind(this)})):r.pool=s.defaults({max:1,min:0},u,{validate:this.$validate.bind(this)}),r.pool.maxIdleTime&&(r.pool.idle=r.pool.maxIdleTime),r.pool.maxConnections&&(r.pool.max=r.pool.maxConnections),r.pool.minConnections&&(r.pool.min=r.pool.minConnections),this.onProcessExit=this.onProcessExit.bind(this),process.on("exit",this.onProcessExit)},n.prototype.refreshTypeParser=function(e){s.each(e,function(e,t){if(e.hasOwnProperty("parse")){var r=this.dialectName;if("mariadb"===r&&(r="mysql"),!e.types[r])throw new Error("Parse function not supported for type "+e.key+" in dialect "+this.dialectName);this.$refreshTypeParser(e)}}.bind(this))},n.prototype.onProcessExit=function(){var e=this;this.pool&&this.pool.drain(function(){e.pool.destroyAllNow()})},n.prototype.close=function(){this.onProcessExit(),process.removeListener("exit",this.onProcessExit),this.getConnection=function(){return o.reject(new Error("ConnectionManager.getConnection was called after the connection manager was closed!"))}},n.prototype.initPools=function(){var e=this,t=this.config;if(!t.replication)return void(this.pool=i.Pool({name:"sequelize-connection",create:function(r){e.$connect(t).nodeify(function(e,t){r(e,t)})},destroy:function(t){return e.$disconnect(t),null},max:t.pool.max,min:t.pool.min,validate:t.pool.validate,idleTimeoutMillis:t.pool.idle}));var r=0;Array.isArray(t.replication.read)||(t.replication.read=[t.replication.read]),t.replication.write=s.defaults(t.replication.write,s.omit(t,"replication")),t.replication.read=s.map(t.replication.read,function(t){return s.defaults(t,s.omit(e.config,"replication"))}),this.pool={release:function(t){return"read"===t.queryType?e.pool.read.release(t):e.pool.write.release(t)},acquire:function(t,r,n,i){i=!s.isUndefined(i)&&i,"SELECT"!==n||i?e.pool.write.acquire(t,r):e.pool.read.acquire(t,r)},destroy:function(t){return e.pool[t.queryType].destroy(t)},destroyAllNow:function(){e.pool.read.destroyAllNow(),e.pool.write.destroyAllNow()},drain:function(t){e.pool.write.drain(function(){e.pool.read.drain(t)})},read:i.Pool({name:"sequelize-connection-read",create:function(n){var i=r++%t.replication.read.length;e.$connect(t.replication.read[i]).tap(function(e){e.queryType="read"}).nodeify(function(e,t){n(e,t)})},destroy:function(t){return e.$disconnect(t),null},validate:t.pool.validate,max:t.pool.max,min:t.pool.min,idleTimeoutMillis:t.pool.idle}),write:i.Pool({name:"sequelize-connection-write",create:function(r){e.$connect(t.replication.write).tap(function(e){e.queryType="write"}).nodeify(function(e,t){r(e,t)})},destroy:function(t){return e.$disconnect(t),null},validate:t.pool.validate,max:t.pool.max,min:t.pool.min,idleTimeoutMillis:t.pool.idle})}},n.prototype.getConnection=function(e){var t=this;e=e||{};var r;return r=0===this.sequelize.options.databaseVersion?this.versionPromise?this.versionPromise:this.versionPromise=t.$connect(t.config.replication.write||t.config).then(function(e){var r={};return r.transaction={connection:e},r.logging=function(){},r.logging.__testLoggingFn=!0,t.sequelize.databaseVersion(r).then(function(r){return t.sequelize.options.databaseVersion=a.valid(r)?r:t.defaultVersion,t.versionPromise=null,t.$disconnect(e),null})}).catch(function(e){throw t.versionPromise=null,e}):o.resolve(),r.then(function(){return new o(function(r,n){t.pool.acquire(function(e,t){if(e)return n(e);r(t)},e.priority,e.type,e.useMaster)})})},n.prototype.releaseConnection=function(e){var t=this;return new o(function(r,n){t.pool.release(e),r()})},n.prototype.$connect=function(e){return this.sequelize.runHooks("beforeConnect",e).bind(this).then(function(){return this.dialect.connectionManager.connect(e)}).then(function(t){return this.sequelize.runHooks("afterConnect",t,e).return(t)})},n.prototype.$disconnect=function(e){return this.dialect.connectionManager.disconnect(e)},n.prototype.$validate=function(e){return!this.dialect.connectionManager.validate||this.dialect.connectionManager.validate(e)},e.exports=n},function(e,t,r){"use strict";var n=function(){};n.prototype.supports={DEFAULT:!0,"DEFAULT VALUES":!1,"VALUES ()":!1,"LIMIT ON UPDATE":!1,"ON DUPLICATE KEY":!0,"ORDER NULLS":!1,UNION:!0,"UNION ALL":!0,IGNORE:"",returnValues:!1,autoIncrement:{identityInsert:!1,defaultValue:!0,update:!0},bulkDefault:!1,ignoreDuplicates:"",updateOnDuplicate:!1,schemas:!1,transactions:!0,transactionOptions:{type:!1},migrations:!0,upserts:!0,constraints:{restrict:!0},index:{collate:!0,length:!1,parser:!1,concurrently:!1,type:!1,using:!0},joinTableDependent:!0,groupedLimit:!0,indexViaAlter:!1,JSON:!1,deferrableConstraints:!1},e.exports=n},function(e,t,r){"use strict";var n=r(3),i=r(38),o=r(50),s=r(4),a=r(0),u=r(8),l=r(41),c=r(19),p=r(25),h=r(20),d=r(43),f=r(24),m=function(e){throw new Error('The method "'+e+'" is not defined! Please add it to your sql dialect.')},y={options:{},extractTableDetails:function(e,t){return t=t||{},e=e||{},{schema:e.schema||t.schema||"public",tableName:a.isPlainObject(e)?e.tableName:e,delimiter:e.delimiter||t.delimiter||"."}},addSchema:function(e){var t=this;return e.$schema?{tableName:e.tableName||e,table:e.tableName||e,name:e.name||e,schema:e.$schema,delimiter:e.$schemaDelimiter||".",toString:function(){return t.quoteTable(this)}}:e.tableName||e},dropSchema:function(e,t){return this.dropTableQuery(e,t)},createTableQuery:function(e,t,r){m("createTableQuery")},versionQuery:function(e,t,r){m("versionQuery")},describeTableQuery:function(e,t,r){return"DESCRIBE "+this.quoteTable(this.addSchema({tableName:e,$schema:t,$schemaDelimiter:r}))+";"},dropTableQuery:function(e,t){return t=t||{},n._.template("DROP TABLE IF EXISTS <%= table %>;")({table:this.quoteTable(e)})},renameTableQuery:function(e,t){return n._.template("ALTER TABLE <%= before %> RENAME TO <%= after %>;")({before:this.quoteTable(e),after:this.quoteTable(t)})},showTablesQuery:function(){m("showTablesQuery")},addColumnQuery:function(e,t){m("addColumnQuery")},removeColumnQuery:function(e,t){m("removeColumnQuery")},changeColumnQuery:function(e,t){m("changeColumnQuery")},renameColumnQuery:function(e,t,r){m("renameColumnQuery")},insertQuery:function(e,t,r,i){i=i||{},a.defaults(i,this.options);var o,u,l,c,p,h,m="<%= tmpTable %>INSERT<%= ignore %> INTO <%= table %> (<%= attributes %>)<%= output %> VALUES (<%= values %>)",y="<%= tmpTable %>INSERT<%= ignore %> INTO <%= table %><%= output %>",g=[],E=[],v=!1,b={},A="",T="",N="",I="";if(r&&n._.each(r,function(e,t){b[t]=e,e.field&&(b[e.field]=e)}),this._dialect.supports["DEFAULT VALUES"]?y+=" DEFAULT VALUES":this._dialect.supports["VALUES ()"]&&(y+=" VALUES ()"),this._dialect.supports.returnValues&&i.returning)if(this._dialect.supports.returnValues.returning)m+=" RETURNING *",y+=" RETURNING *";else if(this._dialect.supports.returnValues.output&&(u=" OUTPUT INSERTED.*",r&&i.hasTrigger&&this._dialect.supports.tmpTableTrigger)){A="declare @tmp table (<%= columns %>); ";for(h in r)p=r[h],p.type instanceof s.VIRTUAL||(N.length>0&&(N+=",",I+=","),N+=this.quoteIdentifier(p.field)+" "+p.type.toSql(),I+="INSERTED."+this.quoteIdentifier(p.field));var w={columns:N};A=n._.template(A)(w).trim(),u=" OUTPUT "+I+" into @tmp",T=";select * from @tmp",m+=T,y+=T}if(this._dialect.supports.EXCEPTION&&i.exception)if(f.gte(this.sequelize.options.databaseVersion,"9.2.0")){var O="$func_"+d.v4().replace(/-/g,"")+"$";i.exception="WHEN unique_violation THEN GET STACKED DIAGNOSTICS sequelize_caught_exception = PG_EXCEPTION_DETAIL;",m="CREATE OR REPLACE FUNCTION pg_temp.testfunc(OUT response <%= table %>, OUT sequelize_caught_exception text) RETURNS RECORD AS "+O+" BEGIN "+m+" INTO response; EXCEPTION "+i.exception+" END "+O+" LANGUAGE plpgsql; SELECT (testfunc.response).*, testfunc.sequelize_caught_exception FROM pg_temp.testfunc(); DROP FUNCTION IF EXISTS pg_temp.testfunc()"}else i.exception="WHEN unique_violation THEN NULL;",m="CREATE OR REPLACE FUNCTION pg_temp.testfunc() RETURNS SETOF <%= table %> AS $body$ BEGIN RETURN QUERY "+m+"; EXCEPTION "+i.exception+" END; $body$ LANGUAGE plpgsql; SELECT * FROM pg_temp.testfunc(); DROP FUNCTION IF EXISTS pg_temp.testfunc();";this._dialect.supports["ON DUPLICATE KEY"]&&i.onDuplicate&&(m+=" ON DUPLICATE KEY "+i.onDuplicate,y+=" ON DUPLICATE KEY "+i.onDuplicate),t=n.removeNullValuesFromHash(t,this.options.omitNull);for(l in t)t.hasOwnProperty(l)&&(c=t[l],g.push(this.quoteIdentifier(l)),b&&b[l]&&!0===b[l].autoIncrement&&!c?this._dialect.supports.autoIncrement.defaultValue?this._dialect.supports.DEFAULT?E.push("DEFAULT"):E.push(this.escape(null)):g.splice(-1,1):(b&&b[l]&&!0===b[l].autoIncrement&&(v=!0),E.push(this.escape(c,b&&b[l]||void 0,{context:"INSERT"}))));var _={ignore:i.ignore?this._dialect.supports.IGNORE:"",table:this.quoteTable(e),attributes:g.join(","),output:u,values:E.join(","),tmpTable:A};return o=(_.attributes.length?m:y)+";",v&&this._dialect.supports.autoIncrement.identityInsert&&(o=["SET IDENTITY_INSERT",this.quoteTable(e),"ON;",o,"SET IDENTITY_INSERT",this.quoteTable(e),"OFF;"].join(" ")),n._.template(o)(_)},bulkInsertQuery:function(e,t,r,n){r=r||{},n=n||{};var i="INSERT<%= ignoreDuplicates %> INTO <%= table %> (<%= attributes %>) VALUES <%= tuples %><%= onDuplicateKeyUpdate %><%= returning %>;",o=[],s=[],u=[],l="";t.forEach(function(e){a.forOwn(e,function(e,t){-1===u.indexOf(t)&&u.push(t),n[t]&&!0===n[t].autoIncrement&&s.push(t)})}),t.forEach(function(e){o.push("("+u.map(function(t){return this._dialect.supports.bulkDefault&&-1!==s.indexOf(t)?e[t]||"DEFAULT":this.escape(e[t],n[t],{context:"INSERT"})},this).join(",")+")")},this),this._dialect.supports.updateOnDuplicate&&r.updateOnDuplicate&&(l+=" ON DUPLICATE KEY UPDATE "+r.updateOnDuplicate.map(function(e){var t=n&&n[e]&&n[e].field||e,r=this.quoteIdentifier(t);return r+"=VALUES("+r+")"},this).join(","));var c={ignoreDuplicates:r.ignoreDuplicates?this._dialect.supports.ignoreDuplicates:"",table:this.quoteTable(e),attributes:u.map(function(e){return this.quoteIdentifier(e)},this).join(","),tuples:o.join(","),onDuplicateKeyUpdate:l,returning:this._dialect.supports.returnValues&&r.returning?" RETURNING *":""};return a.template(i)(c)},updateQuery:function(e,t,r,i,o){i=i||{},a.defaults(i,this.options),t=n.removeNullValuesFromHash(t,i.omitNull,i);var u,l,c,p,h=[],d={},f="",m="",y="",g="";if(u="<%= tmpTable %>UPDATE <%= table %> SET <%= values %><%= output %> <%= where %>",this._dialect.supports["LIMIT ON UPDATE"]&&i.limit&&(u+=" LIMIT "+this.escape(i.limit)+" "),this._dialect.supports.returnValues)if(this._dialect.supports.returnValues.output){if(l=" OUTPUT INSERTED.*",o&&i.hasTrigger&&this._dialect.supports.tmpTableTrigger){f="declare @tmp table (<%= columns %>); ";for(p in o)c=o[p],c.type instanceof s.VIRTUAL||(y.length>0&&(y+=",",g+=","),y+=this.quoteIdentifier(c.field)+" "+c.type.toSql(),g+="INSERTED."+this.quoteIdentifier(c.field));var E={columns:y};f=n._.template(f)(E).trim(),l=" OUTPUT "+g+" into @tmp",m=";select * from @tmp",u+=m}}else this._dialect.supports.returnValues&&i.returning&&(i.mapToModel=!0,u+=" RETURNING *");o&&n._.each(o,function(e,t){d[t]=e,e.field&&(d[e.field]=e)});for(var v in t)if(!d||!d[v]||!0!==d[v].autoIncrement||this._dialect.supports.autoIncrement.update){var b=t[v];h.push(this.quoteIdentifier(v)+"="+this.escape(b,d&&d[v]||void 0,{context:"UPDATE"}))}var A={table:this.quoteTable(e),values:h.join(","),output:l,where:this.whereQuery(r),tmpTable:f};return 0===h.length?"":n._.template(u)(A).trim()},upsertQuery:function(e,t,r,n,i,o){m("upsertQuery")},deleteQuery:function(e,t,r){m("deleteQuery")},incrementQuery:function(e,t,r,i){t=n.removeNullValuesFromHash(t,this.options.omitNull);var o,s,a,u,l=[];o="UPDATE <%= table %> SET <%= values %><%= output %> <%= where %>",this._dialect.supports.returnValues&&(this._dialect.supports.returnValues.returning?o+=" RETURNING *":this._dialect.supports.returnValues.output&&(u=" OUTPUT INSERTED.*"));for(s in t)a=t[s],l.push(this.quoteIdentifier(s)+"="+this.quoteIdentifier(s)+" + "+this.escape(a));i=i||{};for(s in i)a=i[s],l.push(this.quoteIdentifier(s)+"="+this.escape(a));var c={table:this.quoteTable(e),values:l.join(","),output:u,where:this.whereQuery(r)};return n._.template(o)(c)},nameIndexes:function(e,t){return n._.map(e,function(e){if(!e.hasOwnProperty("name")){var r=e.fields.map(function(e){return"string"==typeof e?e:e.name||e.attribute}.bind(this));e.name=n.inflection.underscore(t+"_"+r.join("_"))}return e})},addIndexQuery:function(e,t,r,i){var s;r=r||{},Array.isArray(t)?r.fields=t:(r=t,t=void 0),r.indexName&&(r.name=r.indexName),r.indicesType&&(r.type=r.indicesType),(r.indexType||r.method)&&(r.using=r.indexType||r.method),r.prefix=r.prefix||i||e,r.prefix&&a.isString(r.prefix)&&(r.prefix=r.prefix.replace(/\./g,"_"),r.prefix=r.prefix.replace(/(\"|\')/g,"")),s=r.fields.map(function(e){if("string"==typeof e)return this.quoteIdentifier(e);if(e._isSequelizeMethod)return this.handleSequelizeMethod(e);var t="";if(e.attribute&&(e.name=e.attribute),!e.name)throw new Error("The following index field has no name: "+u.inspect(e));return t+=this.quoteIdentifier(e.name),this._dialect.supports.index.collate&&e.collate&&(t+=" COLLATE "+this.quoteIdentifier(e.collate)),this._dialect.supports.index.length&&e.length&&(t+="("+e.length+")"),e.order&&(t+=" "+e.order),t}.bind(this)),r.name||(r=this.nameIndexes([r],r.prefix)[0]),r=o.prototype.$conformIndex(r),this._dialect.supports.index.type||delete r.type,r.where&&(r.where=this.whereQuery(r.where)),e=a.isString(e)?this.quoteIdentifiers(e):this.quoteTable(e);var l,c=this._dialect.supports.index.concurrently&&r.concurrently?"CONCURRENTLY":void 0;return l=this._dialect.supports.indexViaAlter?["ALTER TABLE",e,c,"ADD"]:["CREATE"],l=l.concat(r.unique?"UNIQUE":"",r.type,"INDEX",this._dialect.supports.indexViaAlter?void 0:c,this.quoteIdentifiers(r.name),1===this._dialect.supports.index.using&&r.using?"USING "+r.using:"",this._dialect.supports.indexViaAlter?void 0:"ON "+e,2===this._dialect.supports.index.using&&r.using?"USING "+r.using:"","("+s.join(", ")+(r.operator?" "+r.operator:"")+")",this._dialect.supports.index.parser&&r.parser?"WITH PARSER "+r.parser:void 0,this._dialect.supports.index.where&&r.where?r.where:void 0),n._.compact(l).join(" ")},showIndexesQuery:function(e,t){m("showIndexesQuery")},removeIndexQuery:function(e,t){m("removeIndexQuery")},attributesToSQL:function(e){m("attributesToSQL")},findAutoIncrementField:function(e){m("findAutoIncrementField")},quoteTable:function(e,t){var r="";return!0===t&&(t=e.as||e.name||e),a.isObject(e)?this._dialect.supports.schemas?(e.schema&&(r+=this.quoteIdentifier(e.schema)+"."),r+=this.quoteIdentifier(e.tableName)):(e.schema&&(r+=e.schema+(e.delimiter||".")),r+=e.tableName,r=this.quoteIdentifier(r)):r=this.quoteIdentifier(e),t&&(r+=" AS "+this.quoteIdentifier(t)),r},quote:function(e,t,r){if(n._.isString(e))return this.quoteIdentifiers(e,r);if(Array.isArray(e)){for(var i,s,a,u,l,c=[],p=e.length,h=0;h<p-1&&(s=e[h],!(s._modelAttribute||n._.isString(s)||s._isSequelizeMethod||"raw"in s));h++){if(s instanceof o?(a=s,u=void 0):(a=s.model,u=s.as),!(l=!u&&i&&i.through&&i.through.model===a?{as:a.name}:t.getAssociation(a,u)))throw c[h]=a.tableName,new Error("'"+c.join(".")+"' in order / group clause is not valid association");c[h]=l.as,t=a,i=l}var d=(h>0?this.quoteIdentifier(c.join("."))+".":n._.isString(e[0])&&t?this.quoteIdentifier(t.name)+".":"")+this.quote(e[h],t,r);return h<p-1&&(e[h+1]._isSequelizeMethod?d+=this.handleSequelizeMethod(e[h+1]):d+=" "+e[h+1]),d}if(e._modelAttribute)return this.quoteTable(e.Model.name)+"."+e.fieldName;if(e._isSequelizeMethod)return this.handleSequelizeMethod(e);if(n._.isObject(e)&&"raw"in e)return e.raw;throw new Error("Unknown structure passed to order / group: "+JSON.stringify(e))},createTrigger:function(e,t,r,n,i,o,s){m("createTrigger")},dropTrigger:function(e,t){m("dropTrigger")},renameTrigger:function(e,t,r){m("renameTrigger")},createFunction:function(e,t,r,n,i,o){m("createFunction")},dropFunction:function(e,t){m("dropFunction")},renameFunction:function(e,t,r){m("renameFunction")},quoteIdentifier:function(e,t){m("quoteIdentifier")},quoteIdentifiers:function(e,t){return-1!==e.indexOf(".")?(e=e.split("."),this.quoteIdentifier(e.slice(0,e.length-1).join("."))+"."+this.quoteIdentifier(e[e.length-1])):this.quoteIdentifier(e)},escape:function(e,t,r){if(r=r||{},null!==e&&void 0!==e){if(e._isSequelizeMethod)return this.handleSequelizeMethod(e);if(t&&t.type&&(this.typeValidation&&t.type.validate&&e&&(r.isList&&Array.isArray(e)?a.forEach(e,function(e){t.type.validate(e,r)}):t.type.validate(e,r)),t.type.stringify)){var n=a.partialRight(i.escape,this.options.timezone,this.dialect);if(e=t.type.stringify(e,{escape:n,field:t,timezone:this.options.timezone}),!1===t.type.escape)return e}}return i.escape(e,this.options.timezone,this.dialect)},getForeignKeysQuery:function(e,t){m("getForeignKeysQuery")},dropForeignKeyQuery:function(e,t){m("dropForeignKeyQuery")},selectQuery:function(e,t,r){t=t||{};var i,s=null,u=this,l=t.limit,c=r,d=[],f=t.attributes&&t.attributes.slice(),m=[],y=void 0===t.subQuery?l&&t.hasMultiAssociation:t.subQuery,g=[],E=null,v=[],b=null;if(t.tableAs?b=this.quoteTable(t.tableAs):!Array.isArray(e)&&r&&(b=this.quoteTable(r.name)),s=Array.isArray(e)?e.map(function(e){return Array.isArray(e)?this.quoteTable(e[0],e[1]):this.quoteTable(e,!0)}.bind(this)).join(", "):this.quoteTable(e),y&&f&&r.primaryKeyAttributes.forEach(function(e){a.find(f,function(t){return e===t||e===t[0]||e===t[1]})||f.push(r.rawAttributes[e].field?[e,r.rawAttributes[e].field]:e)}),f=f&&f.map(function(e){var r=!0;return e._isSequelizeMethod?u.handleSequelizeMethod(e):(Array.isArray(e)&&2===e.length?(e=e.slice(),e[0]._isSequelizeMethod?(e[0]=u.handleSequelizeMethod(e[0]),r=!1):-1===e[0].indexOf("(")&&-1===e[0].indexOf(")")&&(e[0]=u.quoteIdentifier(e[0])),e=[e[0],u.quoteIdentifier(e[1])].join(" AS ")):e=e.indexOf(n.TICK_CHAR)<0&&e.indexOf('"')<0?u.quoteIdentifiers(e):e,t.include&&-1===e.indexOf(".")&&r&&(e=b+"."+e),e)}),f=f||(t.include?[b+".*"]:["*"]),(y||t.groupedLimit)&&(E=f,f=[(b||s)+".*"]),t.include){var A=function(r,i){var s,l,p=r.model.getTableName(),h=r.as,d="",m={mainQuery:[],subQuery:[]},g=r.association,v=r.through,T=r.required?" INNER JOIN ":" LEFT OUTER JOIN ",N=!r.parent.association&&r.parent.model.name===t.model.name,I=n._.clone(t);if(I.keysEscaped=!0,e!==i&&b!==i&&(h=i+"."+r.as),!1!==t.includeIgnoreAttributes&&(s=r.attributes.map(function(e){var t=e,r=!1;if(Array.isArray(e)&&2===e.length)e[0]._isSequelizeMethod&&(e[0]instanceof n.literal||e[0]instanceof n.cast||e[0]instanceof n.fn)&&(r=!0),e=e.map(function(e){return e._isSequelizeMethod?u.handleSequelizeMethod(e):e}),t=e[1],e=e[0];else{if(e instanceof n.literal)return e.val;if(e instanceof n.cast||e instanceof n.fn)throw new Error("Tried to select attributes using Sequelize.cast or Sequelize.fn without specifying an alias for the result, during eager loading. This means the attribute will not be added to the returned instance")}return(!0===r?e:u.quoteIdentifier(h)+"."+u.quoteIdentifier(e))+" AS "+u.quoteIdentifier(h+"."+t,!0)}),r.subQuery&&y?E=E.concat(s):f=f.concat(s)),v){var w,O,_,R=v.model.getTableName(),S=h+"."+v.as,q=v.attributes.map(function(e){return u.quoteIdentifier(S)+"."+u.quoteIdentifier(Array.isArray(e)?e[0]:e)+" AS "+u.quoteIdentifier(S+"."+(Array.isArray(e)?e[1]:e))}),k=g.source.primaryKeyAttributes,D=i,C=g.identifierField,L=k[0],M=g.target.primaryKeyAttributes,x=h,P=g.foreignIdentifierField,K=g.target.rawAttributes[M[0]].field||M[0];!1!==t.includeIgnoreAttributes&&(f=f.concat(q)),y||(L=g.source.rawAttributes[k[0]].field),!y||r.subQuery||r.parent.subQuery||r.parent.model===c||(L=g.source.rawAttributes[k[0]].field),w=y&&!r.subQuery&&r.parent.subQuery&&!N?u.quoteIdentifier(D+"."+L)+" = ":u.quoteTable(D)+"."+u.quoteIdentifier(L)+" = ",w+=u.quoteIdentifier(S)+"."+u.quoteIdentifier(C),O=u.quoteIdentifier(x)+"."+u.quoteIdentifier(K)+" = ",O+=u.quoteIdentifier(S)+"."+u.quoteIdentifier(P),r.through.where&&(_=u.getWhereConditions(r.through.where,u.sequelize.literal(u.quoteIdentifier(S)),r.through.model)),u._dialect.supports.joinTableDependent?(d+=T+"(",d+=u.quoteTable(R,S),d+=" INNER JOIN "+u.quoteTable(p,h)+" ON ",d+=O,_&&(d+=" AND "+_),d+=") ON "+w):(d+=T+u.quoteTable(R,S)+" ON ",d+=w,d+=T+u.quoteTable(p,h)+" ON ",d+=O,_&&(d+=" AND "+_)),(r.where||r.through.where)&&(r.where&&(l=u.getWhereConditions(r.where,u.sequelize.literal(u.quoteIdentifier(h)),r.model,I))&&(d+=" AND "+l),y&&r.required&&(t.where||(t.where={}),function(e){for(var r,n,i,s=e,l=e,c=[];s=s.parent;)c=[a.extend({},l,{include:c})],l=s;if(n=c[0],r=n.parent,n.through&&Object(n.through.model)===n.through.model)i=u.selectQuery(n.through.model.getTableName(),{attributes:[n.through.model.primaryKeyField],include:o.$validateIncludedElements({model:n.through.model,include:[{association:n.association.toTarget,required:!0}]}).include,model:n.through.model,where:{$and:[u.sequelize.asIs([u.quoteTable(r.model.name)+"."+u.quoteIdentifier(r.model.primaryKeyField),u.quoteIdentifier(n.through.model.name)+"."+u.quoteIdentifier(n.association.identifierField)].join(" = ")),n.through.where]},limit:1,includeIgnoreAttributes:!1},n.through.model);else{var p="BelongsTo"===n.association.associationType,h=[u.quoteTable(r.model.name)+"."+u.quoteIdentifier(p?n.association.identifierField:r.model.primaryKeyAttributes[0]),u.quoteIdentifier(n.model.name)+"."+u.quoteIdentifier(p?n.model.primaryKeyAttributes[0]:n.association.identifierField)].join(" = ");i=u.selectQuery(n.model.tableName,{attributes:[n.model.primaryKeyAttributes[0]],include:n.include,where:{$join:u.sequelize.asIs(h)},limit:1,includeIgnoreAttributes:!1},n.model)}t.where["__"+S]=u.sequelize.asIs(["(",i.replace(/\;$/,""),")","IS NOT NULL"].join(" "))}(r)))}else{if(y&&r.subQueryFilter){var U,j,F={};F[g.identifierField]={$raw:u.quoteTable(i)+"."+u.quoteIdentifier(g.sourceKeyField||g.source.primaryKeyField)},t.where||(t.where={}),U=u.selectQuery(r.model.getTableName(),{attributes:[g.identifierField],where:{$and:[F,r.where||{}]},limit:1},r.model),j=u.sequelize.asIs(["(",U.replace(/\;$/,""),")","IS NOT NULL"].join(" ")),n._.isPlainObject(t.where)?t.where["__"+h]=j:t.where={$and:[t.where,j]}}d=" "+u.joinIncludeQuery({model:c,subQuery:t.subQuery,include:r,groupedLimit:t.groupedLimit})}return r.subQuery&&y?m.subQuery.push(d):m.mainQuery.push(d),r.include&&r.include.filter(function(e){return!e.separate}).forEach(function(e){if(!e._pseudo){var t=A(e,h);e.subQuery&&y&&(m.subQuery=m.subQuery.concat(t.subQuery)),t.mainQuery&&(m.mainQuery=m.mainQuery.concat(t.mainQuery))}}.bind(this)),m};t.include.filter(function(e){return!e.separate}).forEach(function(e){var t=A(e,b);v=v.concat(t.subQuery),m=m.concat(t.mainQuery)}.bind(this))}if(y)g.push(this.selectFromTableFragment(t,r,E,s,b)),g.push(v.join(""));else{if(t.groupedLimit){b||(b=s);var T,N,I,w=a.assign({},t.where),O=b;if("string"==typeof t.groupedLimit.on?N=t.groupedLimit.on:t.groupedLimit.on instanceof h&&(N=t.groupedLimit.on.foreignKeyField),t.groupedLimit.on instanceof p){O=t.groupedLimit.on.manyFromSource.as;var _=o.$validateIncludedElements({include:[{association:t.groupedLimit.on.manyFromSource,duplicating:!1,required:!0,where:a.assign({$$PLACEHOLDER$$:!0},t.groupedLimit.through&&t.groupedLimit.through.where)}],model:r});t.hasJoin=!0,t.hasMultiAssociation=!0,t.includeMap=a.assign(_.includeMap,t.includeMap),t.includeNames=_.includeNames.concat(t.includeNames||[]),I=_.include,Array.isArray(t.order)&&(t.order.forEach(function(e,r){Array.isArray(e)&&(e=e[0]);var n="subquery_order_"+r;t.attributes.push([e,n]),n=this.sequelize.literal(this.quote(n)),Array.isArray(t.order[r])?t.order[r][0]=n:t.order[r]=n},this),T=t.order)}else T=t.order,delete t.order,w.$$PLACEHOLDER$$=!0;var R="("+this.selectQuery(e,{attributes:t.attributes,limit:t.groupedLimit.limit,order:T,where:w,include:I,model:r},r).replace(/;$/,"")+")",S=this.whereItemQuery("$$PLACEHOLDER$$",!0,{model:r}),q=R.indexOf(S);d.push(this.selectFromTableFragment(t,r,f,"("+t.groupedLimit.values.map(function(e){var r={};return N&&(r[N]=e),I&&(r[t.groupedLimit.on.foreignIdentifierField]=e),n.spliceStr(R,q,S.length,this.getWhereConditions(r,O))},this).join(u._dialect.supports["UNION ALL"]?" UNION ALL ":" UNION ")+")",b))}else d.push(this.selectFromTableFragment(t,r,f,s,b));d.push(m.join(""))}if(t.hasOwnProperty("where")&&!t.groupedLimit&&(t.where=this.getWhereConditions(t.where,b||e,r,t),t.where&&(y?g.push(" WHERE "+t.where):(d.push(" WHERE "+t.where),a.each(d,function(e,n){e.match(/^SELECT/)&&(d[n]=this.selectFromTableFragment(t,r,f,s,b,t.where))}.bind(this))))),t.group&&(t.group=Array.isArray(t.group)?t.group.map(function(e){return this.quote(e,r)}.bind(this)).join(", "):t.group,y?g.push(" GROUP BY "+t.group):d.push(" GROUP BY "+t.group)),t.hasOwnProperty("having")&&(t.having=this.getWhereConditions(t.having,e,r,t,!1),y?g.push(" HAVING "+t.having):d.push(" HAVING "+t.having)),t.order){var k=this.getQueryOrders(t,r,y);k.mainQueryOrder.length&&d.push(" ORDER BY "+k.mainQueryOrder.join(", ")),k.subQueryOrder.length&&g.push(" ORDER BY "+k.subQueryOrder.join(", "))}var D=this.addLimitAndOffset(t,r);if(D&&!t.groupedLimit&&(y?g.push(D):d.push(D)),y?(i="SELECT "+f.join(", ")+" FROM (",i+=g.join(""),i+=") AS "+b,i+=m.join(""),i+=d.join("")):i=d.join(""),t.lock&&this._dialect.supports.lock){var C=t.lock;"object"==typeof t.lock&&(C=t.lock.level),!this._dialect.supports.lockKey||"KEY SHARE"!==C&&"NO KEY UPDATE"!==C?i+="SHARE"===C?" "+this._dialect.supports.forShare:" FOR UPDATE":i+=" FOR "+C,this._dialect.supports.lockOf&&t.lock.of instanceof o&&(i+=" OF "+this.quoteTable(t.lock.of.name))}return i+=";"},getQueryOrders:function(e,t,r){var i=[],s=[],l=function(e){if(!(e instanceof n.literal||a.includes(["ASC","DESC","ASC NULLS LAST","DESC NULLS LAST","ASC NULLS FIRST","DESC NULLS FIRST","NULLS FIRST","NULLS LAST"],e.toUpperCase())))throw new Error(u.format("Order must be 'ASC' or 'DESC', '%s' given",e))};if(Array.isArray(e.order))e.order.forEach(function(e){Array.isArray(e)&&a.size(e)>1&&(e[0]instanceof o||e[0].model instanceof o?"string"==typeof e[e.length-2]&&l(a.last(e)):l(a.last(e)));var n=!1;if(!r||!Array.isArray(e)||e[0]instanceof o||e[0].model instanceof o||(s.push(this.quote(e,t)),n=!0),n)for(var u in t.attributes){var c=t.attributes[u];c.field&&c.field===e[0]&&(e[0]=c.fieldName)}i.push(this.quote(e,t))}.bind(this));else{var c=this.quote("string"==typeof e.order?new n.literal(e.order):e.order,t);r&&s.push(c),i.push(c)}return{mainQueryOrder:i,subQueryOrder:s}},selectFromTableFragment:function(e,t,r,n,i,o){var s="SELECT "+r.join(", ")+" FROM "+n;return i&&(s+=" AS "+i),s},joinIncludeQuery:function(e){for(var t,r,n,i,o=e.subQuery,s=e.include,a=s.association,u=s.parent,l=!s.parent.association&&s.parent.model.name===e.model.name,p=s.required?"INNER JOIN ":"LEFT OUTER JOIN ",h=a.source,d=a instanceof c?a.identifier:a.sourceKeyAttribute||h.primaryKeyAttribute,f=a instanceof c?a.identifierField:h.rawAttributes[a.sourceKeyAttribute||h.primaryKeyAttribute].field,m=s.model,y=s.as,g=m.getTableName(),E=a instanceof c?m.rawAttributes[a.targetIdentifier||m.primaryKeyAttribute].field:a.identifierField;(t=t&&t.parent||s.parent)&&t.association;)i=i?[t.as,i].join("."):t.as;return i?y=[i,y].join("."):i=u.as||u.model.name,r=[this.quoteTable(i),this.quoteIdentifier(f)].join("."),(e.groupedLimit&&l||o&&s.parent.subQuery&&!s.subQuery)&&(r=l?[this.quoteTable(u.as||u.model.name),this.quoteIdentifier(d)].join("."):this.quoteIdentifier(i+"."+d)),r+=" = "+this.quoteIdentifier(y)+"."+this.quoteIdentifier(E),s.on&&(r=this.whereItemsQuery(s.on,{prefix:this.sequelize.literal(this.quoteIdentifier(y)),model:s.model})),s.where&&(n=this.whereItemsQuery(s.where,{prefix:this.sequelize.literal(this.quoteIdentifier(y)),model:s.model}))&&(s.or?r+=" OR "+n:r+=" AND "+n),p+this.quoteTable(g,y)+" ON "+r},setAutocommitQuery:function(e,t){if(!t.parent)return"SET autocommit = "+(e?1:0)+";"},setIsolationLevelQuery:function(e,t){if(!t.parent)return"SET SESSION TRANSACTION ISOLATION LEVEL "+e+";"},generateTransactionId:function(){return d.v4()},startTransactionQuery:function(e){return e.parent?"SAVEPOINT "+this.quoteIdentifier(e.name,!0)+";":"START TRANSACTION;"},deferConstraintsQuery:function(){},setConstraintQuery:function(){},setDeferredQuery:function(){},setImmediateQuery:function(){},commitTransactionQuery:function(e){if(!e.parent)return"COMMIT;"},rollbackTransactionQuery:function(e){return e.parent?"ROLLBACK TO SAVEPOINT "+this.quoteIdentifier(e.name,!0)+";":"ROLLBACK;"},addLimitAndOffset:function(e,t){var r="";return null!=e.offset&&null==e.limit?r+=" LIMIT "+this.escape(e.offset)+", 10000000000000":null!=e.limit&&(null!=e.offset?r+=" LIMIT "+this.escape(e.offset)+", "+this.escape(e.limit):r+=" LIMIT "+this.escape(e.limit)),r},handleSequelizeMethod:function(e,t,r,i,o){var s,u=this;if(e instanceof n.where){var l,c=e.logic;l=e.attribute._isSequelizeMethod?this.getWhereConditions(e.attribute,t,r,i,o):this.quoteTable(e.attribute.Model.name)+"."+this.quoteIdentifier(e.attribute.field||e.attribute.fieldName),c&&c._isSequelizeMethod?(c=this.getWhereConditions(c,t,r,i,o),s="NULL"===c?l+" IS NULL":[l,c].join(e.comparator)):a.isPlainObject(c)?s=this.whereItemQuery(e.attribute,c,{model:r}):(c="boolean"==typeof c?this.booleanValue(c):this.escape(c),s="NULL"===c?l+" IS NULL":[l,c].join(" "+e.comparator+" "))}else if(e instanceof n.literal)s=e.val;else if(e instanceof n.cast)s=e.val._isSequelizeMethod?this.handleSequelizeMethod(e.val,t,r,i,o):a.isPlainObject(e.val)?this.whereItemsQuery(e.val):this.escape(e.val),s="CAST("+s+" AS "+e.type.toUpperCase()+")";else if(e instanceof n.fn)s=e.fn+"("+e.args.map(function(e){return e._isSequelizeMethod?u.handleSequelizeMethod(e,t,r,i,o):a.isPlainObject(e)?u.whereItemsQuery(e):u.escape(e)}).join(", ")+")";else{if(e instanceof n.col){if(Array.isArray(e.col)){if(!r)throw new Error("Cannot call Sequelize.col() with array outside of order / group clause")}else if(0===e.col.indexOf("*"))return"*";return this.quote(e.col,r)}s=e.toString(this,r)}return s},whereQuery:function(e,t){var r=this.whereItemsQuery(e,t);return r&&r.length?"WHERE "+r:""},whereItemsQuery:function(e,t,r){if(Array.isArray(e)&&0===e.length||a.isPlainObject(e)&&a.isEmpty(e)||null===e||void 0===e)return"";if(a.isString(e))throw new Error('where: "raw query" has been removed, please use where ["raw query", [replacements]]');var n=this,i=[];return r=r||"AND"," "!==r.substr(0,1)&&(r=" "+r+" "),a.isPlainObject(e)?a.forOwn(e,function(e,r){i.push(n.whereItemQuery(r,e,t))}):i.push(n.whereItemQuery(void 0,e,t)),i.length&&i.filter(function(e){return e&&e.length}).join(r)||""},whereItemQuery:function(e,t,r){r=r||{};var i,o,u,c,p,h=this,d="=",f=r.field||r.model&&r.model.rawAttributes&&r.model.rawAttributes[e]||r.model&&r.model.fieldRawAttributesMap&&r.model.fieldRawAttributesMap[e],m=r.type||f&&f.type;if(e&&"string"==typeof e&&-1!==e.indexOf(".")&&r.model&&r.model.rawAttributes[e.split(".")[0]]&&r.model.rawAttributes[e.split(".")[0]].type instanceof s.JSON&&(f=r.model.rawAttributes[e.split(".")[0]],m=f.type,p=t,t={},l.set(t,e.split(".").slice(1),p),e=f.field||e.split(".")[0]),u={$eq:"=",$ne:"!=",$gte:">=",$gt:">",$lte:"<=",$lt:"<",$not:"IS NOT",$is:"IS",$like:"LIKE",$notLike:"NOT LIKE",$iLike:"ILIKE",$notILike:"NOT ILIKE",$between:"BETWEEN",$notBetween:"NOT BETWEEN",$overlap:"&&",$contains:"@>",$contained:"<@"},c={ne:"$ne",in:"$in",not:"$not",notIn:"$notIn",gte:"$gte",gt:"$gt",lte:"$lte",lt:"$lt",like:"$like",ilike:"$iLike",$ilike:"$iLike",nlike:"$notLike",$notlike:"$notLike",notilike:"$notILike","..":"$between",between:"$between","!..":"$notBetween",notbetween:"$notBetween",nbetween:"$notBetween",overlap:"$overlap","&&":"$overlap","@>":"$contains","<@":"$contained"},e=c[e]||e,a.isPlainObject(t)&&a.forOwn(t,function(e,r){c[r]&&(t[c[r]]=e,delete t[r])}),void 0===e){if("string"==typeof t)return t;a.isPlainObject(t)&&1===a.size(t)&&(e=Object.keys(t)[0],t=a.values(t)[0])}if(t&&t._isSequelizeMethod&&!(void 0!==e&&t instanceof n.fn))return this.handleSequelizeMethod(t);if(void 0===e&&Array.isArray(t)){if(!n.canTreatArrayAsAnd(t))return n.format(t,this.dialect);e="$and"}if("$or"===e||"$and"===e||"$not"===e)return i="$or"===e?" OR ":" AND ",o="","$not"===e&&(o="NOT "),Array.isArray(t)?(t=t.map(function(e){var t=h.whereItemsQuery(e,r," AND ");return(Array.isArray(e)||a.isPlainObject(e))&&a.size(e)>1&&(t="("+t+")"),t}).filter(function(e){return e&&e.length}),"$or"!==e&&"$not"!==e||0!==t.length?t.length?o+"("+t.join(i)+")":void 0:"0 = 1"):(t=h.whereItemsQuery(t,r,i),"$or"!==e&&"$not"!==e||t?t?o+"("+t+")":void 0:"0 = 1");if(t&&(t.$or||t.$and))return i=t.$or?" OR ":" AND ",t=t.$or||t.$and,a.isPlainObject(t)&&(t=a.reduce(t,function(e,t,r){return e.push(a.zipObject([r],[t])),e},[])),t=t.map(function(t){return h.whereItemQuery(e,t,r)}).filter(function(e){return e&&e.length}),t.length?"("+t.join(i)+")":void 0;if(a.isPlainObject(t)&&m instanceof s.JSON&&!1!==r.json)return function(){var i,o,s=[];return o=function(t,i,u){var l,c,p,d,f,m={};u[u.length-1].indexOf("::")>-1&&(d=u[u.length-1].split("::"),c=d[1],u[u.length-1]=d[0]),p=h.quoteIdentifier(e)+"#>>'{"+u.join(", ")+"}'",r.prefix&&(p=r.prefix instanceof n.literal?h.handleSequelizeMethod(r.prefix)+"."+p:h.quoteTable(r.prefix)+"."+p),p="("+p+")",f=function(e){var t=p;return c||("number"==typeof e?c="double precision":e instanceof Date?c="timestamptz":"boolean"==typeof e&&(c="boolean")),c&&(t+="::"+c),t},a.isPlainObject(i)?a.forOwn(i,function(e,t){0===t.indexOf("$")?(m[t]=e,l=f(e),s.push(h.whereItemQuery(new n.literal(l),m))):o(t,e,u.concat([t]))}):(m.$eq=i,l=f(i),s.push(h.whereItemQuery(new n.literal(l),m)))},a.forOwn(t,function(t,n){if(0===n.indexOf("$")){var i={};return i[n]=t,void s.push(h.whereItemQuery(e,i,a.assign({},r,{json:!1})))}o(n,t,[n])}),i=s.join(" AND "),s.length>1?"("+i+")":i}();if(a.isPlainObject(t)&&Object.keys(t).length>1)return function(){var n=[];return a.forOwn(t,function(t,i){var o={};o[i]=t,n.push(h.whereItemQuery(e,o,r))}),"("+n.join(" AND ")+")"}();if(!t||m&&m instanceof s.ARRAY||(Array.isArray(t)?t={$in:t}:t&&Array.isArray(t.$not)&&(t.$notIn=t.$not,delete t.$not)),t&&void 0!==t.$not&&[null,!0,!1].indexOf(t.$not)<0&&(t.$ne=t.$not,delete t.$not),Array.isArray(t)&&m instanceof s.ARRAY)t=this.escape(t,f);else if(t&&(t.$in||t.$notIn))d="IN",t.$notIn&&(d="NOT IN"),t=(t.$in||t.$notIn)instanceof n.literal?(t.$in||t.$notIn).val:(t.$in||t.$notIn).length?"("+(t.$in||t.$notIn).map(function(e){return h.escape(e)}).join(", ")+")":"(NULL)";else if(t&&(t.$any||t.$all))d=t.$any?"= ANY":"= ALL",t=t.$any&&t.$any.$values||t.$all&&t.$all.$values?"(VALUES "+(t.$any&&t.$any.$values||t.$all&&t.$all.$values).map(function(e){return"("+this.escape(e)+")"}.bind(this)).join(", ")+")":"("+this.escape(t.$any||t.$all,f)+")";else if(t&&(t.$between||t.$notBetween))d="BETWEEN",t.$notBetween&&(d="NOT BETWEEN"),t=(t.$between||t.$notBetween).map(function(e){return h.escape(e)}).join(" AND ");else if(t&&t.$raw)t=t.$raw;else if(t&&t.$col)t=t.$col.split("."),t.length>2&&(t=[t.slice(0,-1).join("."),t[t.length-1]]),t=t.map(this.quoteIdentifier.bind(this)).join(".");else{var y=!0,g={};a.isPlainObject(t)&&a.forOwn(t,function(e,r){u[r]&&(d=u[r],t=e,a.isPlainObject(t)&&t.$any?(d+=" ANY",g.isList=!0,t=t.$any):a.isPlainObject(t)&&t.$all?(d+=" ALL",g.isList=!0,t=t.$all):t&&t.$col&&(y=!1,t=this.whereItemQuery(null,t)))}.bind(this)),"="===d&&null===t?d="IS":"!="===d&&null===t&&(d="IS NOT"),g.acceptStrings=-1!==d.indexOf("LIKE"),y&&(t=this.escape(t,f,g),g.acceptStrings&&d.indexOf("ANY")>d.indexOf("LIKE")&&(t="("+t+")"))}if(e){var E=!0;return e._isSequelizeMethod?e=this.handleSequelizeMethod(e):n.isColString(e)?(e=e.substr(1,e.length-2).split("."),e.length>2&&(e=[e.slice(0,-1).join("."),e[e.length-1]]),e=e.map(this.quoteIdentifier.bind(this)).join("."),E=!1):e=this.quoteIdentifier(e),r.prefix&&E&&(e=r.prefix instanceof n.literal?[this.handleSequelizeMethod(r.prefix),e].join("."):[this.quoteTable(r.prefix),e].join(".")),[e,t].join(" "+d+" ")}return t},getWhereConditions:function(e,t,r,i,o){var s=null,a={},u=this;if(Array.isArray(t)&&(t=t[0],Array.isArray(t)&&(t=t[1])),i=i||{},void 0===o&&(o=!0),e&&!0===e._isSequelizeMethod)s=this.handleSequelizeMethod(e,t,r,i,o);else{if(n._.isPlainObject(e))return u.whereItemsQuery(e,{model:r,prefix:o&&t});if("number"==typeof e){var l=r?Object.keys(r.primaryKeys):[];return l=l.length>0?l[0]:"id",a[l]=e,u.whereItemsQuery(a,{model:r,prefix:o&&t})}if("string"==typeof e)return u.whereItemsQuery(e,{model:r,prefix:o&&t});if(Buffer.isBuffer(e))s=this.escape(e);else if(Array.isArray(e)){if(0===e.length)return"1=1";if(n.canTreatArrayAsAnd(e)){var c={$and:e};s=u.getWhereConditions(c,t,r,i,o)}else s=n.format(e,this.dialect)}else if(null===e)return u.whereItemsQuery(e,{model:r,prefix:o&&t})}return s||"1=1"},booleanValue:function(e){return e}};e.exports=y},function(e,t,r){"use strict";var n=r(3),i=r(38),o=r(41),s=r(14),a=function(e,t,r){},u=function(e,t,r){if(!e.length)return[];var i,o,s,a,u,l,c,p,h,d,f,m,y,g,E,v,b,A,T,N,I,w,O,_,R,S,q,k=e.length,D=r.checkExisting,C=D?[]:new Array(k),L={},M={},x=function(e){w.includeMap[e]&&(M[p]=w=w.includeMap[e],_=_?_+"."+e:e,M[_]=w)},P={},K=function(e,t){return t[e]||(t[e]=e.substr(0,e.lastIndexOf("."))),t[e]},U={},j=function(e){if(!U[e]){var t=e.lastIndexOf(".");U[e]=e.substr(-1===t?0:t+1)}return U[e]},F={},Q=function(e){if(!F[e]){var t=K(e,P);F[t]||(F[t]=t?t.split("."):[]),F[e]=F[t]}return F[e]},B={},V=function(e){if(!B[e]){var t=Q(e),r=t.length;B[e]=r?t[r-1]:""}return B[e]},z=function(e){var t=n._.chain(e.uniqueKeys);return t=t.result(t.findKey()+".fields").map(function(t){return n._.findKey(e.attributes,function(e){return e.field===t})}).value()};for(u=0;u<k;u++){if(l=e[u],0===u&&(c=Object.keys(l),d=c.length),D)if(g=!1,a=t.model.primaryKeyAttributes.length,b="",1===a)b=l[t.model.primaryKeyAttributes[0]];else if(a>1)for(s=0;s<a;s++)b+=l[t.model.primaryKeyAttributes[s]];else if(!n._.isEmpty(t.model.uniqueKeys))for(S=z(t.model),s=0;s<S.length;s++)b+=l[S[s]];for(y=m={},N=void 0,h=0;h<d;h++){if(p=c[h],T=K(p,P),A=Q(p),0===u&&void 0===M[p]&&(A.length?(w=t,_=void 0,A.forEach(x)):M[p]=M[""]=t),void 0!==N&&N!==A)if(D){if(o=N.length,O=null,v=null,o)for(i=0;i<o;i++){if(q=O?O+"."+N[i]:N[i],R=M[q].model.primaryKeyAttributes,a=R.length,E=q,1===a)E+=l[q+"."+R[0]];else if(a>1)for(s=0;s<a;s++)E+=l[q+"."+R[s]];else if(!n._.isEmpty(M[q].model.uniqueKeys))for(S=z(M[q].model),s=0;s<S.length;s++)E+=l[q+"."+S[s]];v||(v=b),E=v+E,O=q,i<o-1&&(v=E)}else E=b;E===b?L[E]?g=!0:L[E]=m:!L[E]&&(O=L[v])&&(I=V(f),M[f].association.isSingleAssociation?O[I]=L[E]=m:(O[I]||(O[I]=[]),O[I].push(L[E]=m))),m={}}else if(w=y,o=A.length)for(i=0;i<o;i++)i===o-1&&(m=w[A[i]]={}),w=w[A[i]];m[j(p)]=l[p],f=p,N=A,T}if(D){if(o=N.length,O=null,v=null,o)for(i=0;i<o;i++){if(q=O?O+"."+N[i]:N[i],R=M[q].model.primaryKeyAttributes,a=R.length,E=q,1===a)E+=l[q+"."+R[0]];else if(a>0)for(s=0;s<a;s++)E+=l[q+"."+R[s]];else if(!n._.isEmpty(M[q].model.uniqueKeys))for(S=z(M[q].model),s=0;s<S.length;s++)E+=l[q+"."+S[s]];v||(v=b),E=v+E,O=q,i<o-1&&(v=E)}else E=b;E===b?L[E]?g=!0:L[E]=m:!L[E]&&(O=L[v])&&(I=V(f),M[f].association.isSingleAssociation?O[I]=L[E]=m:(O[I]||(O[I]=[]),O[I].push(L[E]=m))),g||C.push(y)}else C[u]=y}return C};a.formatBindParameters=function(e,t,r,n,o){if(!t)return[e,[]];if(o=o||{},"function"!=typeof n&&(o=n||{},n=void 0),n){if(o.skipValueReplace){var s=n;n=function(e,t,r,n,i,o){if(void 0!==s(e,t,r,n,i,o))return e}}}else n=o.skipValueReplace?function(e,t,r,n,i,o){if(void 0!==r[t])return e}:function(e,t,r,n,o,s){if(void 0!==r[t])return i.escape(r[t],!1,n,o)};var a=null,u=Array.isArray(t);return e=e.replace(/\$(\$|\w+)/g,function(e,i){if("$"===i)return o.skipUnescape?e:i;var s;if(u?i.match(/^[1-9]\d*$/)&&(i-=1,s=n(e,i,t,a,r,o)):i.match(/^\d*$/)||(s=n(e,i,t,a,r,o)),void 0===s)throw new Error('Named bind parameter "'+e+'" has no value in the given object.');return s}),[e,[]]},a.prototype.run=function(){throw new Error("The run method wasn't overwritten!")},a.prototype.checkLoggingOption=function(){!0===this.options.logging&&(console.log("DEPRECATION WARNING: The logging-option should be either a function or false. Default: console.log"),this.options.logging=console.log)},a.prototype.getInsertIdField=function(){return"insertId"},a.prototype.findTableNameInAttribute=function(e){if(!this.options.include)return null;this.options.includeNames||(this.options.includeNames=this.options.include.map(function(e){return e.as}));var t=this.options.includeNames.filter(function(t){return 0===e.indexOf(t+".")});return 1===t.length?t[0]:null},a.prototype.getUniqueConstraintErrorMessage=function(e){var t=e+" must be unique",r=this;return r.model&&Object.keys(r.model.uniqueKeys).forEach(function(n){r.model.uniqueKeys[n].fields.indexOf(e.replace(/"/g,""))>=0&&r.model.uniqueKeys[n].msg&&(t=r.model.uniqueKeys[n].msg)}),t},a.prototype.isRawQuery=function(){return this.options.type===s.RAW},a.prototype.isVersionQuery=function(){return this.options.type===s.VERSION},a.prototype.isUpsertQuery=function(){return this.options.type===s.UPSERT},a.prototype.isInsertQuery=function(e,t){var r=!0;return this.options.type===s.INSERT||(r=r&&0===this.sql.toLowerCase().indexOf("insert into"),r=r&&(!e||e.hasOwnProperty(this.getInsertIdField())),r=r&&(!t||t.hasOwnProperty(this.getInsertIdField())))},a.prototype.handleInsertQuery=function(e,t){if(this.instance){var r=this.model.autoIncrementField,n=null;n=n||e&&e[this.getInsertIdField()],n=n||t&&t[this.getInsertIdField()],this.instance[r]=n}},a.prototype.isShowTablesQuery=function(){return this.options.type===s.SHOWTABLES},a.prototype.handleShowTablesQuery=function(e){return n._.flatten(e.map(function(e){return n._.values(e)}))},a.prototype.isShowIndexesQuery=function(){return this.options.type===s.SHOWINDEXES},a.prototype.isDescribeQuery=function(){return this.options.type===s.DESCRIBE},a.prototype.isSelectQuery=function(){return this.options.type===s.SELECT},a.prototype.isBulkUpdateQuery=function(){return this.options.type===s.BULKUPDATE},a.prototype.isBulkDeleteQuery=function(){return this.options.type===s.BULKDELETE},a.prototype.isForeignKeysQuery=function(){return this.options.type===s.FOREIGNKEYS},a.prototype.isUpdateQuery=function(){return this.options.type===s.UPDATE},a.prototype.handleSelectQuery=function(e){var t=null;if(this.options.fieldMap){var r=this.options.fieldMap;e=n._.map(e,function(e){return n._.reduce(r,function(e,t,r){return void 0!==e[r]&&(e[t]=e[r],delete e[r]),e},e)})}return this.options.raw?t=e.map(function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return this.options.nest&&(t=o.transform(t)),t},this):!0===this.options.hasJoin?(e=u(e,{model:this.model,includeMap:this.options.includeMap,includeNames:this.options.includeNames},{checkExisting:this.options.hasMultiAssociation}),t=this.model.bulkBuild(e,{isNewRecord:!1,include:this.options.include,includeNames:this.options.includeNames,includeMap:this.options.includeMap,includeValidated:!0,attributes:this.options.originalAttributes||this.options.attributes,raw:!0})):t=this.model.bulkBuild(e,{isNewRecord:!1,raw:!0,attributes:this.options.attributes}),this.options.plain&&(t=0===t.length?null:t[0]),t},a.prototype.isShowOrDescribeQuery=function(){var e=!1;return e=e||0===this.sql.toLowerCase().indexOf("show"),e=e||0===this.sql.toLowerCase().indexOf("describe")},a.prototype.isCallQuery=function(){var e=!1;return e=e||0===this.sql.toLowerCase().indexOf("call")},a.$groupJoinData=u,e.exports=a},function(e,t,r){"use strict";var n={};e.exports=function(e){return n[e]=n[e]||{},{clear:function(){n[e]={}},refresh:function(t){t.types[e].forEach(function(r){n[e][r]=t.parse})},get:function(t){return n[e][t]}}}},function(e,t,r){"use strict";function n(e,t){this.sequelize=e,this.savepoints=[];var r=this.sequelize.dialect.QueryGenerator.generateTransactionId;this.options=i._.extend({autocommit:!0,type:e.options.transactionType,isolationLevel:e.options.isolationLevel,readOnly:!1},t||{}),this.parent=this.options.transaction,this.id=this.parent?this.parent.id:r(),this.parent?(this.id=this.parent.id,this.parent.savepoints.push(this),this.name=this.id+"-savepoint-"+this.parent.savepoints.length):this.id=this.name=r(),delete this.options.transaction}var i=r(3);n.TYPES={DEFERRED:"DEFERRED",IMMEDIATE:"IMMEDIATE",EXCLUSIVE:"EXCLUSIVE"},n.ISOLATION_LEVELS={READ_UNCOMMITTED:"READ UNCOMMITTED",READ_COMMITTED:"READ COMMITTED",REPEATABLE_READ:"REPEATABLE READ",SERIALIZABLE:"SERIALIZABLE"},n.LOCK=n.prototype.LOCK={UPDATE:"UPDATE",SHARE:"SHARE",KEY_SHARE:"KEY SHARE",NO_KEY_UPDATE:"NO KEY UPDATE"},n.prototype.commit=function(){var e=this;if(this.finished)throw new Error("Transaction cannot be committed because it has been finished with state: "+e.finished);return this.$clearCls(),this.sequelize.getQueryInterface().commitTransaction(this,this.options).finally(function(){return e.finished="commit",e.parent?null:e.cleanup()})},n.prototype.rollback=function(){var e=this;if(this.finished)throw new Error("Transaction cannot be rolled back because it has been finished with state: "+e.finished);return this.$clearCls(),this.sequelize.getQueryInterface().rollbackTransaction(this,this.options).finally(function(){return e.parent?e:e.cleanup()})},n.prototype.prepareEnvironment=function(){var e,t=this;if(this.parent)e=i.Promise.resolve(this.parent.connection);else{var r={uuid:this.id};this.options.readOnly&&(r.type="SELECT"),e=this.sequelize.connectionManager.getConnection(r)}return e.then(function(e){t.connection=e,t.connection.uuid=t.id}).then(function(){return t.begin()}).then(function(){return t.setDeferrable()}).then(function(){return t.setIsolationLevel()}).then(function(){return t.setAutocommit()}).catch(function(e){return t.rollback().finally(function(){throw e})}).tap(function(){return t.sequelize.constructor.cls&&t.sequelize.constructor.cls.set("transaction",t),null})},n.prototype.begin=function(){return this.sequelize.getQueryInterface().startTransaction(this,this.options)},n.prototype.setDeferrable=function(){if(this.options.deferrable)return this.sequelize.getQueryInterface().deferConstraints(this,this.options)},n.prototype.setAutocommit=function(){return this.sequelize.getQueryInterface().setAutocommit(this,this.options.autocommit,this.options)},n.prototype.setIsolationLevel=function(){return this.sequelize.getQueryInterface().setIsolationLevel(this,this.options.isolationLevel,this.options)},n.prototype.cleanup=function(){var e=this.sequelize.connectionManager.releaseConnection(this.connection);return this.connection.uuid=void 0,e},n.prototype.$clearCls=function(){var e=this.sequelize.constructor.cls;e&&e.get("transaction")===this&&e.set("transaction",null)},e.exports=n,e.exports.Transaction=n,e.exports.default=n},function(e,t,r){"use strict";var n=r(2),i=r(1),o=r(13),s=r(178),a=void 0;i.redis.enabled&&(a=new s(i.redis.uri),a.on("connect",function(e){n.info(o.green.bold("Redis client connected!"))}),a.on("error",function(e){n.error(e)}),i.isDevMode()&&a.monitor(function(e,t){n.debug("Redis entering monitoring mode..."),t.on("monitor",function(e,t,r,i){n.debug("REDIS: ",t)})})),e.exports=a},function(e,t,r){"use strict";var n=r(2),i=(r(1),r(7),r(15),r(67)),o=(r(0),r(65),r(10),r(198)),s=r(66),a=(r(64)(s),{IO:null,mongoStore:null,namespaces:{},userSockets:[],init:function(e,t){var s=i.createServer(e),u=o(s);return e.io=a,a.IO=u,u.on("connection",function(e){e.on("welcome",function(t){n.info("Incoming welcome message from "+e.request.user.username+":",t)})}),r(16).registerSockets(u,a),s},addNameSpace:function(e,t){var r=a.namespaces[e];return null==r&&(r=a.IO.of(e),a.initNameSpace(e,r,a.mongoStore,t)),r}});e.exports=a},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("express")},function(e,t,r){"use strict";var n=r(3),i=r(21),o=r(0),s=r(18),a=r(8),u=function(e,t,r){s.call(this),this.associationType="HasOne",this.source=e,this.target=t,this.options=r,this.scope=r.scope,this.isSingleAssociation=!0,this.isSelfAssociation=this.source===this.target,this.as=this.options.as,this.foreignKeyAttribute={},this.as?(this.isAliased=!0,this.options.name={singular:this.as}):(this.as=this.target.options.name.singular,this.options.name=this.target.options.name),o.isObject(this.options.foreignKey)?(this.foreignKeyAttribute=this.options.foreignKey,this.foreignKey=this.foreignKeyAttribute.name||this.foreignKeyAttribute.fieldName):this.options.foreignKey&&(this.foreignKey=this.options.foreignKey),this.foreignKey||(this.foreignKey=n.camelizeIf([n.underscoredIf(n.singularize(this.source.name),this.target.options.underscored),this.source.primaryKeyAttribute].join("_"),!this.source.options.underscored)),this.sourceIdentifier=this.source.primaryKeyAttribute,this.sourceKey=this.source.primaryKeyAttribute,this.sourceKeyIsPrimary=this.sourceKey===this.source.primaryKeyAttribute,this.associationAccessor=this.as,this.options.useHooks=r.useHooks,this.target.rawAttributes[this.foreignKey]&&(this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey);var i=n.uppercaseFirst(this.options.name.singular);this.accessors={get:"get"+i,set:"set"+i,create:"create"+i}};a.inherits(u,s),u.prototype.injectAttributes=function(){var e={},t=this.source.rawAttributes[this.source.primaryKeyAttribute].type;if(e[this.foreignKey]=o.defaults({},this.foreignKeyAttribute,{type:this.options.keyType||t,allowNull:!0}),n.mergeDefaults(this.target.rawAttributes,e),this.identifierField=this.target.rawAttributes[this.foreignKey].field||this.foreignKey,!1!==this.options.constraints){var r=this.target.rawAttributes[this.foreignKey]||e[this.foreignKey];this.options.onDelete=this.options.onDelete||(r.allowNull?"SET NULL":"CASCADE"),this.options.onUpdate=this.options.onUpdate||"CASCADE"}return i.addForeignKeyConstraints(this.target.rawAttributes[this.foreignKey],this.source,this.target,this.options),this.target.refreshAttributes(),i.checkNamingCollision(this),this},u.prototype.mixin=function(e){var t=this;e[this.accessors.get]=function(e){return t.get(this,e)},t.injectSetter(e),t.injectCreator(e)},u.prototype.get=function(e,t){var r,i=this,s=i.target,a={};return t=n.cloneDeep(t),t.hasOwnProperty("scope")&&(s=t.scope?s.scope(t.scope):s.unscoped()),t.hasOwnProperty("schema")&&(s=s.schema(t.schema,t.schemaDelimiter)),Array.isArray(e)||(r=e,e=void 0),a[i.foreignKey]=e?{$in:e.map(function(e){return e.get(i.sourceKey)})}:r.get(i.sourceKey),i.scope&&o.assign(a,i.scope),t.where=t.where?{$and:[a,t.where]}:a,e?s.findAll(t).then(function(t){var r={};return e.forEach(function(e){r[e.get(i.sourceKey,{raw:!0})]=null}),t.forEach(function(e){r[e.get(i.foreignKey,{raw:!0})]=e}),r}):s.findOne(t)},u.prototype.injectSetter=function(e){var t=this;return e[this.accessors.set]=function(e,r){var n,i=this;return r=o.assign({},r,{scope:!1}),i[t.accessors.get](r).then(function(i){if(n=i&&e&&o.every(t.target.primaryKeyAttributes,function(t){return i.get(t,{raw:!0})===e.get(t,{raw:!0})}),i&&!n)return i[t.foreignKey]=null,i.save(o.extend({},r,{fields:[t.foreignKey],allowNull:[t.foreignKey],association:!0}))}).then(function(){if(e&&!n){if(!(e instanceof t.target.Instance)){var s={};s[t.target.primaryKeyAttribute]=e,e=t.target.build(s,{isNewRecord:!1})}return o.assign(e,t.scope),e.set(t.foreignKey,i.get(t.sourceIdentifier)),e.save(r)}return null})},this},u.prototype.injectCreator=function(e){var t=this;return e[this.accessors.create]=function(e,r){var n=this;return e=e||{},r=r||{},t.scope&&Object.keys(t.scope).forEach(function(n){e[n]=t.scope[n],r.fields&&r.fields.push(n)}),e[t.foreignKey]=n.get(t.sourceIdentifier),r.fields&&r.fields.push(t.foreignKey),t.target.create(e,r)},this},e.exports=u,e.exports.HasOne=u,e.exports.default=u},function(e,t,r){"use strict";function n(e){return null===e?null:o.stringify(e)}function i(e){return null===e?null:o.parse(e)}var o=r(!function(){var e=new Error('Cannot find module "pg-hstore"');throw e.code="MODULE_NOT_FOUND",e}())({sanitize:!0});e.exports={stringify:n,parse:i}},function(e,t,r){"use strict";var n=r(4),i=r(0),o=t;o.escapeId=function(e,t){return t?"`"+e.replace(/`/g,"``")+"`":"`"+e.replace(/`/g,"``").replace(/\./g,"`.`")+"`"},o.escape=function(e,t,r,s){var a=!1;if(void 0===e||null===e)return"NULL";switch(typeof e){case"boolean":return"sqlite"===r||"mssql"===r?+!!e:""+!!e;case"number":return e+"";case"string":a="mssql"===r}if(e instanceof Date&&(e=n[r].DATE.prototype.stringify(e,{timezone:t})),Buffer.isBuffer(e))return n[r].BLOB?n[r].BLOB.prototype.stringify(e):n.BLOB.prototype.stringify(e);if(Array.isArray(e)){var u=i.partial(o.escape,i,t,r,s);return"postgres"!==r||s?e.map(u):n.ARRAY.prototype.stringify(e,{escape:u})}return e="postgres"===r||"sqlite"===r||"mssql"===r?e.replace(/'/g,"''"):e.replace(/[\0\n\r\b\t\\\'\"\x1a]/g,function(e){switch(e){case"\0":return"\\0";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"\t":return"\\t";case"":return"\\Z";default:return"\\"+e}}),(a?"N'":"'")+e+"'"},o.format=function(e,t,r,n){return t=[].concat(t),e.replace(/\?/g,function(e){return t.length?o.escape(t.shift(),r,n,!0):e})},o.formatNamedParameters=function(e,t,r,n){return e.replace(/\:+(?!\d)(\w+)/g,function(e,i){if("postgres"===n&&"::"===e.slice(0,2))return e;if(void 0!==t[i])return o.escape(t[i],r,n,!0);throw new Error('Named parameter "'+e+'" has no value in the given object.')})}},function(e,t,r){"use strict";var n=r(202),i=new n(256,n.BASE62);e.exports=function(){return i.generate()}},function(e,t,r){"use strict";function n(e,t,r,o,s,a){a&&a.stack?Object.defineProperty(this,"stack",{value:a.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,n):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0});var u=r;if(!u&&t&&t.length>0){var l=t[0];u=l&&l.loc&&l.loc.source}var c=o;!c&&t&&(c=t.filter(function(e){return Boolean(e.loc)}).map(function(e){return e.loc.start})),c&&0===c.length&&(c=void 0);var p=void 0,h=u;h&&c&&(p=c.map(function(e){return(0,i.getLocation)(h,e)})),Object.defineProperties(this,{message:{value:e,enumerable:!0,writable:!0},locations:{value:p||void 0,enumerable:!0},path:{value:s||void 0,enumerable:!0},nodes:{value:t||void 0},source:{value:u||void 0},positions:{value:c||void 0},originalError:{value:a}})}Object.defineProperty(t,"__esModule",{value:!0}),t.GraphQLError=n;var i=r(55);n.prototype=Object.create(Error.prototype,{constructor:{value:n},name:{value:"GraphQLError"}})},function(e,t){e.exports=require("dottie")},function(e,t){e.exports=require("moment-timezone")},function(e,t){e.exports=require("uuid")},function(e,t){e.exports=require("validator")},function(e,t){e.exports=require("webpack")},function(e,t,r){"use strict";var n=r(0),i=r(27),o=r(96),s=r(99),a=r(47),u=r(4).mysql,l=function(e){this.sequelize=e,this.connectionManager=new o(this,e),this.connectionManager.initPools(),this.QueryGenerator=n.extend({},a,{options:e.options,_dialect:this,sequelize:e})};l.prototype.supports=n.merge(n.cloneDeep(i.prototype.supports),{"VALUES ()":!0,"LIMIT ON UPDATE":!0,IGNORE:" IGNORE",lock:!0,forShare:"LOCK IN SHARE MODE",index:{collate:!1,length:!0,parser:!0,type:!0,using:1},ignoreDuplicates:" IGNORE",updateOnDuplicate:!0,indexViaAlter:!0,NUMERIC:!0,GEOMETRY:!0}),o.prototype.defaultVersion="5.6.0",l.prototype.Query=s,l.prototype.QueryGenerator=a,l.prototype.DataTypes=u,l.prototype.name="mysql",l.prototype.TICK_CHAR="`",l.prototype.TICK_CHAR_LEFT=l.prototype.TICK_CHAR,l.prototype.TICK_CHAR_RIGHT=l.prototype.TICK_CHAR,e.exports=l},function(e,t,r){"use strict";function n(e){return i.addTicks(e,"'")}var i=r(3),o={dialect:"mysql",createSchema:function(){return i._.template("SHOW TABLES")({})},showSchemasQuery:function(){return"SHOW TABLES"},versionQuery:function(){return"SELECT VERSION() as `version`"},createTableQuery:function(e,t,r){r=i._.extend({engine:"InnoDB",charset:null},r||{});var n=this,o="CREATE TABLE IF NOT EXISTS <%= table %> (<%= attributes%>) ENGINE=<%= engine %><%= comment %><%= charset %><%= collation %><%= initialAutoIncrement %>",s=[],a={},u=[];for(var l in t)if(t.hasOwnProperty(l)){var c,p=t[l];i._.includes(p,"PRIMARY KEY")?(s.push(l),i._.includes(p,"REFERENCES")?(c=p.match(/^(.+) (REFERENCES.*)$/),u.push(this.quoteIdentifier(l)+" "+c[1].replace(/PRIMARY KEY/,"")),a[l]=c[2]):u.push(this.quoteIdentifier(l)+" "+p.replace(/PRIMARY KEY/,""))):i._.includes(p,"REFERENCES")?(c=p.match(/^(.+) (REFERENCES.*)$/),u.push(this.quoteIdentifier(l)+" "+c[1]),a[l]=c[2]):u.push(this.quoteIdentifier(l)+" "+p)}var h={table:this.quoteTable(e),attributes:u.join(", "),comment:r.comment&&i._.isString(r.comment)?" COMMENT "+this.escape(r.comment):"",engine:r.engine,charset:r.charset?" DEFAULT CHARSET="+r.charset:"",collation:r.collate?" COLLATE "+r.collate:"",initialAutoIncrement:r.initialAutoIncrement?" AUTO_INCREMENT="+r.initialAutoIncrement:""},d=s.map(function(e){return this.quoteIdentifier(e)}.bind(this)).join(", ");r.uniqueKeys&&i._.each(r.uniqueKeys,function(t,r){t.singleField||(i._.isString(r)||(r="uniq_"+e+"_"+t.fields.join("_")),h.attributes+=", UNIQUE "+n.quoteIdentifier(r)+" ("+i._.map(t.fields,n.quoteIdentifier).join(", ")+")")}),d.length>0&&(h.attributes+=", PRIMARY KEY ("+d+")");for(var f in a)a.hasOwnProperty(f)&&(h.attributes+=", FOREIGN KEY ("+this.quoteIdentifier(f)+") "+a[f]);return i._.template(o)(h).trim()+";"},showTablesQuery:function(){return"SHOW TABLES;"},addColumnQuery:function(e,t,r){var n=i._.template("<%= key %> <%= definition %>")({key:this.quoteIdentifier(t),definition:this.attributeToSQL(r,{context:"addColumn",foreignKey:t})});return i._.template("ALTER TABLE <%= table %> ADD <%= attribute %>;")({table:this.quoteTable(e),attribute:n})},removeColumnQuery:function(e,t){return i._.template("ALTER TABLE <%= tableName %> DROP <%= attributeName %>;")({tableName:this.quoteTable(e),attributeName:this.quoteIdentifier(t)})},changeColumnQuery:function(e,t){var r="ALTER TABLE <%= tableName %> <%= query %>;",n=[],o=[];for(var s in t){var a=t[s];a.match(/REFERENCES/)?o.push(i._.template("<%= fkName %> FOREIGN KEY (<%= attrName %>) <%= definition %>")({fkName:this.quoteIdentifier(s+"_foreign_idx"),attrName:this.quoteIdentifier(s),definition:a.replace(/.+?(?=REFERENCES)/,"")})):n.push(i._.template("`<%= attrName %>` `<%= attrName %>` <%= definition %>")({attrName:s,definition:a}))}var u="";return n.length&&(u+="CHANGE "+n.join(", "),u+=o.length?" ":""),o.length&&(u+="ADD CONSTRAINT "+o.join(", ")),i._.template(r)({tableName:this.quoteTable(e),query:u})},renameColumnQuery:function(e,t,r){var n="ALTER TABLE <%= tableName %> CHANGE <%= attributes %>;",o=[];for(var s in r){var a=r[s];o.push(i._.template("`<%= before %>` `<%= after %>` <%= definition %>")({before:t,after:s,definition:a}))}return i._.template(n)({tableName:this.quoteTable(e),attributes:o.join(", ")})},upsertQuery:function(e,t,r,n,i,o){return o.onDuplicate="UPDATE ",o.onDuplicate+=Object.keys(r).map(function(e){return(e=this.quoteIdentifier(e))+"=VALUES("+e+")"},this).join(", "),this.insertQuery(e,t,i,o)},deleteQuery:function(e,t,r){r=r||{};var n=this.quoteTable(e);if(!0===r.truncate)return"TRUNCATE "+n;t=this.getWhereConditions(t);var o="";i._.isUndefined(r.limit)&&(r.limit=1),r.limit&&(o=" LIMIT "+this.escape(r.limit));var s="DELETE FROM "+n;return t&&(s+=" WHERE "+t),s+=o},showIndexesQuery:function(e,t){return i._.template("SHOW INDEX FROM <%= tableName %><%= options %>")({tableName:this.quoteTable(e),options:(t||{}).database?" FROM `"+t.database+"`":""})},removeIndexQuery:function(e,t){var r=t;return"string"!=typeof r&&(r=i.inflection.underscore(e+"_"+t.join("_"))),i._.template("DROP INDEX <%= indexName %> ON <%= tableName %>")({tableName:this.quoteIdentifiers(e),indexName:r})},attributeToSQL:function(e,t){i._.isPlainObject(e)||(e={type:e});var r=e.type.toString({escape:this.escape.bind(this)});if(!1===e.allowNull&&(r+=" NOT NULL"),e.autoIncrement&&(r+=" auto_increment"),"TEXT"!==e.type&&!0!==e.type._binary&&i.defaultValueSchemable(e.defaultValue)&&(r+=" DEFAULT "+this.escape(e.defaultValue)),!0===e.unique&&(r+=" UNIQUE"),e.primaryKey&&(r+=" PRIMARY KEY"),e.after&&(r+=" AFTER "+this.quoteIdentifier(e.after)),e.references){if(e=i.formatReferences(e),t&&"addColumn"===t.context&&t.foreignKey){var n=t.foreignKey;r+=i._.template(", ADD CONSTRAINT <%= fkName %> FOREIGN KEY (<%= attrName %>)")({fkName:this.quoteIdentifier(n+"_foreign_idx"),attrName:this.quoteIdentifier(n)})}r+=" REFERENCES "+this.quoteTable(e.references.model),e.references.key?r+=" ("+this.quoteIdentifier(e.references.key)+")":r+=" ("+this.quoteIdentifier("id")+")",e.onDelete&&(r+=" ON DELETE "+e.onDelete.toUpperCase()),e.onUpdate&&(r+=" ON UPDATE "+e.onUpdate.toUpperCase())}return r},attributesToSQL:function(e,t){var r,n,i={};for(r in e)n=e[r],i[n.field||r]=this.attributeToSQL(n,t);return i},findAutoIncrementField:function(e){var t=[];for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)){var n=e.attributes[r];n&&n.autoIncrement&&t.push(r)}return t},quoteIdentifier:function(e){return"*"===e?e:i.addTicks(e,"`")},getForeignKeysQuery:function(e,t){return"SELECT CONSTRAINT_NAME as constraint_name FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE where TABLE_NAME = '"+e+"' AND CONSTRAINT_NAME!='PRIMARY' AND CONSTRAINT_SCHEMA='"+t+"' AND REFERENCED_TABLE_NAME IS NOT NULL;"},getForeignKeyQuery:function(e,t){var r=e.tableName||e;return e.schema&&(r=e.schema+"."+r),["SELECT CONSTRAINT_NAME as constraint_name","FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE","WHERE (REFERENCED_TABLE_NAME = "+n(r),"AND REFERENCED_COLUMN_NAME = "+n(t),") OR (TABLE_NAME = "+n(r),"AND COLUMN_NAME = "+n(t),")"].join(" ")},dropForeignKeyQuery:function(e,t){return"ALTER TABLE "+this.quoteTable(e)+" DROP FOREIGN KEY "+this.quoteIdentifier(t)+";"}};e.exports=i._.extend(i._.clone(r(28)),o)},function(e,t,r){"use strict";var n=r(3),i=r(5),o={beforeValidate:{params:2},afterValidate:{params:2},validationFailed:{params:3},beforeCreate:{params:2},afterCreate:{params:2},beforeDestroy:{params:2},afterDestroy:{params:2},beforeRestore:{params:2},afterRestore:{params:2},beforeUpdate:{params:2},afterUpdate:{params:2},beforeBulkCreate:{params:2},afterBulkCreate:{params:2},beforeBulkDestroy:{params:1},afterBulkDestroy:{params:1},beforeBulkRestore:{params:1},afterBulkRestore:{params:1},beforeBulkUpdate:{params:1},afterBulkUpdate:{params:1},beforeFind:{params:1},beforeFindAfterExpandIncludeAll:{params:1},beforeFindAfterOptions:{params:1},afterFind:{params:2},beforeCount:{params:1},beforeDefine:{params:2,sync:!0},afterDefine:{params:1,sync:!0},beforeInit:{params:2,sync:!0},afterInit:{params:1,sync:!0},beforeConnect:{params:1},afterConnect:{params:2},beforeSync:{params:1},afterSync:{params:1},beforeBulkSync:{params:1},afterBulkSync:{params:1}},s={beforeDelete:"beforeDestroy",afterDelete:"afterDestroy",beforeBulkDelete:"beforeBulkDestroy",afterBulkDelete:"afterBulkDestroy",beforeConnection:"beforeConnect"},a={replaceHookAliases:function(e){var t;return n._.each(e,function(r,n){(t=s[n])&&(e[t]=(e[t]||[]).concat(r),delete e[n])}),e},runHooks:function(e){var t,r,s=this,a=n.sliceArgs(arguments,1);if("function"==typeof a[a.length-1]&&(t=a.pop()),"string"==typeof e&&(r=e,e=this.options.hooks[r]||[],Array.isArray(e)||(e=void 0===e?[]:[e]),this.sequelize&&(e=e.concat(this.sequelize.options.hooks[r]||[]))),Array.isArray(e)||(e=void 0===e?[]:[e]),o[r]&&o[r].sync)return void e.forEach(function(e){return"object"==typeof e&&(e=e.fn),e.apply(s,a)});var u=i.each(e,function(e){return"object"==typeof e&&(e=e.fn),r&&e.length>o[r].params&&(e=i.promisify(e,s)),e.apply(s,a)}).return();return t?u.nodeify(t):u},hook:function(){return a.addHook.apply(this,arguments)},addHook:function(e,t,r){return"function"==typeof t&&(r=t,t=null),e=s[e]||e,this.options.hooks[e]=this.options.hooks[e]||[],this.options.hooks[e].push(t?{name:t,fn:r}:r),this},removeHook:function(e,t){return e=s[e]||e,this.hasHook(e)?(this.options.hooks[e]=this.options.hooks[e].filter(function(e){return"function"==typeof e||"object"==typeof e&&e.name!==t}),this):this},hasHook:function(e){return this.options.hooks[e]&&!!this.options.hooks[e].length}};a.hasHooks=a.hasHook,e.exports={hooks:o,hookAliases:s,applyTo:function(e){n._.mixin(e,a),n._.mixin(e.prototype,a),Object.keys(o).concat(Object.keys(s)).forEach(function(t){e.prototype[t]=function(e,r){return this.addHook(t,e,r)}})}}},function(e,t,r){"use strict";var n=r(3),i=r(19),o=r(25),s=r(114),a=r(14),u=r(6),l=r(41),c=r(5),p=r(0),h={raw:!0},d=function(e,t){var r,i;if(e=e&&p.clone(e)||{},t.isNewRecord&&(r={},this.Model._hasDefaultValues&&(r=p.mapValues(this.Model._defaultValues,function(e){var t=e();return t&&t._isSequelizeMethod?t:p.cloneDeep(t)})),r.hasOwnProperty(this.Model.primaryKeyAttribute)||(r[this.Model.primaryKeyAttribute]=null),this.Model._timestampAttributes.createdAt&&r[this.Model._timestampAttributes.createdAt]&&(this.dataValues[this.Model._timestampAttributes.createdAt]=n.toDefaultValue(r[this.Model._timestampAttributes.createdAt]),delete r[this.Model._timestampAttributes.createdAt]),this.Model._timestampAttributes.updatedAt&&r[this.Model._timestampAttributes.updatedAt]&&(this.dataValues[this.Model._timestampAttributes.updatedAt]=n.toDefaultValue(r[this.Model._timestampAttributes.updatedAt]),delete r[this.Model._timestampAttributes.updatedAt]),this.Model._timestampAttributes.deletedAt&&r[this.Model._timestampAttributes.deletedAt]&&(this.dataValues[this.Model._timestampAttributes.deletedAt]=n.toDefaultValue(r[this.Model._timestampAttributes.deletedAt]),delete r[this.Model._timestampAttributes.deletedAt]),Object.keys(r).length))for(i in r)void 0===e[i]&&(this.set(i,n.toDefaultValue(r[i]),h),delete e[i]);this.set(e,t)},f=function(e,t){this.dataValues={},this._previousDataValues={},this._changed={},this.$modelOptions=this.Model.options,this.$options=t||{},this.hasPrimaryKeys=this.Model.options.hasPrimaryKeys,this.__eagerlyLoadedAssociations=[],this.isNewRecord=t.isNewRecord,d.call(this,e,t)};Object.defineProperty(f.prototype,"sequelize",{get:function(){return this.Model.modelManager.sequelize}}),f.prototype.where=function(){var e;return e=this.Model.primaryKeyAttributes.reduce(function(e,t){return e[t]=this.get(t,{raw:!0}),e}.bind(this),{}),0===p.size(e)?this.$modelOptions.whereCollection:n.mapWhereFieldNames(e,this.$Model)},f.prototype.toString=function(){return"[object SequelizeInstance:"+this.Model.name+"]"},f.prototype.getDataValue=function(e){return this.dataValues[e]},f.prototype.setDataValue=function(e,t){var r=this._previousDataValues[e];n.isPrimitive(t)&&t===r||this.changed(e,!0),this.dataValues[e]=t},f.prototype.get=function(e,t){if(void 0===t&&"object"==typeof e&&(t=e,e=void 0),e)return this._customGetters[e]?this._customGetters[e].call(this,e):t&&t.plain&&this.$options.include&&-1!==this.$options.includeNames.indexOf(e)?Array.isArray(this.dataValues[e])?this.dataValues[e].map(function(e){return e.get({plain:t.plain})}):this.dataValues[e]instanceof f?this.dataValues[e].get({plain:t.plain}):this.dataValues[e]:this.dataValues[e];if(this._hasCustomGetters||t&&t.plain&&this.$options.include||t&&t.clone){var r,n={};if(this._hasCustomGetters)for(r in this._customGetters)this._customGetters.hasOwnProperty(r)&&(n[r]=this.get(r,t));for(r in this.dataValues)!n.hasOwnProperty(r)&&this.dataValues.hasOwnProperty(r)&&(n[r]=this.get(r,t));return n}return this.dataValues},f.prototype.set=function(e,t,r){var i,o,s,a,u;if("object"==typeof e&&null!==e)if(i=e,r=t||{},r.reset&&(this.dataValues={}),!r.raw||this.$options&&this.$options.include||r&&r.attributes||this.Model._hasBooleanAttributes||this.Model._hasDateAttributes){if(r.attributes)for(s=r.attributes,this.Model._hasVirtualAttributes&&(s=s.concat(this.Model._virtualAttributes)),this.$options.includeNames&&(s=s.concat(this.$options.includeNames)),a=0,u=s.length;a<u;a++)void 0!==i[s[a]]&&this.set(s[a],i[s[a]],r);else for(e in i)this.set(e,i[e],r);r.raw&&(this._previousDataValues=p.clone(this.dataValues))}else Object.keys(this.dataValues).length?this.dataValues=p.extend(this.dataValues,i):this.dataValues=i,this._previousDataValues=p.clone(this.dataValues);else if(r||(r={}),r.raw||(o=this.dataValues[e]),!r.raw&&this._customSetters[e])this._customSetters[e].call(this,t,e),(!n.isPrimitive(t)&&null!==t||t!==o)&&(this._previousDataValues[e]=o,this.changed(e,!0));else{if(this.$options&&this.$options.include&&-1!==this.$options.includeNames.indexOf(e))return this._setInclude(e,t,r),this;if(!r.raw){if(!this._isAttribute(e)){if(e.indexOf(".")>-1&&this.Model._isJsonAttribute(e.split(".")[0])){var c=l.get(this.dataValues,e);p.isEqual(c,t)||(l.set(this.dataValues,e,t),this.changed(e.split(".")[0],!0))}return this}if(this.Model._hasPrimaryKeys&&o&&this.Model._isPrimaryKey(e))return this;if(!this.isNewRecord&&this.Model._hasReadOnlyAttributes&&this.Model._isReadOnlyAttribute(e))return this;if(this.Model._hasDateAttributes&&this.Model._isDateAttribute(e)&&t&&!t._isSequelizeMethod&&(t instanceof Date||(t=new Date(t)),o&&(o instanceof Date||(o=new Date(o)),t.getTime()===o.getTime())))return this}this.Model._hasBooleanAttributes&&this.Model._isBooleanAttribute(e)&&null!==t&&void 0!==t&&!t._isSequelizeMethod&&(Buffer.isBuffer(t)&&1===t.length&&(t=t[0]),p.isString(t)?t="true"===t||"false"!==t&&t:p.isNumber(t)&&(t=1===t||0!==t&&t)),r.raw||(n.isPrimitive(t)||null===t)&&t===o||(this._previousDataValues[e]=o,this.changed(e,!0)),this.dataValues[e]=t}return this},f.prototype.setAttributes=function(e){return this.set(e)},f.prototype.changed=function(e,t){if(e)return void 0!==t?(this._changed[e]=t,this):this._changed[e]||!1;var r=Object.keys(this.dataValues).filter(function(e){return this.changed(e)}.bind(this));return!!r.length&&r},f.prototype.previous=function(e){return e?this._previousDataValues[e]:p.pickBy(this._previousDataValues,function(e,t){return this.changed(t)}.bind(this))},f.prototype._setInclude=function(e,t,r){Array.isArray(t)||(t=[t]),t[0]instanceof f&&(t=t.map(function(e){return e.dataValues}));var n,i,o=this.$options.includeMap[e],s=o.association,a=this,u=e,l=o.model.primaryKeyAttribute;i||(n={isNewRecord:this.isNewRecord,include:o.include,includeNames:o.includeNames,includeMap:o.includeMap,includeValidated:!0,raw:r.raw,attributes:o.originalAttributes}),(void 0===o.originalAttributes||o.originalAttributes.length)&&(s.isSingleAssociation?(Array.isArray(t)&&(t=t[0]),i=t&&null===t[l]||null===t,a[u]=a.dataValues[u]=i?null:o.model.build(t,n)):(i=t[0]&&null===t[0][l],a[u]=a.dataValues[u]=i?[]:o.model.bulkBuild(t,n)))},f.prototype.save=function(e){if(arguments.length>1)throw new Error("The second argument was removed in favor of the options object.");e=n.cloneDeep(e),e=p.defaults(e,{hooks:!0,validate:!0}),e.fields||(this.isNewRecord?e.fields=Object.keys(this.Model.attributes):e.fields=p.intersection(this.changed(),Object.keys(this.Model.attributes)),e.defaultFields=e.fields),void 0===e.returning&&(e.association?e.returning=!1:this.isNewRecord&&(e.returning=!0));var t=this,r=this.Model.primaryKeyAttribute,s=r&&this.Model.rawAttributes[r],a=this.Model._timestampAttributes.updatedAt,u=this.Model._timestampAttributes.createdAt,l=t.isNewRecord?"Create":"Update",h=this.isNewRecord,d=n.now(this.sequelize.options.dialect);if(a&&e.fields.length>=1&&-1===e.fields.indexOf(a)&&e.fields.push(a),!0!==e.silent||this.isNewRecord&&this.get(a,{raw:!0})||(n._.remove(e.fields,function(e){return e===a}),a=!1),!0===this.isNewRecord&&(u&&-1===e.fields.indexOf(u)&&e.fields.push(u),s&&s.defaultValue&&e.fields.indexOf(r)<0&&e.fields.unshift(r)),!1===this.isNewRecord&&r&&void 0===this.get(r,{raw:!0}))throw new Error("You attempted to save an instance with no primary key, this is not allowed since it would result in a global update");return a&&!e.silent&&-1!==e.fields.indexOf(a)&&(this.dataValues[a]=this.Model.$getDefaultTimestamp(a)||d),this.isNewRecord&&u&&!this.dataValues[u]&&(this.dataValues[u]=this.Model.$getDefaultTimestamp(u)||d),c.bind(this).then(function(){if(e.validate)return c.bind(this).then(function(){return e.hooks?this.hookValidate(e):this.validate(e).then(function(e){if(e)throw e})})}).then(function(){return c.bind(this).then(function(){if(e.hooks){var t,r,n=p.pick(this.dataValues,e.fields),i=p.difference(this.changed(),e.fields);return a&&-1!==e.fields.indexOf(a)&&(i=p.without(i,a)),this.Model.runHooks("before"+l,this,e).bind(this).then(function(){if(e.defaultFields&&!this.isNewRecord&&(t=p.pick(this.dataValues,p.difference(this.changed(),i)),r=[],Object.keys(t).forEach(function(e){t[e]!==n[e]&&r.push(e)}),e.fields=p.uniq(e.fields.concat(r))),r&&e.validate)return e.skip=p.difference(Object.keys(this.Model.rawAttributes),r),c.bind(this).then(function(){return e.hooks?this.hookValidate(e):this.validate(e).then(function(e){if(e)throw e})}).then(function(){delete e.skip})})}}).then(function(){return e.fields.length&&this.isNewRecord&&this.$options.include&&this.$options.include.length?c.map(this.$options.include.filter(function(e){return e.association instanceof i}),function(r){var i=t.get(r.as);if(!i)return c.resolve();var o=p(n.cloneDeep(r)).omit(["association"]).defaults({transaction:e.transaction,logging:e.logging,parentRecord:t}).value();return i.save(o).then(function(){return t[r.association.accessors.set](i,{save:!1,logging:e.logging})})}):this}).then(function(){var r=[];if(e.fields.forEach(function(e){t.Model._isVirtualAttribute(e)||r.push(e)}),!r.length)return this;if(!this.changed()&&!this.isNewRecord)return this;var s=n.mapValueFieldNames(this.dataValues,e.fields,this.Model),a=null,u=[];if(t.isNewRecord)a="insert",u=[t,t.$Model.getTableName(e),s,e];else{var d=this.where();d=n.mapValueFieldNames(d,Object.keys(d),this.Model),a="update",u=[t,t.$Model.getTableName(e),s,d,e]}return t.sequelize.getQueryInterface()[a].apply(t.sequelize.getQueryInterface(),u).then(function(e){return Object.keys(t.Model.rawAttributes).forEach(function(e){t.Model.rawAttributes[e].field&&void 0!==s[t.Model.rawAttributes[e].field]&&t.Model.rawAttributes[e].field!==e&&(s[e]=s[t.Model.rawAttributes[e].field],delete s[t.Model.rawAttributes[e].field])}),s=p.extend(s,e.dataValues),e.dataValues=p.extend(e.dataValues,s),e}).tap(function(r){if(e.hooks)return t.Model.runHooks("after"+l,r,e)}).then(function(r){return e.fields.forEach(function(e){r._previousDataValues[e]=r.dataValues[e],t.changed(e,!1)}),t.isNewRecord=!1,r}).tap(function(){return h&&t.$options.include&&t.$options.include.length?c.map(t.$options.include.filter(function(e){return!(e.association instanceof i)}),function(r){var i=t.get(r.as);if(!i)return c.resolve();if(Array.isArray(i)||(i=[i]),!i.length)return c.resolve();var s=p(n.cloneDeep(r)).omit(["association"]).defaults({transaction:e.transaction,logging:e.logging,parentRecord:t}).value();return c.map(i,function(e){return r.association instanceof o?e.save(s).then(function(){var n={};return n[r.association.foreignKey]=t.get(t.Model.primaryKeyAttribute,{raw:!0}),n[r.association.otherKey]=e.get(e.Model.primaryKeyAttribute,{raw:!0}),p.assign(n,r.association.through.scope),r.association.throughModel.create(n,s)}):(e.set(r.association.foreignKey,t.get(t.Model.primaryKeyAttribute,{raw:!0})),e.save(s))})}):t})})})},f.prototype.reload=function(e){return e=p.defaults({},e,{where:this.where(),include:this.$options.include||null}),this.Model.findOne(e).bind(this).tap(function(e){if(!e)throw new u.InstanceError("Instance could not be reloaded because it does not exist anymore (find call returned null)")}).then(function(t){this.$options=t.$options,this.set(t.dataValues,{raw:!0,reset:!e.attributes})}).return(this)},f.prototype.validate=function(e){return new s(this,e).validate()},f.prototype.hookValidate=function(e){return new s(this,e).hookValidate()},f.prototype.update=function(e,t){var r,i,o,s=this.changed()||[];return t=t||{},Array.isArray(t)&&(t={fields:t}),t=n.cloneDeep(t),o=n.cloneDeep(t),o.attributes=t.fields,this.set(e,o),r=p.without.apply(this,[this.changed()||[]].concat(s)),i=p.union(Object.keys(e),r),t.fields||(t.fields=p.intersection(i,this.changed()),t.defaultFields=t.fields),this.save(t)},f.prototype.updateAttributes=f.prototype.update,f.prototype.destroy=function(e){return e=n._.extend({hooks:!0,force:!1},e),c.bind(this).then(function(){if(e.hooks)return this.Model.runHooks("beforeDestroy",this,e)}).then(function(){var t=this.where();if(this.Model._timestampAttributes.deletedAt&&!1===e.force){var r=this.Model.rawAttributes[this.Model._timestampAttributes.deletedAt],n=r.field||this.Model._timestampAttributes.deletedAt,i={};return i[n]=new Date,t[n]=r.hasOwnProperty("defaultValue")?r.defaultValue:null,this.setDataValue(n,i[n]),this.sequelize.getQueryInterface().update(this,this.$Model.getTableName(e),i,t,p.defaults({hooks:!1},e))}return this.sequelize.getQueryInterface().delete(this,this.$Model.getTableName(e),t,p.assign({type:a.DELETE,limit:null},e))}).tap(function(){if(e.hooks)return this.Model.runHooks("afterDestroy",this,e)}).then(function(e){return e})},f.prototype.restore=function(e){if(!this.Model._timestampAttributes.deletedAt)throw new Error("Model is not paranoid");return e=n._.extend({hooks:!0,force:!1},e),c.bind(this).then(function(){if(e.hooks)return this.Model.runHooks("beforeRestore",this,e)}).then(function(){var t=this.Model._timestampAttributes.deletedAt,r=this.Model.rawAttributes[t],n=r.hasOwnProperty("defaultValue")?r.defaultValue:null;return this.setDataValue(t,n),this.save(p.extend({},e,{hooks:!1,omitNull:!1}))}).tap(function(){if(e.hooks)return this.Model.runHooks("afterRestore",this,e)})},f.prototype.increment=function(e,t){var r,i=this.where(),o=this.Model._timestampAttributes.updatedAt,s={};return t=p.defaults({},t,{by:1,attributes:{},where:{}}),r=p.extend({},t.where,i),n._.isString(e)?s[e]=t.by:n._.isArray(e)?n._.each(e,function(e){s[e]=t.by}):s=e,t.silent||!o||s[o]||(t.attributes[o]=this.Model.$getDefaultTimestamp(o)||n.now(this.sequelize.options.dialect)),Object.keys(s).forEach(function(e){this.Model.rawAttributes[e]&&this.Model.rawAttributes[e].field&&this.Model.rawAttributes[e].field!==e&&(s[this.Model.rawAttributes[e].field]=s[e],delete s[e])},this),this.sequelize.getQueryInterface().increment(this,this.$Model.getTableName(t),s,r,t).return(this)},f.prototype.decrement=function(e,t){return t=p.defaults({},t,{by:1}),n._.isString(e)||n._.isArray(e)||n._.each(e,function(t,r){e[r]=-t}),t.by=0-t.by,this.increment(e,t)},f.prototype.equals=function(e){var t=!0;return!(!e||!e.dataValues)&&(n._.each(this.dataValues,function(r,i){t=n._.isDate(r)&&n._.isDate(e.dataValues[i])?t&&r.getTime()===e.dataValues[i].getTime():t&&r===e.dataValues[i]}),t)},f.prototype.equalsOneOf=function(e){var t=this;return p.some(e,function(e){return t.equals(e)})},f.prototype.setValidators=function(e,t){this.validators[e]=t},f.prototype.toJSON=function(){return this.get({plain:!0})},e.exports=f,e.exports.Instance=f,e.exports.default=f},function(e,t,r){"use strict";function n(e,t){if(t&&t.$expandAttributes(e),e.include){if(Array.isArray(e.include)){if(!e.include.length)return void delete e.include}else e.include=[e.include];e.include=e.include.map(function(e){return e=i(e,t)})}}function i(e,t){var r;if(e._pseudo)return e;if(e instanceof a)r=t&&e.target.name===t.name?e.source:e.target,e={model:r,association:e,as:e.as};else if(e instanceof g)e={model:e};else{if(!m.isPlainObject(e))throw new Error("Include unexpected. Element has to be either a Model, an Association or an object.");e.association?(r=t&&e.association.target.name===t.name?e.association.source:e.association.target,e.model||(e.model=r),e.as||(e.as=e.association.as)):r=e.model,n(e,r)}return e}var o=r(3),s=r(49),a=r(18),u=r(20),l=r(4),c=r(8),p=r(5),h=r(14),d=r(48),f=r(6),m=r(0),y=r(84),g=function(e,t,r){this.options=o._.extend({timestamps:!0,instanceMethods:{},classMethods:{},validate:{},freezeTableName:!1,underscored:!1,underscoredAll:!1,paranoid:!1,rejectOnEmpty:!1,whereCollection:null,schema:null,schemaDelimiter:"",defaultScope:{},scopes:[],hooks:{},indexes:[]},r||{}),this.associations={},this.modelManager=null,this.name=e,this.options.hooks=m.mapValues(this.replaceHookAliases(this.options.hooks),function(e){return Array.isArray(e)||(e=[e]),e}),this.sequelize=r.sequelize,this.underscored=this.underscored||this.underscoredAll,this.options.tableName?this.tableName=this.options.tableName:this.tableName=this.options.freezeTableName?e:o.underscoredIf(o.pluralize(e),this.options.underscoredAll),this.$schema=this.options.schema,this.$schemaDelimiter=this.options.schemaDelimiter,m.each(r.validate,function(r,n){if(m.includes(o._.keys(t),n))throw new Error("A model validator function must not have the same name as a field. Model: "+e+", field/validation name: "+n);if(!m.isFunction(r))throw new Error("Members of the validate option must be functions. Model: "+e+", error with validate member "+n)}),this.attributes=this.rawAttributes=m.mapValues(t,function(e,t){if(o._.isPlainObject(e)||(e={type:e}),e=this.sequelize.normalizeAttribute(e),e.references&&(e=o.formatReferences(e),e.references.model instanceof g&&(e.references.model=e.references.model.tableName)),void 0===e.type)throw new Error("Unrecognized data type for field "+t);return e}.bind(this))};Object.defineProperty(g.prototype,"QueryInterface",{get:function(){return this.modelManager.sequelize.getQueryInterface()}}),Object.defineProperty(g.prototype,"QueryGenerator",{get:function(){return this.QueryInterface.QueryGenerator}}),g.prototype.toString=function(){return"[object SequelizeModel:"+this.name+"]"};var E=function(e,t){if(t=t||{},t.include&&t.include.forEach(function(e){E(e.model,e)}),m.get(t,"groupedLimit.on.options.paranoid")){var r=m.get(t,"groupedLimit.on.through.model");r&&(t.groupedLimit.through=E(r,t.groupedLimit.through))}if(!e.options.timestamps||!e.options.paranoid||!1===t.paranoid)return t;var n=e._timestampAttributes.deletedAt,i=e.rawAttributes[n],s={},a=i.hasOwnProperty("defaultValue")?i.defaultValue:null;return s[i.field||n]=a,o._.isEmpty(t.where)?t.where=s:t.where={$and:[s,t.where]},t},v=function(){var e=this;o._.each(this.options.classMethods||{},function(t,r){e[r]=t})},b=function(){var e=this,t={},r={};if(!m.some(this.rawAttributes,"primaryKey")){if("id"in this.rawAttributes)throw new Error("A column called 'id' was added to the attributes of '"+this.tableName+"' but not marked with 'primaryKey: true'");r={id:{type:new l.INTEGER,allowNull:!1,primaryKey:!0,autoIncrement:!0,_autoGenerated:!0}}}this._timestampAttributes.createdAt&&(t[this._timestampAttributes.createdAt]={type:l.DATE,allowNull:!1,_autoGenerated:!0}),this._timestampAttributes.updatedAt&&(t[this._timestampAttributes.updatedAt]={type:l.DATE,allowNull:!1,_autoGenerated:!0}),this._timestampAttributes.deletedAt&&(t[this._timestampAttributes.deletedAt]={type:l.DATE,_autoGenerated:!0});var n=o._.clone(e.rawAttributes);e.rawAttributes={},o._.each(r,function(t,r){e.rawAttributes[r]=t}),o._.each(n,function(t,r){e.rawAttributes[r]=t}),o._.each(t,function(t,r){o._.isUndefined(e.rawAttributes[r])&&(e.rawAttributes[r]=t)}),Object.keys(this.primaryKeys).length||(e.primaryKeys.id=e.rawAttributes.id)},A=function(){var e=this.QueryGenerator.findAutoIncrementField(this);this.autoIncrementField=null,e.forEach(function(e){if(this.autoIncrementField)throw new Error("Invalid Instance definition. Only one autoincrement field allowed.");this.autoIncrementField=e}.bind(this))};g.$conformOptions=n,g.$conformInclude=i;var T,N=function(e,t){var r=t.all;if(delete t.all,!0!==r){Array.isArray(r)||(r=[r]);for(var n={BelongsTo:!0,HasOne:!0,HasMany:!0,One:["BelongsTo","HasOne"],Has:["HasOne","HasMany"],Many:["HasMany"]},i=0;i<r.length;i++){var s=r[i];if("All"===s){r=!0;break}var a=n[s];if(!a)throw new Error("include all '"+s+"' is not valid - must be BelongsTo, HasOne, HasMany, One, Has, Many or All");if(!0!==a){r.splice(i,1),i--;for(var u=0;u<a.length;u++)-1===r.indexOf(a[u])&&(r.unshift(a[u]),i++)}}}var l=t.nested;l&&(delete t.nested,t.include?Array.isArray(t.include)||(t.include=[t.include]):t.include=[]);var c=[];!function e(n,i){o._.forEach(n.associations,function(s){if(!0===r||-1!==r.indexOf(s.associationType)){var a=s.target,u=s.options.as,p={model:a};if(u&&(p.as=u),!(o._.find(i,p)||l&&-1!==c.indexOf(a))){c.push(n);var h=o.cloneDeep(t);h.model=a,u&&(h.as=u),i.push(h),l&&(e(a,h.include),0===h.include.length&&delete h.include)}}}),c.pop()}(this,e)},I=function(e,t){return e.model||(e.model=this),t=t||{},e.includeNames=[],e.includeMap={},e.hasSingleAssociation=!1,e.hasMultiAssociation=!1,e.parent||(e.topModel=e.model,e.topLimit=e.limit),e.include=e.include.map(function(r){return r=i(r),r.parent=e,T.call(e.model,r,t,e),void 0===r.duplicating&&(r.duplicating=r.association.isMultiAssociation),r.hasDuplicating=r.hasDuplicating||r.duplicating,r.hasRequired=r.hasRequired||r.required,e.hasDuplicating=e.hasDuplicating||r.hasDuplicating,e.hasRequired=e.hasRequired||r.required,e.hasWhere=e.hasWhere||r.hasWhere||!!r.where,r}),e.include.forEach(function(t){return t.hasParentWhere=e.hasParentWhere||!!e.where,t.hasParentRequired=e.hasParentRequired||!!e.required,!1!==t.subQuery&&e.hasDuplicating&&e.topLimit?t.duplicating?(t.subQuery=!1,t.subQueryFilter=t.hasRequired):(t.subQuery=t.hasRequired,t.subQueryFilter=!1):(t.subQuery=t.subQuery||!1,t.duplicating?(t.subQueryFilter=t.subQuery,t.subQuery=!1):(t.subQueryFilter=!1,t.subQuery=t.subQuery||t.hasParentRequired&&t.hasRequired)),e.includeMap[t.as]=t,e.includeNames.push(t.as),e.topModel===e.model&&void 0===e.subQuery&&e.topLimit&&(t.subQuery?e.subQuery=t.subQuery:t.hasDuplicating&&(e.subQuery=!0)),e.hasIncludeWhere=e.hasIncludeWhere||t.hasIncludeWhere||!!t.where,e.hasIncludeRequired=e.hasIncludeRequired||t.hasIncludeRequired||!!t.required,(t.association.isMultiAssociation||t.hasMultiAssociation)&&(e.hasMultiAssociation=!0),(t.association.isSingleAssociation||t.hasSingleAssociation)&&(e.hasSingleAssociation=!0),t}),e.topModel===e.model&&void 0===e.subQuery&&(e.subQuery=!1),e};g.$validateIncludedElements=I,T=function(e,t,r){if(t[e.model.getTableName()]=!0,e.attributes&&!r.raw?(e.model.$expandAttributes(e),e=o.mapFinderOptions(e,e.model),e.originalAttributes=e.attributes.slice(0),e.attributes.length&&m.each(e.model.primaryKeys,function(t,r){m.some(e.attributes,function(e){return t.field!==r?Array.isArray(e)&&e[0]===t.field&&e[1]===r:e===r})||e.attributes.unshift(r)})):e=o.mapFinderOptions(e,e.model),e._pseudo)return e.attributes=Object.keys(e.model.tableAttributes),o.mapFinderOptions(e,e.model);var n=e.association||this.getAssociation(e.model,e.as);if(!n){var i=e.model.name;throw e.as&&(i+=" ("+e.as+")"),i+=" is not associated to "+this.name+"!",new Error(i)}if(e.association=n,e.as=n.as,e.association.through&&Object(e.association.through.model)===e.association.through.model){e.include||(e.include=[]);var s=e.association.through;e.through=o._.defaults(e.through||{},{model:s.model,as:s.model.name,association:{isSingleAssociation:!0},_pseudo:!0,parent:e}),s.scope&&(e.through.where=e.through.where?{$and:[e.through.where,s.scope]}:s.scope),e.include.push(e.through),t[s.tableName]=!0}var a;if(a=!0===e.model.scoped?e.model:e.association.target.name===e.model.name?e.association.target:e.association.source,a.$injectScope(e),e.attributes||(e.attributes=Object.keys(e.model.tableAttributes)),e=o.mapFinderOptions(e,e.model),void 0===e.required&&(e.required=!!e.where),e.association.scope&&(e.where=e.where?{$and:[e.where,e.association.scope]}:e.association.scope),e.limit&&void 0===e.separate&&(e.separate=!0),!0===e.separate&&!(e.association instanceof u))throw new Error("Only HasMany associations support include.separate");return!0===e.separate&&(e.duplicating=!1),!0===e.separate&&r.attributes&&r.attributes.length&&!m.includes(r.attributes,n.source.primaryKeyAttribute)&&r.attributes.push(n.source.primaryKeyAttribute),e.hasOwnProperty("include")&&I.call(e.model,e,t,r),e};var w=g.$expandIncludeAll=function(e){var t=e.include;if(t){for(var r=0;r<t.length;r++){var n=t[r];n.all&&(t.splice(r,1),r--,N.call(this,t,n))}o._.forEach(t,function(e){w.call(e.model,e)})}};g.prototype.init=function(e){var t=this;return this.modelManager=e,this.primaryKeys={},this._timestampAttributes={},this.options.timestamps&&(!1!==this.options.createdAt&&(this._timestampAttributes.createdAt=this.options.createdAt||o.underscoredIf("createdAt",this.options.underscored)),!1!==this.options.updatedAt&&(this._timestampAttributes.updatedAt=this.options.updatedAt||o.underscoredIf("updatedAt",this.options.underscored)),this.options.paranoid&&!1!==this.options.deletedAt&&(this._timestampAttributes.deletedAt=this.options.deletedAt||o.underscoredIf("deletedAt",this.options.underscored))),v.call(this),this.Instance=function(){s.apply(this,arguments)},c.inherits(this.Instance,s),this._readOnlyAttributes=o._.values(this._timestampAttributes),this._hasReadOnlyAttributes=this._readOnlyAttributes&&this._readOnlyAttributes.length,this._isReadOnlyAttribute=o._.memoize(function(e){return t._hasReadOnlyAttributes&&-1!==t._readOnlyAttributes.indexOf(e)}),this.options.instanceMethods&&o._.each(this.options.instanceMethods,function(e,r){t.Instance.prototype[r]=e}),b.call(this),this.refreshAttributes(),A.call(this),this.$scope=this.options.defaultScope,m.isPlainObject(this.$scope)&&n(this.$scope,this),m.each(this.options.scopes,function(e){m.isPlainObject(e)&&n(e,this)}.bind(this)),this.options.indexes=this.options.indexes.map(this.$conformIndex),this.Instance.prototype.$Model=this.Instance.prototype.Model=this,this},g.prototype.$conformIndex=function(e){return e=m.defaults(e,{type:"",parser:null}),e.type&&"unique"===e.type.toLowerCase()&&(e.unique=!0,delete e.type),e},g.prototype.refreshAttributes=function(){var e=this,t={};this.Instance.prototype._customGetters={},this.Instance.prototype._customSetters={},o._.each(["get","set"],function(r){var n=r+"terMethods",i=o._.clone(o._.isObject(e.options[n])?e.options[n]:{}),s="get"===r?e.Instance.prototype._customGetters:e.Instance.prototype._customSetters;o._.each(i,function(e,t){s[t]=e,"get"===r&&(i[t]=function(){return this.get(t)}),"set"===r&&(i[t]=function(e){return this.set(t,e)})}),o._.each(e.rawAttributes,function(e,t){e.hasOwnProperty(r)&&(s[t]=e[r]),"get"===r&&(i[t]=function(){return this.get(t)}),"set"===r&&(i[t]=function(e){return this.set(t,e)})}),o._.each(i,function(e,n){t[n]||(t[n]={configurable:!0}),t[n][r]=e})}),this._booleanAttributes=[],this._dateAttributes=[],this._hstoreAttributes=[],this._rangeAttributes=[],this._jsonAttributes=[],this._geometryAttributes=[],this._virtualAttributes=[],this._defaultValues={},this.Instance.prototype.validators={},this.fieldRawAttributesMap={},this.primaryKeys={},e.options.uniqueKeys={},m.each(this.rawAttributes,function(t,r){if(t.type=e.sequelize.normalizeDataType(t.type),t.Model=e,t.fieldName=r,t._modelAttribute=!0,void 0===t.field&&(t.field=r),!0===t.primaryKey&&(e.primaryKeys[r]=t),e.fieldRawAttributesMap[t.field]=t,t.type instanceof l.BOOLEAN?e._booleanAttributes.push(r):t.type instanceof l.DATE?e._dateAttributes.push(r):t.type instanceof l.HSTORE||l.ARRAY.is(t.type,l.HSTORE)?e._hstoreAttributes.push(r):t.type instanceof l.RANGE||l.ARRAY.is(t.type,l.RANGE)?e._rangeAttributes.push(r):t.type instanceof l.JSON?e._jsonAttributes.push(r):t.type instanceof l.VIRTUAL?e._virtualAttributes.push(r):t.type instanceof l.GEOMETRY&&e._geometryAttributes.push(r),t.hasOwnProperty("defaultValue")&&(e._defaultValues[r]=o._.partial(o.toDefaultValue,t.defaultValue)),t.hasOwnProperty("unique")&&!1!==t.unique){var n;n="object"==typeof t.unique&&t.unique.hasOwnProperty("name")?t.unique.name:"string"==typeof t.unique?t.unique:e.tableName+"_"+r+"_unique";var i=e.options.uniqueKeys[n]||{fields:[]};i=i||{fields:[],msg:null},i.fields.push(t.field),i.msg=i.msg||t.unique.msg||null,i.name=n||!1,i.column=r,e.options.uniqueKeys[n]=i}t.hasOwnProperty("validate")&&(e.Instance.prototype.validators[r]=t.validate),!0===t.index&&t.type instanceof l.JSONB&&(e.options.indexes.push({fields:[t.field||r],using:"gin"}),delete t.index)}),this.fieldAttributeMap=o._.reduce(this.fieldRawAttributesMap,function(e,t,r){return r!==t.fieldName&&(e[r]=t.fieldName),e},{}),this.uniqueKeys=this.options.uniqueKeys,this._hasBooleanAttributes=!!this._booleanAttributes.length,this._isBooleanAttribute=o._.memoize(function(t){return-1!==e._booleanAttributes.indexOf(t)}),this._hasDateAttributes=!!this._dateAttributes.length,this._isDateAttribute=o._.memoize(function(t){return-1!==e._dateAttributes.indexOf(t)}),this._hasHstoreAttributes=!!this._hstoreAttributes.length,this._isHstoreAttribute=o._.memoize(function(t){return-1!==e._hstoreAttributes.indexOf(t)}),this._hasRangeAttributes=!!this._rangeAttributes.length,this._isRangeAttribute=o._.memoize(function(t){return-1!==e._rangeAttributes.indexOf(t)}),this._hasJsonAttributes=!!this._jsonAttributes.length,this._isJsonAttribute=o._.memoize(function(t){return-1!==e._jsonAttributes.indexOf(t)}),this._hasVirtualAttributes=!!this._virtualAttributes.length,this._isVirtualAttribute=o._.memoize(function(t){return-1!==e._virtualAttributes.indexOf(t)}),this._hasGeometryAttributes=!!this._geometryAttributes.length,this._isGeometryAttribute=o._.memoize(function(t){return-1!==e._geometryAttributes.indexOf(t)}),this._hasDefaultValues=!o._.isEmpty(this._defaultValues),this.attributes=this.rawAttributes,this.tableAttributes=o._.omit(this.rawAttributes,this._virtualAttributes),this.Instance.prototype._hasCustomGetters=Object.keys(this.Instance.prototype._customGetters).length,this.Instance.prototype._hasCustomSetters=Object.keys(this.Instance.prototype._customSetters).length,Object.keys(t).forEach(function(e){if(s.prototype.hasOwnProperty(e))return void this.sequelize.log("Not overriding built-in method from model attribute: "+e);Object.defineProperty(this.Instance.prototype,e,t[e])}.bind(this)),this.Instance.prototype.rawAttributes=this.rawAttributes,this.Instance.prototype.attributes=Object.keys(this.Instance.prototype.rawAttributes),this.Instance.prototype._isAttribute=o._.memoize(function(t){return-1!==e.Instance.prototype.attributes.indexOf(t)}),this.primaryKeyAttributes=Object.keys(this.primaryKeys),this.primaryKeyAttribute=this.primaryKeyAttributes[0],this.primaryKeyAttribute&&(this.primaryKeyField=this.rawAttributes[this.primaryKeyAttribute].field||this.primaryKeyAttribute),this.primaryKeyCount=this.primaryKeyAttributes.length,this._hasPrimaryKeys=this.options.hasPrimaryKeys=this.hasPrimaryKeys=this.primaryKeyCount>0,this._isPrimaryKey=o._.memoize(function(t){return-1!==e.primaryKeyAttributes.indexOf(t)})},g.prototype.removeAttribute=function(e){delete this.rawAttributes[e],this.refreshAttributes()},g.prototype.sync=function(e){e=m.extend({},this.options,e),e.hooks=void 0===e.hooks||!!e.hooks;var t=this,r=this.tableAttributes;return p.try(function(){if(e.hooks)return t.runHooks("beforeSync",e)}).then(function(){if(e.force)return t.drop(e)}).then(function(){return t.QueryInterface.createTable(t.getTableName(e),r,e,t)}).then(function(){return t.QueryInterface.showIndex(t.getTableName(e),e)}).then(function(r){return t.options.indexes=t.QueryInterface.nameIndexes(t.options.indexes,t.tableName),r=m.filter(t.options.indexes,function(e){return!m.some(r,function(t){return e.name===t.name})}),p.map(r,function(r){return t.QueryInterface.addIndex(t.getTableName(e),m.assign({logging:e.logging,benchmark:e.benchmark,transaction:e.transaction},r),t.tableName)})}).then(function(){if(e.hooks)return t.runHooks("afterSync",e)}).return(this)},g.prototype.drop=function(e){return this.QueryInterface.dropTable(this.getTableName(e),e)},g.prototype.dropSchema=function(e){return this.QueryInterface.dropSchema(e)},g.prototype.schema=function(e,t){var r=this,n=Object.create(r);return n.$schema=e,t&&("string"==typeof t?n.$schemaDelimiter=t:t.schemaDelimiter&&(n.$schemaDelimiter=t.schemaDelimiter)),n.Instance=function(){r.Instance.apply(this,arguments)},n.Instance.prototype=Object.create(r.Instance.prototype),n.Instance.prototype.$Model=n,n},g.prototype.getTableName=function(e){return this.QueryGenerator.addSchema(this)},g.prototype.unscoped=function(){return this.scope()},g.prototype.addScope=function(e,t,r){if(r=m.assign({override:!1},r),("defaultScope"===e||e in this.options.scopes)&&!1===r.override)throw new Error("The scope "+e+" already exists. Pass { override: true } as options to silence this error");n(t,this),"defaultScope"===e?this.options.defaultScope=this.$scope=t:this.options.scopes[e]=t},g.prototype.scope=function(e){var t,r,i,o=Object.create(this);return o.$scope={},o.scoped=!0,e?(t=m.flatten(arguments),t.forEach(function(e){if(r=null,i=null,m.isPlainObject(e)?e.method?Array.isArray(e.method)&&o.options.scopes[e.method[0]]?(i=e.method[0],r=o.options.scopes[i].apply(o,e.method.splice(1))):o.options.scopes[e.method]&&(i=e.method,r=o.options.scopes[i].apply(o)):r=e:"defaultScope"===e&&m.isPlainObject(o.options.defaultScope)?r=o.options.defaultScope:(i=e,r=o.options.scopes[i],m.isFunction(r)&&(r=r(),n(r,o))),!r)throw new Error("Invalid scope "+i+" called.");m.assignWith(o.$scope,r,function(e,t,r){return"where"===r?Array.isArray(t)?t:m.assign(e||{},t):["attributes","include"].indexOf(r)>=0&&Array.isArray(e)&&Array.isArray(t)?e.concat(t):e||t})}),o):o},g.prototype.all=function(e){return this.findAll(e)},g.prototype.findAll=function(e){if(void 0!==e&&!m.isPlainObject(e))throw new Error("The argument passed to findAll must be an options object, use findById if you wish to pass a single primary key value");if(arguments.length>1)throw new Error("Please note that find* was refactored and uses only one options object from now on.");var t,r={};return r[this.getTableName(e)]=!0,e=o.cloneDeep(e),m.defaults(e,{hooks:!0,rejectOnEmpty:this.options.rejectOnEmpty}),e.rejectOnEmpty=e.rejectOnEmpty||this.options.rejectOnEmpty,p.bind(this).then(function(){if(n(e,this),this.$injectScope(e),e.hooks)return this.runHooks("beforeFind",e)}).then(function(){if(w.call(this,e),e.hooks)return this.runHooks("beforeFindAfterExpandIncludeAll",e)}).then(function(){if(e.include&&(e.hasJoin=!0,I.call(this,e,r),e.attributes&&!e.raw&&this.primaryKeyAttribute&&-1===e.attributes.indexOf(this.primaryKeyAttribute)&&(e.originalAttributes=e.attributes,e.attributes=[this.primaryKeyAttribute].concat(e.attributes))),e.attributes||(e.attributes=Object.keys(this.tableAttributes)),this.options.whereCollection=e.where||null,o.mapFinderOptions(e,this),e=E(this,e),e.hooks)return this.runHooks("beforeFindAfterOptions",e)}).then(function(){return t=o.cloneDeep(e),e.tableNames=Object.keys(r),this.QueryInterface.select(this,this.getTableName(e),e)}).tap(function(t){if(e.hooks)return this.runHooks("afterFind",t,e)}).then(function(r){if(m.isEmpty(r)&&e.rejectOnEmpty)throw"function"==typeof e.rejectOnEmpty?new e.rejectOnEmpty:"object"==typeof e.rejectOnEmpty?e.rejectOnEmpty:new f.EmptyResultError;return g.$findSeparate(r,t)})},g.$findSeparate=function(e,t){if(!t.include||t.raw||!e)return p.resolve(e);var r=e;return t.plain&&(e=[e]),e.length?p.map(t.include,function(r){return r.separate?r.association.get(e,m.assign({},m.omit(t,"include","attributes","order","where","limit","plain"),m.omit(r,"parent","association","as"))).then(function(t){e.forEach(function(e){e.set(r.association.as,t[e.get(r.association.source.primaryKeyAttribute)],{raw:!0})})}):g.$findSeparate(e.reduce(function(e,t){var n=t.get(r.association.as);return n?(Array.isArray(n)||(n=[n]),e.concat(n)):e},[]),m.assign({},m.omit(t,"include","attributes","order","where","limit","plain","scope"),{include:r.include||[]}))}).return(r):r},g.prototype.findById=function(e,t){if(-1!==[null,void 0].indexOf(e))return p.resolve(null);if(t=o.cloneDeep(t)||{},"number"!=typeof e&&"string"!=typeof e&&!Buffer.isBuffer(e))throw new Error("Argument passed to findById is invalid: "+e);return t.where={},t.where[this.primaryKeyAttribute]=e,g.prototype.findOne.call(this,t)},g.prototype.findByPrimary=g.prototype.findById,g.prototype.findOne=function(e){if(void 0!==e&&!m.isPlainObject(e))throw new Error("The argument passed to findOne must be an options object, use findById if you wish to pass a single primary key value");if(e=o.cloneDeep(e),void 0===e.limit){var t=e.where&&e.where[this.primaryKeyAttribute];e.where&&(o.isPrimitive(t)||Buffer.isBuffer(t))||(e.limit=1)}return g.prototype.findAll.call(this,m.defaults(e,{plain:!0,rejectOnEmpty:!1}))},g.prototype.find=g.prototype.findOne,g.prototype.aggregate=function(e,t,r){r=o.cloneDeep(r),r=m.defaults(r,{attributes:[]}),n(r,this),this.$injectScope(r),r.include&&(w.call(this,r),I.call(this,r));var i=this.rawAttributes[e],s=i&&i.field||e,a=this.sequelize.col(s);return r.distinct&&(a=this.sequelize.fn("DISTINCT",a)),r.attributes.push([this.sequelize.fn(t,a),t]),r.dataType?r.dataType=this.sequelize.normalizeDataType(r.dataType):r.dataType=i?i.type:new l.FLOAT,o.mapOptionFieldNames(r,this),r=E(this,r),this.QueryInterface.rawSelect(this.getTableName(r),r,t,this)},g.prototype.count=function(e){return p.bind(this).then(function(){if(e=m.defaults(o.cloneDeep(e),{hooks:!0}),e.hooks)return this.runHooks("beforeCount",e)}).then(function(){var t=e.include?this.name+"."+this.primaryKeyField:"*";return e.plain=!e.group,e.dataType=new l.INTEGER,e.includeIgnoreAttributes=!1,e.limit=null,e.offset=null,e.order=null,this.aggregate(t,"count",e)})},g.prototype.findAndCount=function(e){if(void 0!==e&&!m.isPlainObject(e))throw new Error("The argument passed to findAndCount must be an options object, use findById if you wish to pass a single primary key value");var t=this,r=o.cloneDeep(e);return r.attributes&&(r.attributes=void 0),t.count(r).then(function(r){return 0===r?{count:r||0,rows:[]}:t.findAll(e).then(function(e){return{count:r||0,rows:e}})})},g.prototype.findAndCountAll=g.prototype.findAndCount,g.prototype.max=function(e,t){return this.aggregate(e,"max",t)},g.prototype.min=function(e,t){return this.aggregate(e,"min",t)},g.prototype.sum=function(e,t){return this.aggregate(e,"sum",t)},g.prototype.build=function(e,t){return Array.isArray(e)?this.bulkBuild(e,t):(t=m.extend({isNewRecord:!0,$schema:this.$schema,$schemaDelimiter:this.$schemaDelimiter},t||{}),t.attributes&&(t.attributes=t.attributes.map(function(e){return Array.isArray(e)?e[1]:e})),t.includeValidated||(n(t,this),t.include&&(w.call(this,t),I.call(this,t))),new this.Instance(e,t))},g.prototype.bulkBuild=function(e,t){return t=m.extend({isNewRecord:!0},t||{}),t.includeValidated||(n(t,this),t.include&&(w.call(this,t),I.call(this,t))),t.attributes&&(t.attributes=t.attributes.map(function(e){return Array.isArray(e)?e[1]:e})),e.map(function(e){return this.build(e,t)}.bind(this))},g.prototype.create=function(e,t){return t=o.cloneDeep(t||{}),this.build(e,{isNewRecord:!0,attributes:t.fields,include:t.include,raw:t.raw,silent:t.silent}).save(t)},g.prototype.findOrInitialize=g.prototype.findOrBuild=function(e){if(!e||!e.where||arguments.length>1)throw new Error("Missing where attribute in the options parameter passed to findOrInitialize. Please note that the API has changed, and is now options only (an object with where, defaults keys, transaction etc.)");var t,r=this;return r.find(e).then(function(n){return null===n?(t=o._.clone(e.defaults)||{},o._.isPlainObject(e.where)&&(t=o._.defaults(t,e.where)),n=r.build(t),p.resolve([n,!0])):p.resolve([n,!1])})},g.prototype.findOrCreate=function(e){if(!e||!e.where||arguments.length>1)throw new Error("Missing where attribute in the options parameter passed to findOrCreate. Please note that the API has changed, and is now options only (an object with where, defaults keys, transaction etc.)");if(e=m.assign({},e),void 0===e.transaction&&this.sequelize.constructor.cls){var t=this.sequelize.constructor.cls.get("transaction");t&&(e.transaction=t)}var r,n,i,s=this,a=!e.transaction,u=Object.keys(e.where);return e.defaults&&(n=Object.keys(e.defaults)),s.sequelize.transaction(e).bind({}).then(function(t){return i=t,e.transaction=t,s.findOne(m.defaults({transaction:i},e))}).then(function(t){return null!==t?[t,!1]:(r=o._.clone(e.defaults)||{},o._.isPlainObject(e.where)&&(r=m.defaults(r,e.where)),e.exception=!0,s.create(r,e).bind(this).then(function(e){if(null===e.get(s.primaryKeyAttribute,{raw:!0}))throw new s.sequelize.UniqueConstraintError;return[e,!0]}).catch(s.sequelize.UniqueConstraintError,function(t){if(n&&!m.intersection(t.fields,u).length&&m.intersection(t.fields,n).length)throw t;return s.findOne(m.defaults({transaction:a?null:i},e)).then(function(e){if(null===e)throw t;return[e,!1]})}))}).finally(function(){if(a&&i)return i.commit()})},g.prototype.findCreateFind=function(e){if(!e||!e.where)throw new Error("Missing where attribute in the options parameter passed to findOrCreate.");var t=o._.clone(e.defaults)||{};return o._.isPlainObject(e.where)&&(t=m.defaults(t,e.where)),this.findOne(e).bind(this).then(function(r){return r?[r,!1]:this.create(t,e).bind(this).then(function(e){return[e,!0]}).catch(this.sequelize.UniqueConstraintError,function(t){return this.findOne(e).then(function(e){return[e,!1]})})})},g.prototype.upsert=function(e,t){t=o.cloneDeep(t)||{},t.fields||(t.fields=Object.keys(this.attributes));var r=this._timestampAttributes.createdAt,n=this._timestampAttributes.updatedAt,i=this.primaryKeyField in e||this.primaryKeyAttribute in e,s=this.build(e);return s.hookValidate(t).bind(this).then(function(){var e=m.pick(s.dataValues,Object.keys(s._changed)),a=o.mapValueFieldNames(s.dataValues,t.fields,this),u=o.mapValueFieldNames(e,t.fields,this),l=o.now(this.sequelize.options.dialect);return r&&!u[r]&&(a[r]=this.$getDefaultTimestamp(r)||l),n&&!a[n]&&(a[n]=u[n]=this.$getDefaultTimestamp(n)||l),i||!this.primaryKeyAttribute||this.rawAttributes[this.primaryKeyAttribute].defaultValue||(delete a[this.primaryKeyField],delete u[this.primaryKeyField]),this.QueryInterface.upsert(this.getTableName(t),a,u,s.where(),this,t)})},g.prototype.insertOrUpdate=g.prototype.upsert,g.prototype.bulkCreate=function(e,t){if(!e.length)return p.resolve([]);t=o._.extend({validate:!1,hooks:!0,individualHooks:!1,ignoreDuplicates:!1},t||{}),t.fields=t.fields||Object.keys(this.tableAttributes),t.model=this;var r=this.sequelize.options.dialect;if(t.ignoreDuplicates&&-1!==["postgres","mssql"].indexOf(r))return p.reject(new Error(r+" does not support the 'ignoreDuplicates' option."));if(t.updateOnDuplicate&&-1===["mysql","mariadb"].indexOf(r))return p.reject(new Error(r+" does not support the 'updateOnDuplicate' option."));if(t.updateOnDuplicate){var n=o._.pull(Object.keys(this.tableAttributes),"createdAt");o._.isArray(t.updateOnDuplicate)&&!o._.isEmpty(t.updateOnDuplicate)&&(n=o._.intersection(n,t.updateOnDuplicate)),t.updateOnDuplicate=n}var i=this,s=this._timestampAttributes.createdAt,a=this._timestampAttributes.updatedAt,u=o.now(i.modelManager.sequelize.options.dialect),l=e.map(function(e){return i.build(e,{isNewRecord:!0})});return p.try(function(){if(t.hooks)return i.runHooks("beforeBulkCreate",l,t)}).then(function(){if(t.validate){var e=[];return p.map(l,function(r){return t.individualHooks?r.hookValidate(t).catch(function(t){t&&e.push({record:r,errors:t})}):r.validate(t).then(function(t){t&&e.push({record:r,errors:t})})}).then(function(){if(delete t.skip,e.length)return p.reject(e)})}}).then(function(){if(l.forEach(function(e){var r=o.mapValueFieldNames(e.dataValues,t.fields,i);s&&!r[s]&&(r[s]=u),a&&!r[a]&&(r[a]=u),e.dataValues=r}),t.individualHooks)return p.map(l,function(e){var r=o._.clone(t);return delete r.fields,delete r.individualHooks,delete r.ignoreDuplicates,r.validate=!1,r.hooks=!0,e.save(r)}).then(function(e){l=e});e=l.map(function(e){return o._.omit(e.dataValues,i._virtualAttributes)});var r={};for(var n in i.tableAttributes)r[n]=i.rawAttributes[n],i.rawAttributes[n].field&&(r[i.rawAttributes[n].field]=i.rawAttributes[n]);return i.QueryInterface.bulkInsert(i.getTableName(t),e,t,r).then(function(e){return Array.isArray(e)&&e.forEach(function(e,t){l[t].set(i.primaryKeyAttribute,e[i.rawAttributes[i.primaryKeyAttribute].field],{raw:!0}),l[t].isNewRecord=!1}),e})}).then(function(){if(t.hooks)return i.runHooks("afterBulkCreate",l,t)}).then(function(){return l})},g.prototype.truncate=function(e){return e=o.cloneDeep(e)||{},e.truncate=!0,this.destroy(e)},g.prototype.destroy=function(e){var t,r=this;if(!e||!e.where&&!e.truncate)throw new Error("Missing where or truncate attribute in the options parameter of model.destroy.");if(!e.truncate&&!m.isPlainObject(e.where)&&!m.isArray(e.where)&&!0!==e.where._isSequelizeMethod)throw new Error("Expected plain object, array or sequelize method in the options.where parameter of model.destroy.");return e=o.cloneDeep(e),e=m.defaults(e,{hooks:!0,individualHooks:!1,force:!1,cascade:!1,restartIdentity:!1}),e.type=h.BULKDELETE,this.$injectScope(e),o.mapOptionFieldNames(e,this),e.model=r,p.try(function(){if(e.hooks)return r.runHooks("beforeBulkDestroy",e)}).then(function(){if(e.individualHooks)return r.findAll({where:e.where,transaction:e.transaction,logging:e.logging,benchmark:e.benchmark}).map(function(t){return r.runHooks("beforeDestroy",t,e).then(function(){return t})}).then(function(e){t=e})}).then(function(){if(r._timestampAttributes.deletedAt&&!e.force){e.type=h.BULKUPDATE;var t={},n=r.rawAttributes[r._timestampAttributes.deletedAt],i=r.rawAttributes[r._timestampAttributes.deletedAt].field,s={};return s[i]=n.hasOwnProperty("defaultValue")?n.defaultValue:null,t[i]=o.now(r.modelManager.sequelize.options.dialect),r.QueryInterface.bulkUpdate(r.getTableName(e),t,m.defaults(s,e.where),e,r.rawAttributes)}return r.QueryInterface.bulkDelete(r.getTableName(e),e.where,e,r)}).tap(function(){if(e.individualHooks)return p.map(t,function(t){return r.runHooks("afterDestroy",t,e)})}).tap(function(){if(e.hooks)return r.runHooks("afterBulkDestroy",e)}).then(function(e){return e})},g.prototype.restore=function(e){if(!this._timestampAttributes.deletedAt)throw new Error("Model is not paranoid");e=o._.extend({hooks:!0,individualHooks:!1},e||{}),e.type=h.RAW,e.model=this;var t,r=this;return o.mapOptionFieldNames(e,this),p.try(function(){if(e.hooks)return r.runHooks("beforeBulkRestore",e)}).then(function(){if(e.individualHooks)return r.findAll({where:e.where,transaction:e.transaction,logging:e.logging,benchmark:e.benchmark,paranoid:!1}).map(function(t){return r.runHooks("beforeRestore",t,e).then(function(){return t})}).then(function(e){t=e})}).then(function(){var t={},n=r._timestampAttributes.deletedAt,i=r.rawAttributes[n],o=i.hasOwnProperty("defaultValue")?i.defaultValue:null;return t[i.field||n]=o,e.omitNull=!1,r.QueryInterface.bulkUpdate(r.getTableName(e),t,e.where,e,r._timestampAttributes.deletedAt)}).tap(function(){if(e.individualHooks)return p.map(t,function(t){return r.runHooks("afterRestore",t,e)})}).tap(function(){if(e.hooks)return r.runHooks("afterBulkRestore",e)}).then(function(e){return e})},g.prototype.update=function(e,t){var r=this;if(!t||!t.where)throw new Error("Missing where attribute in the options parameter passed to update.");if(!m.isPlainObject(t.where)&&!m.isArray(t.where)&&!0!==t.where._isSequelizeMethod)throw new Error("Expected plain object, array or sequelize method in the options.where parameter of model.update.");if(t=o.cloneDeep(t),t=m.defaults(t,{validate:!0,hooks:!0,individualHooks:!1,returning:!1,force:!1,sideEffects:!0}),t.type=h.BULKUPDATE,t.model=this,this.$injectScope(t),e=m.clone(e),t.fields&&t.fields instanceof Array)Object.keys(e).forEach(function(r){t.fields.indexOf(r)<0&&delete e[r]});else{var n=this._timestampAttributes.updatedAt;t.fields=m.intersection(Object.keys(e),Object.keys(this.tableAttributes)),n&&-1===t.fields.indexOf(n)&&t.fields.push(n)}this._timestampAttributes.updatedAt&&!t.silent&&(e[this._timestampAttributes.updatedAt]=this.$getDefaultTimestamp(this._timestampAttributes.updatedAt)||o.now(this.sequelize.options.dialect));var i,s;return p.try(function(){if(t.validate){var n=r.build(e);return n.set(r._timestampAttributes.updatedAt,e[r._timestampAttributes.updatedAt],{raw:!0}),t.sideEffects&&(e=o._.assign(e,o._.pick(n.get(),n.changed())),t.fields=o._.union(t.fields,Object.keys(e))),t.skip=o._.difference(Object.keys(r.attributes),Object.keys(e)),n.hookValidate(t).then(function(r){t.skip=void 0,r&&r.dataValues&&(e=o._.pick(r.dataValues,Object.keys(e)))})}return null}).then(function(){return t.hooks?(t.attributes=e,r.runHooks("beforeBulkUpdate",t).then(function(){e=t.attributes,delete t.attributes})):null}).then(function(){if(s=e,t.individualHooks)return r.findAll({where:t.where,transaction:t.transaction,logging:t.logging,benchmark:t.benchmark}).then(function(n){if(i=n,!i.length)return[];var a,u=!1;return p.map(i,function(n){return o._.extend(n.dataValues,e),o._.forIn(s,function(e,t){e!==n._previousDataValues[t]&&n.setDataValue(t,e)}),r.runHooks("beforeUpdate",n,t).then(function(){if(!u){var e={};o._.forIn(n.dataValues,function(t,r){t!==n._previousDataValues[r]&&(e[r]=t)}),a?u=!o._.isEqual(a,e):a=e}return n})}).then(function(e){if(i=e,u)return p.map(i,function(e){var r=o._.clone(t);return delete r.individualHooks,r.hooks=!1,r.validate=!1,e.save(r)}).tap(function(e){i=e});var r=Object.keys(a);return void(r.length&&(s=a,t.fields=o._.union(t.fields,r)))})})}).then(function(e){return e?[e.length,e]:(s=o.mapValueFieldNames(s,t.fields,r),t=o.mapOptionFieldNames(t,r),t.hasTrigger=!!r.options&&r.options.hasTrigger,r.QueryInterface.bulkUpdate(r.getTableName(t),s,t.where,t,r.tableAttributes).then(function(e){return t.returning?(i=e,[e.length,e]):[e]}))}).tap(function(e){if(t.individualHooks)return p.map(i,function(e){return r.runHooks("afterUpdate",e,t)}).then(function(){e[1]=i})}).tap(function(){if(t.hooks)return t.attributes=e,r.runHooks("afterBulkUpdate",t).then(function(){delete t.attributes})}).then(function(e){return e})},g.prototype.describe=function(e,t){return this.QueryInterface.describeTable(this.tableName,m.assign({schema:e||this.$schema||void 0},t))},g.prototype.$getDefaultTimestamp=function(e){if(this.rawAttributes[e]&&this.rawAttributes[e].defaultValue)return o.toDefaultValue(this.rawAttributes[e].defaultValue)},g.prototype.$expandAttributes=function(e){if(m.isPlainObject(e.attributes)){var t=Object.keys(this.rawAttributes);e.attributes.exclude&&(t=t.filter(function(t){return-1===e.attributes.exclude.indexOf(t)})),e.attributes.include&&(t=t.concat(e.attributes.include)),e.attributes=t}},g.prototype.$injectScope=function(e){var t=this,r=o.cloneDeep(this.$scope),n=m.omit(r,"include");m.defaults(e,n),m.defaults(e.where,n.where),r.include&&(e.include=e.include||[],r.include.reverse().forEach(function(r){!r.all&&e.include.some(function(e){var n=e.model&&e.model.name===r.model.name;if(!n||!e.as)return n;if(r.as)return e.as===r.as;var i=r.association||t.getAssociation(r.model,r.as);return!!i&&e.as===i.as})||e.include.push(r)}))},g.prototype.inspect=function(){return this.name},o._.extend(g.prototype,y),d.applyTo(g),e.exports=g,e.exports.Model=g,e.exports.default=g},function(e,t,r){"use strict";var n=r(3),i=r(21),o=r(4),s=r(63),a=function(e,t){if(this.association=e,this.source=e.source,this.target=e.target,this.options=t||{},this.sequelize=this.source.modelManager.sequelize,this.as=this.options.as,"HasMany"!==e.associationType)throw new Error("Can only have CounterCache on HasMany association");this.as?(this.isAliased=!0,this.columnName=this.as):(this.as="count_"+this.target.options.name.plural,this.columnName=n.camelizeIf(this.as,!this.source.options.underscored)),this.injectAttributes(),this.injectHooks()};a.prototype.injectAttributes=function(){i.checkNamingCollision(this);var e={};e[this.columnName]={type:o.INTEGER,allowNull:!1,defaultValue:n._.partial(n.toDefaultValue,0)},n.mergeDefaults(this.source.rawAttributes,e),this.source.refreshAttributes()},a.prototype.injectHooks=function(){var e,t,r,n,i=this.association,o=this;e={update:function(t,r){var n=e._targetQuery(t);return i.target.count({where:n,logging:r&&r.logging}).then(function(s){var a={};return n=e._sourceQuery(t),a[o.columnName]=s,i.source.update(a,{where:n,logging:r&&r.logging})})},increment:function(t,r){var n=e._sourceQuery(t);return i.source.find({where:n,logging:r&&r.logging}).then(function(e){return e.increment(o.columnName,{by:1,logging:r&&r.logging})})},decrement:function(t,r){var n=e._sourceQuery(t);return i.source.find({where:n,logging:r&&r.logging}).then(function(e){return e.decrement(o.columnName,{by:1,logging:r&&r.logging})})},_targetQuery:function(e){var t={};return t[i.foreignKey]=e,t},_sourceQuery:function(e){var t={};return t[i.source.primaryKeyAttribute]=e,t}},t=function(t,r){var o=t.get(i.foreignKey),a=[];return o&&a.push(e.update(o,r)),n&&n!==o&&a.push(e.update(n,r)),s.all(a).return(void 0)},r={create:function(t,r){var n=t.get(i.foreignKey);if(n)return e.increment(n,r)},update:function(t,r){var o=t.get(i.foreignKey),a=[];return o&&!n&&a.push(e.increment(o,r)),!o&&n&&a.push(e.decrement(o,r)),n&&o&&n!==o&&(a.push(e.increment(o,r)),a.push(e.decrement(n,r))),s.all(a)},destroy:function(t,r){var n=t.get(i.foreignKey);if(n)return e.decrement(n,r)}},i.target.addHook("beforeUpdate",function(e){n=e.previous(i.foreignKey)}),!1===this.options.atomic?(i.target.addHook("afterCreate",t),i.target.addHook("afterUpdate",t),i.target.addHook("afterDestroy",t)):(i.target.addHook("afterCreate",r.create),i.target.addHook("afterUpdate",r.update),i.target.addHook("afterDestroy",r.destroy))},e.exports=a},function(e,t,r){"use strict";var n=r(44),i=r(0),o={extend:function(e,t){return this[e]=t,this},notEmpty:function(e){return!e.match(/^[\s\t\r\n]*$/)},len:function(e,t,r){return this.isLength(e,t,r)},isUrl:function(e){return this.isURL(e)},isIPv6:function(e){return this.isIP(e,6)},isIPv4:function(e){return this.isIP(e,4)},notIn:function(e,t){return!this.isIn(e,t)},regex:function(e,t,r){return e+="","RegExp"!==Object.prototype.toString.call(t).slice(8,-1)&&(t=new RegExp(t,r)),e.match(t)},notRegex:function(e,t,r){return!this.regex(e,t,r)},isDecimal:function(e){return""!==e&&e.match(/^(?:-?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/)},min:function(e,t){var r=parseFloat(e);return isNaN(r)||r>=t},max:function(e,t){var r=parseFloat(e);return isNaN(r)||r<=t},not:function(e,t,r){return this.notRegex(e,t,r)},contains:function(e,t){return e.indexOf(t)>=0&&!!t},notContains:function(e,t){return!this.contains(e,t)},is:function(e,t,r){return this.regex(e,t,r)}},s=function(e){var t={isImmutable:function(t,r,n){return e.isNewRecord||e.dataValues[n]===e._previousDataValues[n]}};i.forEach(t,function(e,t){n[t]=e})};n.notNull=function(){throw new Error('Warning "notNull" validation has been deprecated in favor of Schema based "allowNull"')},i.forEach(o,function(e,t){n[t]=e}),e.exports={extensions:o,extendModelValidations:s,validator:n}},function(e,t,r){"use strict";var n=r(1),i=r(2),o=r(70),s=r(71).htmlToText;e.exports={send:function(e,t,a,u){i.info("Sending email to "+e+" with subject "+t+"..."),i.debug("Deprecated! libs/mailer is deprecated. Use Service.get('mailer') instead!");var l={from:n.mailer.from,to:e,subject:t,html:a},c=void 0;if("smtp"==n.mailer.transport)c=o.createTransport(n.mailer.smtp);else if("mailgun"==n.mailer.transport){var p=r(72);c=o.createTransport(p({auth:{api_key:n.mailer.mailgun.apiKey,domain:n.mailer.mailgun.domain}}))}else if("sendgrid"==n.mailer.transport){var h=r(73);c=o.createTransport(h({auth:{api_key:n.mailer.sendgrid.apiKey}}))}c?(c.use("compile",s()),c.sendMail(l,function(e,t){e?i.warn("Unable to send email: ",e):i.info("Email message sent.",t.response),u&&u(e,t)})):i.warn("Unable to send email! Invalid mailer transport: "+n.mailer.transport)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(40);Object.defineProperty(t,"GraphQLError",{enumerable:!0,get:function(){return n.GraphQLError}});var i=r(151);Object.defineProperty(t,"syntaxError",{enumerable:!0,get:function(){return i.syntaxError}});var o=r(150);Object.defineProperty(t,"locatedError",{enumerable:!0,get:function(){return o.locatedError}});var s=r(149);Object.defineProperty(t,"formatError",{enumerable:!0,get:function(){return s.formatError}})},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.BREAK=t.visitWithTypeInfo=t.visitInParallel=t.visit=t.Source=t.print=t.parseType=t.parseValue=t.parse=t.TokenKind=t.createLexer=t.Kind=t.getLocation=void 0;var i=r(58);Object.defineProperty(t,"getLocation",{enumerable:!0,get:function(){return i.getLocation}});var o=r(57);Object.defineProperty(t,"createLexer",{enumerable:!0,get:function(){return o.createLexer}}),Object.defineProperty(t,"TokenKind",{enumerable:!0,get:function(){return o.TokenKind}});var s=r(153);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return s.parse}}),Object.defineProperty(t,"parseValue",{enumerable:!0,get:function(){return s.parseValue}}),Object.defineProperty(t,"parseType",{enumerable:!0,get:function(){return s.parseType}});var a=r(154);Object.defineProperty(t,"print",{enumerable:!0,get:function(){return a.print}});var u=r(59);Object.defineProperty(t,"Source",{enumerable:!0,get:function(){return u.Source}});var l=r(60);Object.defineProperty(t,"visit",{enumerable:!0,get:function(){return l.visit}}),Object.defineProperty(t,"visitInParallel",{enumerable:!0,get:function(){return l.visitInParallel}}),Object.defineProperty(t,"visitWithTypeInfo",{enumerable:!0,get:function(){return l.visitWithTypeInfo}}),Object.defineProperty(t,"BREAK",{enumerable:!0,get:function(){return l.BREAK}});var c=r(56),p=n(c);t.Kind=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NAME="Name",t.DOCUMENT="Document",t.OPERATION_DEFINITION="OperationDefinition",t.VARIABLE_DEFINITION="VariableDefinition",t.VARIABLE="Variable",t.SELECTION_SET="SelectionSet",t.FIELD="Field",t.ARGUMENT="Argument",t.FRAGMENT_SPREAD="FragmentSpread",t.INLINE_FRAGMENT="InlineFragment",t.FRAGMENT_DEFINITION="FragmentDefinition",t.INT="IntValue",t.FLOAT="FloatValue",t.STRING="StringValue",t.BOOLEAN="BooleanValue",t.NULL="NullValue",t.ENUM="EnumValue",t.LIST="ListValue",t.OBJECT="ObjectValue",t.OBJECT_FIELD="ObjectField",t.DIRECTIVE="Directive",t.NAMED_TYPE="NamedType",t.LIST_TYPE="ListType",t.NON_NULL_TYPE="NonNullType",t.SCHEMA_DEFINITION="SchemaDefinition",t.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",t.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",t.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",t.FIELD_DEFINITION="FieldDefinition",t.INPUT_VALUE_DEFINITION="InputValueDefinition",t.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",t.UNION_TYPE_DEFINITION="UnionTypeDefinition",t.ENUM_TYPE_DEFINITION="EnumTypeDefinition",t.ENUM_VALUE_DEFINITION="EnumValueDefinition",t.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",t.TYPE_EXTENSION_DEFINITION="TypeExtensionDefinition",t.DIRECTIVE_DEFINITION="DirectiveDefinition"},function(e,t,r){"use strict";function n(e,t){var r=new s(v,0,0,0,0,null);return{source:e,options:t,lastToken:r,token:r,line:1,lineStart:0,advance:i}}function i(){var e=this.lastToken=this.token;if(e.kind!==b){do{e=e.next=u(this,e)}while(e.kind===K);this.token=e}return e}function o(e){var t=e.value;return t?e.kind+' "'+t+'"':e.kind}function s(e,t,r,n,i,o,s){this.kind=e,this.start=t,this.end=r,this.line=n,this.column=i,this.value=s,this.prev=o,this.next=null}function a(e){return isNaN(e)?b:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'+("00"+e.toString(16).toUpperCase()).slice(-4)+'"'}function u(e,t){var r=e.source,n=r.body,i=n.length,o=c(n,t.end,e),u=e.line,d=1+o-e.lineStart;if(o>=i)return new s(b,i,i,u,d,t);var m=U.call(n,o);if(m<32&&9!==m&&10!==m&&13!==m)throw(0,E.syntaxError)(r,o,"Cannot contain the invalid character "+a(m)+".");switch(m){case 33:return new s(A,o,o+1,u,d,t);case 35:return p(r,o,u,d,t);case 36:return new s(T,o,o+1,u,d,t);case 40:return new s(N,o,o+1,u,d,t);case 41:return new s(I,o,o+1,u,d,t);case 46:if(46===U.call(n,o+1)&&46===U.call(n,o+2))return new s(w,o,o+3,u,d,t);break;case 58:return new s(O,o,o+1,u,d,t);case 61:return new s(_,o,o+1,u,d,t);case 64:return new s(R,o,o+1,u,d,t);case 91:return new s(S,o,o+1,u,d,t);case 93:return new s(q,o,o+1,u,d,t);case 123:return new s(k,o,o+1,u,d,t);case 124:return new s(D,o,o+1,u,d,t);case 125:return new s(C,o,o+1,u,d,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return g(r,o,u,d,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return h(r,o,m,u,d,t);case 34:return f(r,o,u,d,t)}throw(0,E.syntaxError)(r,o,l(m))}function l(e){return 39===e?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character "+a(e)+"."}function c(e,t,r){for(var n=e.length,i=t;i<n;){var o=U.call(e,i);if(9===o||32===o||44===o||65279===o)++i;else if(10===o)++i,++r.line,r.lineStart=i;else{if(13!==o)break;10===U.call(e,i+1)?i+=2:++i,++r.line,r.lineStart=i}}return i}function p(e,t,r,n,i){var o=e.body,a=void 0,u=t;do{a=U.call(o,++u)}while(null!==a&&(a>31||9===a));return new s(K,t,u,r,n,i,j.call(o,t+1,u))}function h(e,t,r,n,i,o){var u=e.body,l=r,c=t,p=!1;if(45===l&&(l=U.call(u,++c)),48===l){if((l=U.call(u,++c))>=48&&l<=57)throw(0,E.syntaxError)(e,c,"Invalid number, unexpected digit after 0: "+a(l)+".")}else c=d(e,c,l),l=U.call(u,c);return 46===l&&(p=!0,l=U.call(u,++c),c=d(e,c,l),l=U.call(u,c)),69!==l&&101!==l||(p=!0,l=U.call(u,++c),43!==l&&45!==l||(l=U.call(u,++c)),c=d(e,c,l)),new s(p?x:M,t,c,n,i,o,j.call(u,t,c))}function d(e,t,r){var n=e.body,i=t,o=r;if(o>=48&&o<=57){do{o=U.call(n,++i)}while(o>=48&&o<=57);return i}throw(0,E.syntaxError)(e,i,"Invalid number, expected digit but got: "+a(o)+".")}function f(e,t,r,n,i){for(var o=e.body,u=t+1,l=u,c=0,p="";u<o.length&&null!==(c=U.call(o,u))&&10!==c&&13!==c&&34!==c;){if(c<32&&9!==c)throw(0,E.syntaxError)(e,u,"Invalid character within String: "+a(c)+".");if(++u,92===c){switch(p+=j.call(o,l,u-1),c=U.call(o,u)){case 34:p+='"';break;case 47:p+="/";break;case 92:p+="\\";break;case 98:p+="\b";break;case 102:p+="\f";break;case 110:p+="\n";break;case 114:p+="\r";break;case 116:p+="\t";break;case 117:var h=m(U.call(o,u+1),U.call(o,u+2),U.call(o,u+3),U.call(o,u+4));if(h<0)throw(0,E.syntaxError)(e,u,"Invalid character escape sequence: \\u"+o.slice(u+1,u+5)+".");p+=String.fromCharCode(h),u+=4;break;default:throw(0,E.syntaxError)(e,u,"Invalid character escape sequence: \\"+String.fromCharCode(c)+".")}++u,l=u}}if(34!==c)throw(0,E.syntaxError)(e,u,"Unterminated string.");return p+=j.call(o,l,u),new s(P,t,u+1,r,n,i,p)}function m(e,t,r,n){return y(e)<<12|y(t)<<8|y(r)<<4|y(n)}function y(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function g(e,t,r,n,i){for(var o=e.body,a=o.length,u=t+1,l=0;u!==a&&null!==(l=U.call(o,u))&&(95===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122);)++u;return new s(L,t,u,r,n,i,j.call(o,t,u))}Object.defineProperty(t,"__esModule",{value:!0}),t.TokenKind=void 0,t.createLexer=n,t.getTokenDesc=o;var E=r(54),v="<SOF>",b="<EOF>",A="!",T="$",N="(",I=")",w="...",O=":",_="=",R="@",S="[",q="]",k="{",D="|",C="}",L="Name",M="Int",x="Float",P="String",K="Comment",U=(t.TokenKind={SOF:v,EOF:b,BANG:A,DOLLAR:T,PAREN_L:N,PAREN_R:I,SPREAD:w,COLON:O,EQUALS:_,AT:R,BRACKET_L:S,BRACKET_R:q,BRACE_L:k,PIPE:D,BRACE_R:C,NAME:L,INT:M,FLOAT:x,STRING:P,COMMENT:K},String.prototype.charCodeAt),j=String.prototype.slice;s.prototype.toJSON=s.prototype.inspect=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}},function(e,t,r){"use strict";function n(e,t){for(var r=/\r\n|[\n\r]/g,n=1,i=t+1,o=void 0;(o=r.exec(e.body))&&o.index<t;)n+=1,i=t+1-(o.index+o[0].length);return{line:n,column:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocation=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.Source=function e(t,r){n(this,e),this.body=t,this.name=r||"GraphQL"}},function(e,t,r){"use strict";function n(e,t,r){var n=r||u,o=void 0,s=Array.isArray(e),c=[e],p=-1,h=[],d=void 0,f=[],m=[],y=e;do{p++;var g=p===c.length,E=void 0,v=void 0,b=g&&0!==h.length;if(g){if(E=0===m.length?void 0:f.pop(),v=d,d=m.pop(),b){if(s)v=v.slice();else{var A={};for(var T in v)v.hasOwnProperty(T)&&(A[T]=v[T]);v=A}for(var N=0,I=0;I<h.length;I++){var w=h[I][0],O=h[I][1];s&&(w-=N),s&&null===O?(v.splice(w,1),N++):v[w]=O}}p=o.index,c=o.keys,h=o.edits,s=o.inArray,o=o.prev}else{if(E=d?s?p:c[p]:void 0,null===(v=d?d[E]:y)||void 0===v)continue;d&&f.push(E)}var _=void 0;if(!Array.isArray(v)){if(!i(v))throw new Error("Invalid AST Node: "+JSON.stringify(v));var R=a(t,v.kind,g);if(R){if((_=R.call(t,v,E,d,f,m))===l)break;if(!1===_){if(!g){f.pop();continue}}else if(void 0!==_&&(h.push([E,_]),!g)){if(!i(_)){f.pop();continue}v=_}}}void 0===_&&b&&h.push([E,v]),g||(o={inArray:s,index:p,keys:c,edits:h,prev:o},s=Array.isArray(v),c=s?v:n[v.kind]||[],p=-1,h=[],d&&m.push(d),d=v)}while(void 0!==o);return 0!==h.length&&(y=h[h.length-1][1]),y}function i(e){return e&&"string"==typeof e.kind}function o(e){var t=new Array(e.length);return{enter:function(r){for(var n=0;n<e.length;n++)if(!t[n]){var i=a(e[n],r.kind,!1);if(i){var o=i.apply(e[n],arguments);if(!1===o)t[n]=r;else if(o===l)t[n]=l;else if(void 0!==o)return o}}},leave:function(r){for(var n=0;n<e.length;n++)if(t[n])t[n]===r&&(t[n]=null);else{var i=a(e[n],r.kind,!0);if(i){var o=i.apply(e[n],arguments);if(o===l)t[n]=l;else if(void 0!==o&&!1!==o)return o}}}}}function s(e,t){return{enter:function(r){e.enter(r);var n=a(t,r.kind,!1);if(n){var o=n.apply(t,arguments);return void 0!==o&&(e.leave(r),i(o)&&e.enter(o)),o}},leave:function(r){var n=a(t,r.kind,!0),i=void 0;return n&&(i=n.apply(t,arguments)),e.leave(r),i}}}function a(e,t,r){var n=e[t];if(n){if(!r&&"function"==typeof n)return n;var i=r?n.leave:n.enter;if("function"==typeof i)return i}else{var o=r?e.leave:e.enter;if(o){if("function"==typeof o)return o;var s=o[t];if("function"==typeof s)return s}}}Object.defineProperty(t,"__esModule",{value:!0}),t.visit=n,t.visitInParallel=o,t.visitWithTypeInfo=s;var u=t.QueryDocumentKeys={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["name","directives"],ObjectTypeDefinition:["name","interfaces","directives","fields"],FieldDefinition:["name","arguments","type","directives"],InputValueDefinition:["name","type","defaultValue","directives"],InterfaceTypeDefinition:["name","directives","fields"],UnionTypeDefinition:["name","directives","types"],EnumTypeDefinition:["name","directives","values"],EnumValueDefinition:["name","directives"],InputObjectTypeDefinition:["name","directives","fields"],TypeExtensionDefinition:["definition"],DirectiveDefinition:["name","arguments","locations"]},l=t.BREAK={}},function(e,t){e.exports={name:"Analytics",title:"Analytics",description:"",main:"server/index.js",scripts:{build:"webpack --progress --colors --config build/webpack.prod.config.js","build:server":"webpack --progress --colors --config build/webpack.server.config.js",dev:"cross-env NODE_ENV=development nodemon --debug",start:"cross-env NODE_ENV=production node server/index.js","start:bundle":"cross-env NODE_ENV=production node server/bundle.js","start:cluster":"cross-env NODE_ENV=production node cluster.js","test:unit":"cross-env NODE_ENV=test mocha --require babel-core/register --reporter spec tests/unit","test:e2e:nightmare":"cross-env NODE_ENV=test mocha --require babel-core/register --timeout 30000 --reporter spec tests/e2e","test:e2e":"node tests/e2e/runner.js",test:"npm run test:unit && npm run test:e2e",ci:'cross-env NODE_ENV=test nodemon --exec "mocha --require babel-core/register --reporter dot --watch tests/unit" tests/unit',lint:"eslint --ext=.js,.vue client server","lint:fix":"eslint --fix --ext=.js,.vue client server","snyk-protect":"snyk protect",typings:"typings install",prepublish:"npm run snyk-protect"},repository:{type:"git",url:""},keywords:["boilerplate","express","mongo","vue","mongodb","hackaton","bootstrap","starter"],config:{dbName:"boilerplate"},author:"Icebob",license:"MIT",dependencies:{accounting:"^0.4.1",agenda:"0.9.0",async:"2.1.4",axios:"0.15.3","bcrypt-nodejs":"0.0.3","body-parser":"1.17.1",chalk:"1.1.3","cli-table2":"0.2.0",clui:"0.3.1",compression:"1.6.2","connect-mongo":"1.3.2","cookie-parser":"1.4.3","cross-env":"3.1.3",csurf:"1.9.0",express:"4.15.2","express-flash":"0.0.2","express-list-endpoints":"3.0.0","express-session":"1.14.2","express-status-monitor":"0.1.7","express-validator":"3.1.2",fakerator:"0.3.0",glob:"7.1.1",graphql:"0.8.2","graphql-server-express":"0.4.3","graphql-subscriptions":"0.2.2","graphql-tools":"0.8.4",hashids:"1.1.1",helmet:"3.2.0","helmet-crossdomain":"0.1.0","highlight.js":"^9.12.0",i18next:"4.1.4","i18next-express-middleware":"1.0.2","i18next-node-fs-backend":"0.1.3",ioredis:"2.4.3",le_node:"1.7.0",lodash:"4.17.3","material-colors":"^1.2.5","method-override":"2.3.7",mkdirp:"0.5.1",moment:"^2.17.1","moment-range":"^3.0.3",mongoose:"4.7.5","mongoose-auto-increment":"5.0.1",morgan:"1.7.0",mysql:"^2.13.0",netjet:"1.1.3","node-sass":"4.1.1",nodemailer:"2.7.0","nodemailer-html-to-text":"2.1.0","nodemailer-mailgun-transport":"1.2.4","nodemailer-sendgrid-transport":"0.2.0","object-hash":"1.1.5",passport:"0.3.2","passport-facebook":"2.1.1","passport-github":"1.1.0","passport-google-oauth":"1.0.0","passport-local":"1.0.0","passport-localapikey-update":"0.5.0","passport-twitter":"1.0.4",pg:"^6.2.3","pretty-bytes":"4.0.2","promise-mysql":"^3.0.1",pug:"2.0.0-beta6","require-webpack-compat":"3.0.0","scss-loader":"0.0.1",sequelize:"^3.30.4","serve-favicon":"2.3.2","simple-oauth2":"^1.2.0",slug:"0.9.1",snyk:"^1.22.1","socket.io":"1.7.3","socket.io-client":"1.7.3",terminalone:"^0.5.1","uuid-token-generator":"0.5.0","vue-highlightjs":"^1.3.3","vue-infinite-scroll":"^2.0.1","vue-material":"^0.7.1","vue-material-datepicker":"^2.0.1","vue-scrollto":"^2.6.8","vue-timeago":"^3.3.3","vue-virtual-scroll-list":"^1.0.7","vue-virtual-scroller":"^0.6.1",winston:"2.3.0","winston-daily-rotate-file":"1.4.0","winston-graylog2":"0.5.2","winston-loggly-bulk":"1.4.1","winston-logsene":"1.2.1","winston-logzio":"1.0.3","winston-papertrail":"1.0.4"},devDependencies:{"apollo-client":"0.5.25",autoprefixer:"6.6.0",babel:"6.5.2","babel-core":"6.21.0","babel-loader":"6.2.10","babel-plugin-transform-runtime":"6.15.0","babel-preset-es2015":"6.18.0","babel-preset-stage-0":"6.16.0","babel-runtime":"6.20.0",chai:"3.5.0",chromedriver:"2.26.1","cross-spawn":"5.0.1","css-loader":"0.26.1",del:"2.2.2","es6-promise":"4.0.5",eslint:"3.12.2","eslint-friendly-formatter":"2.0.6","eslint-loader":"1.6.1","eslint-plugin-html":"1.7.0","extract-text-webpack-plugin":"2.0.0-beta.4","file-loader":"0.9.0","graphql-tag":"1.1.2","i18next-browser-languagedetector":"1.0.1","i18next-xhr-backend":"1.2.1",jquery:"3.1.1","json-loader":"0.5.4",marked:"0.3.6",mocha:"3.2.0",nightwatch:"0.9.11","postcss-loader":"1.2.1",precss:"1.4.0","raw-loader":"0.5.1",request:"2.79.0","sass-loader":"4.1.1","selenium-server":"3.0.1",sinon:"1.17.7","sinon-chai":"2.8.0","stats-webpack-plugin":"0.4.2","style-loader":"0.13.1",toastr:"2.1.2",typings:"2.1.0","url-loader":"0.5.7",uuid:"3.0.1",vue:"2.1.8","vue-form-generator":"2.0.0-beta1","vue-html-loader":"1.2.3","vue-loader":"10.0.2","vue-router":"2.1.1","vue-template-compiler":"2.1.8","vue-websocket":"0.2.1",vuex:"2.1.1",webpack:"v2.2.0-rc.3","webpack-dev-middleware":"1.9.0","webpack-dev-server":"2.2.0-rc.0","webpack-hot-middleware":"2.14.0","webpack-merge":"2.0.0"},snyk:!0}},function(e,t){e.exports=require("async")},function(e,t){e.exports=require("bluebird")},function(e,t){e.exports=require("connect-mongo")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("mkdirp")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("nodemailer")},function(e,t){e.exports=require("nodemailer-html-to-text")},function(e,t){e.exports=require("nodemailer-mailgun-transport")},function(e,t){e.exports=require("nodemailer-sendgrid-transport")},function(e,t){e.exports=require("object-hash")},function(e,t){e.exports=require("terminalone")},function(e,t){e.exports=require("wkx")},function(e,t,r){"use strict";(function(t){function n(e){e.locals.app=p.app,e.use(function(e,t,r){return t.locals.url=e.protocol+"://"+e.headers.host+e.url,r()}),e.locals.year=f().format("YYYY"),e.locals.features=p.features}function i(e){e.use(A({filter:function(e,t){return/json|text|javascript|css/.test(t.getHeader("Content-Type"))},level:3,threshold:512})),e.set("port",p.port),e.use(y.urlencoded({extended:!0,limit:2*p.contentMaxLength})),e.use(E()),e.use(y.json()),e.use(T()),p.isProductionMode()&&(e.use(v({cache:{max:100}})),e.use(h.static(d.join(w,"public")))),e.use("/public",h.static(d.join(w,"public"))),e.use(m(d.join(w,"public","favicon.ico"))),e.use("/node_modules",h.static(d.join(t,"../../node_modules"),{maxAge:315576e5})),e.use(g()),e.set("etag",!0),p.isDevMode()}function o(e){e.set("views",d.join(w,"views")),e.set("view engine","pug"),p.isDevMode()?(e.set("showStackError",!0),e.set("view cache",!1),e.use(N.noCache()),e.locals.pretty=!0):(e.locals.cache="memory",e.set("view cache",!0))}function s(e,t){e.use(b({saveUninitialized:!0,resave:!1,secret:p.sessions.sessionSecret,cookie:p.sessions.cookie,name:p.sessions.name}))}function a(e){e.use(N.xssFilter()),e.use(N.noSniff()),e.use(N.frameguard()),e.use(N.ieNoOpen()),e.use(I()),e.use(N.hidePoweredBy())}function u(e){r(130)(e),p.isTestMode()}function l(e){if(!p.isProductionMode()){var t=r(45),n=r(121),i=t(n),o=r(203);e.use(o(i,{noInfo:!0,publicPath:n.output.publicPath,headers:{"Access-Control-Allow-Origin":"*"},stats:{colors:!0}}));var s=r(204);e.use(s(i,{log:c.info}))}}var c=r(2),p=r(1),h=(r(32),r(35)),d=(r(67),r(7)),f=r(11),m=(r(169),r(196)),y=(r(182),r(162)),g=r(65),E=r(171),v=(r(166),r(184)),b=r(66),A=r(165),T=r(180),N=r(175),I=r(176),w=(r(69),r(64)(b),d.normalize(d.join(p.rootPath,"server")));e.exports=function(e){var t=h();n(t),i(t),o(t),a(t),s(t,e),u(t),l(t),r(16).loadServices(t,e);var c=r(33).init(t,e);return c._app=t,r(147)(t,e),c}}).call(t,"server\\core")},function(e,t,r){"use strict";var n=r(2),i=r(1),o=r(15),s=r(68);o.existsSync(i.dataFolder)||s.sync(i.dataFolder),i.isProductionMode()||(n.info("Loaded configuration:"),n.info())},function(e,t,r){"use strict";var n=(r(1),r(2)),i=r(13),o=r(11),s=r(69),a=r(129),u=function(){if(0===s.connection.readyState)return process.exit(0);s.connection.close(function(){return a.stop(function(){return n.info(),n.info(i.bold("---------------------[ Server stopped at %s Uptime: %s ]---------------------------"),o().format("YYYY-MM-DD HH:mm:ss.SSS"),o.duration(1e3*process.uptime()).humanize()),process.exit(0)})})};process.on("SIGINT",u).on("SIGTERM",u)},function(e,t,r){"use strict";var n=r(185),i=r(164),o=r(193),s=r(2);e.exports=function(){var e=i.Gauge,t=n.totalmem(),r=n.freemem(),a=t-r,u=o(r);s.info("CPU:\t\tArch: "+n.arch()+", Cores: "+n.cpus().length),s.info("Memory:\t\t"+e(a,t,20,.8*t,u+" free")),s.info("OS:\t\t"+n.platform()+" ("+n.type()+")")}},function(e,t,r){"use strict";e.exports=r(117)},function(e,t){function r(e){throw new Error("Cannot find module '"+e+"'.")}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=82},function(e,t,r){"use strict";var n=r(18);n.BelongsTo=r(19),n.HasOne=r(36),n.HasMany=r(20),n.BelongsToMany=r(25),e.exports=n},function(e,t,r){"use strict";var n=r(3),i=r(0),o=r(36),s=r(20),a=r(25),u=r(19),l=e.exports=function(){},c=function(e){return function(t,r){if(!(t instanceof this.sequelize.Model))throw new Error(this.name+"."+n.lowercaseFirst(e.toString())+" called with something that's not an instance of Sequelize.Model");var o=this;r=r||{},r.hooks=void 0!==r.hooks&&Boolean(r.hooks),r.useHooks=r.hooks;var s=new e(o,t,i.extend(r,o.options));return o.associations[s.associationAccessor]=s.injectAttributes(),s.mixin?s.mixin(o.Instance.prototype):(s.injectGetter(o.Instance.prototype),s.injectSetter(o.Instance.prototype),s.injectCreator(o.Instance.prototype)),s}};l.hasOne=c(o),l.belongsTo=c(u),l.hasMany=function(e,t){if(!(e instanceof this.sequelize.Model))throw new Error(this.name+".hasMany called with something that's not an instance of Sequelize.Model");var r=this;t=t||{},t.hooks=void 0!==t.hooks&&Boolean(t.hooks),t.useHooks=t.hooks,t=i.extend(t,i.omit(r.options,["hooks"]));var n=new s(r,e,t);return r.associations[n.associationAccessor]=n,n.injectAttributes(),n.mixin(r.Instance.prototype),n},l.belongsToMany=function(e,t){if(!(e instanceof this.sequelize.Model))throw new Error(this.name+".belongsToMany called with something that's not an instance of Sequelize.Model");var r=this;t=t||{},t.hooks=void 0!==t.hooks&&Boolean(t.hooks),t.useHooks=t.hooks,t.timestamps=void 0===t.timestamps?this.sequelize.options.timestamps:t.timestamps,t=i.extend(t,i.omit(r.options,["hooks","timestamps","scopes","defaultScope"]));var n=new a(r,e,t);return r.associations[n.associationAccessor]=n.injectAttributes(),n.injectGetter(r.Instance.prototype),n.injectSetter(r.Instance.prototype),n.injectCreator(r.Instance.prototype),n},l.getAssociation=function(e,t){for(var r in this.associations)if(this.associations.hasOwnProperty(r)){var n=this.associations[r];if(n.target.name===e.name&&(void 0===t?!n.isAliased:n.as===t))return n}return null}},function(e,t,r){"use strict";function n(){}function i(){if(!(this instanceof i))return new i}function o(){if(!(this instanceof o))return new o}function s(){if(!(this instanceof s))return new s}function a(e){if(!(this instanceof a))return new a(e);this.constraints=e}function u(e){if(!(this instanceof u))return new u(e);this.constraints=e}var l=r(8),c=e.exports={INITIALLY_DEFERRED:i,INITIALLY_IMMEDIATE:o,NOT:s,SET_DEFERRED:a,SET_IMMEDIATE:u};n.prototype.toString=function(){return this.toSql.apply(this,arguments)},l.inherits(i,n),i.prototype.toSql=function(){return"DEFERRABLE INITIALLY DEFERRED"},l.inherits(o,n),o.prototype.toSql=function(){return"DEFERRABLE INITIALLY IMMEDIATE"},l.inherits(s,n),s.prototype.toSql=function(){return"NOT DEFERRABLE"},l.inherits(a,n),a.prototype.toSql=function(e){return e.setDeferredQuery(this.constraints)},l.inherits(u,n),u.prototype.toSql=function(e){return e.setImmediateQuery(this.constraints)},Object.keys(c).forEach(function(e){var t=c[e];t.toString=function(){var e=new t;return e.toString.apply(e,arguments)}})},function(e,t,r){"use strict";var n=r(46),i=r(8),o=function(e){n.call(this,e)};i.inherits(o,n),o.prototype.name="mariadb",e.exports=o},function(e,t){function r(e){throw new Error("Cannot find module '"+e+"'.")}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=87},function(e,t,r){"use strict";var n,i=r(26),o=r(94),s=r(3),a=r(5),u=r(6),l=r(30)("mssql"),c=r(0);n=function(e,t){i.call(this,e,t),this.sequelize=t,this.sequelize.config.port=this.sequelize.config.port||1433;try{this.lib=!function(){var e=new Error('Cannot find module "."');throw e.code="MODULE_NOT_FOUND",e}()}catch(e){if("MODULE_NOT_FOUND"===e.code)throw new Error("Please install tedious package manually");throw e}},s._.extend(n.prototype,i.prototype),n.prototype.$refreshTypeParser=function(e){l.refresh(e)},n.prototype.$clearTypeParser=function(){l.clear()},n.prototype.connect=function(e){var t=this;return new a(function(r,n){var i={userName:e.username,password:e.password,server:e.host,options:{port:e.port,database:e.database}};e.dialectOptions&&(e.dialectOptions.instanceName&&delete i.options.port,e.dialectOptions.domain&&(i.domain=e.dialectOptions.domain),Object.keys(e.dialectOptions).forEach(function(t){i.options[t]=e.dialectOptions[t]}));var s=new t.lib.Connection(i),a=new o(s);s.lib=t.lib,s.on("connect",function(e){if(!e)return void r(a);if(!e.code)return void n(new u.ConnectionError(e));switch(e.code){case"ESOCKET":n(c.includes(e.message,"connect EHOSTUNREACH")?new u.HostNotReachableError(e):c.includes(e.message,"connect ECONNREFUSED")?new u.ConnectionRefusedError(e):new u.ConnectionError(e));break;case"ECONNREFUSED":n(new u.ConnectionRefusedError(e));break;case"ER_ACCESS_DENIED_ERROR":n(new u.AccessDeniedError(e));break;case"ENOTFOUND":n(new u.HostNotFoundError(e));break;case"EHOSTUNREACH":n(new u.HostNotReachableError(e));break;case"EINVAL":n(new u.InvalidConnectionError(e));break;default:n(new u.ConnectionError(e))}}),e.pool.handleDisconnects&&s.on("error",function(e){switch(e.code){case"ESOCKET":case"ECONNRESET":t.pool.destroy(a)}})})},n.prototype.disconnect=function(e){var t=e.unwrap();return t.closed?a.resolve():new a(function(e,r){t.on("end",e),t.close()})},n.prototype.validate=function(e){var t=e.unwrap();return t&&t.loggedIn},e.exports=n},function(e,t,r){"use strict";var n=r(0);e.exports=function(e){var t=e.ABSTRACT.warn.bind(void 0,"https://msdn.microsoft.com/en-us/library/ms187752%28v=sql.110%29.aspx");e.DATE.types.mssql=[42],e.STRING.types.mssql=[231,173],e.CHAR.types.mssql=[175],e.TEXT.types.mssql=!1,e.INTEGER.types.mssql=[38],e.BIGINT.types.mssql=!1,e.FLOAT.types.mssql=[109],e.TIME.types.mssql=[41],e.DATEONLY.types.mssql=[40],e.BOOLEAN.types.mssql=[104],e.BLOB.types.mssql=[165],e.DECIMAL.types.mssql=[106],e.UUID.types.mssql=!1,e.ENUM.types.mssql=!1,e.REAL.types.mssql=[109],e.DOUBLE.types.mssql=[109],e.GEOMETRY.types.mssql=!1;var r=e.BLOB.inherits();r.prototype.toSql=function(){if(this._length){if("tiny"===this._length.toLowerCase())return t("MSSQL does not support BLOB with the `length` = `tiny` option. `VARBINARY(256)` will be used instead."),"VARBINARY(256)";t("MSSQL does not support BLOB with the `length` option. `VARBINARY(MAX)` will be used instead.")}return"VARBINARY(MAX)"},r.prototype.$hexify=function(e){return"0x"+e};var i=e.STRING.inherits();i.prototype.toSql=function(){return this._binary?"BINARY("+this._length+")":"NVARCHAR("+this._length+")"},i.prototype.escape=!1,i.prototype.$stringify=function(e,t){return this._binary?r.prototype.$stringify(e):t.escape(e)};var o=e.TEXT.inherits();o.prototype.toSql=function(){if(this._length){if("tiny"===this._length.toLowerCase())return t("MSSQL does not support TEXT with the `length` = `tiny` option. `NVARCHAR(256)` will be used instead."),"NVARCHAR(256)";t("MSSQL does not support TEXT with the `length` option. `NVARCHAR(MAX)` will be used instead.")}return"NVARCHAR(MAX)"};var s=e.BOOLEAN.inherits();s.prototype.toSql=function(){return"BIT"};var a=e.UUID.inherits();a.prototype.toSql=function(){return"CHAR(36)"};var u=e.NOW.inherits();u.prototype.toSql=function(){return"GETDATE()"};var l=e.DATE.inherits();l.prototype.toSql=function(){return"DATETIME2"},l.prototype.$stringify=function(e,t){return e=this.$applyTimezone(e,t),e.format("YYYY-MM-DD HH:mm:ss.SSS")};var c=e.INTEGER.inherits(function(){if(!(this instanceof c))return new c;e.INTEGER.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("MSSQL does not support INTEGER with options. Plain `INTEGER` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)}),p=e.BIGINT.inherits(function(){if(!(this instanceof p))return new p;e.BIGINT.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("MSSQL does not support BIGINT with options. Plain `BIGINT` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)}),h=e.REAL.inherits(function(){if(!(this instanceof h))return new h;e.REAL.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("MSSQL does not support REAL with options. Plain `REAL` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)}),d=e.FLOAT.inherits(function(){if(!(this instanceof d))return new d;e.FLOAT.apply(this,arguments),this._decimals&&(t("MSSQL does not support Float with decimals. Plain `FLOAT` will be used instead."),this._length=void 0,this.options.length=void 0),this._unsigned&&(t("MSSQL does not support Float unsigned. `UNSIGNED` was removed."),this._unsigned=void 0),this._zerofill&&(t("MSSQL does not support Float zerofill. `ZEROFILL` was removed."),this._zerofill=void 0)}),f=e.ENUM.inherits();f.prototype.toSql=function(){return"VARCHAR(255)"};var m={BLOB:r,BOOLEAN:s,ENUM:f,STRING:i,UUID:a,DATE:l,NOW:u,INTEGER:c,BIGINT:p,REAL:h,FLOAT:d,TEXT:o};return n.forIn(m,function(e,t){e.key||(e.key=t),e.extend||(e.extend=function(t){return new e(t.options)})}),m}},function(e,t,r){"use strict";var n=r(0),i=r(27),o=r(88),s=r(93),a=r(91),u=r(4).mssql,l=function(e){this.sequelize=e,this.connectionManager=new o(this,e),this.connectionManager.initPools(),this.QueryGenerator=n.extend({},a,{options:e.options,_dialect:this,sequelize:e})};l.prototype.supports=n.merge(n.cloneDeep(i.prototype.supports),{DEFAULT:!0,"DEFAULT VALUES":!0,"LIMIT ON UPDATE":!0,"ORDER NULLS":!1,lock:!1,transactions:!0,migrations:!1,upserts:!0,returnValues:{output:!0},schemas:!0,autoIncrement:{identityInsert:!0,defaultValue:!1,update:!1},constraints:{restrict:!1},index:{collate:!1,length:!1,parser:!1,type:!0,using:!1},NUMERIC:!0,tmpTableTrigger:!0}),l.prototype.defaultVersion="12.0.2000",l.prototype.Query=s,l.prototype.name="mssql",l.prototype.TICK_CHAR='"',l.prototype.TICK_CHAR_LEFT="[",l.prototype.TICK_CHAR_RIGHT="]",l.prototype.DataTypes=u,e.exports=l},function(e,t,r){"use strict";function n(e){return i.addTicks(e,"'")}var i=r(3),o=r(4),s=r(28),a=r(34).randomBytes,u=r(24),l=function(e){throw new Error('The method "'+e+'" is not defined! Please add it to your sql dialect.')},c={options:{},dialect:"mssql",createSchema:function(e){return["IF NOT EXISTS (SELECT schema_name","FROM information_schema.schemata","WHERE schema_name =",n(e),")","BEGIN","EXEC sp_executesql N'CREATE SCHEMA",this.quoteIdentifier(e),";'","END;"].join(" ")},showSchemasQuery:function(){return['SELECT "name" as "schema_name" FROM sys.schemas as s','WHERE "s"."name" NOT IN (',"'INFORMATION_SCHEMA', 'dbo', 'guest', 'sys', 'archive'",")","AND",'"s"."name" NOT LIKE',"'db_%'"].join(" ")},versionQuery:function(){return["DECLARE @ms_ver NVARCHAR(20);","SET @ms_ver = REVERSE(CONVERT(NVARCHAR(20), SERVERPROPERTY('ProductVersion')));","SELECT REVERSE(SUBSTRING(@ms_ver, CHARINDEX('.', @ms_ver)+1, 20)) AS 'version'"].join(" ")},createTableQuery:function(e,t,r){var n="IF OBJECT_ID('<%= table %>', 'U') IS NULL CREATE TABLE <%= table %> (<%= attributes %>)",o=[],s={},a=[],u=this;for(var l in t)if(t.hasOwnProperty(l)){var c,p=t[l];i._.includes(p,"PRIMARY KEY")?(o.push(l),i._.includes(p,"REFERENCES")?(c=p.match(/^(.+) (REFERENCES.*)$/),a.push(this.quoteIdentifier(l)+" "+c[1].replace(/PRIMARY KEY/,"")),s[l]=c[2]):a.push(this.quoteIdentifier(l)+" "+p.replace(/PRIMARY KEY/,""))):i._.includes(p,"REFERENCES")?(c=p.match(/^(.+) (REFERENCES.*)$/),a.push(this.quoteIdentifier(l)+" "+c[1]),s[l]=c[2]):a.push(this.quoteIdentifier(l)+" "+p)}var h={table:this.quoteTable(e),attributes:a.join(", ")},d=o.map(function(e){return this.quoteIdentifier(e)}.bind(this)).join(", ");r.uniqueKeys&&i._.each(r.uniqueKeys,function(t,r){i._.isString(r)||(r="uniq_"+e+"_"+t.fields.join("_")),h.attributes+=", CONSTRAINT "+u.quoteIdentifier(r)+" UNIQUE ("+i._.map(t.fields,u.quoteIdentifier).join(", ")+")"}),d.length>0&&(h.attributes+=", PRIMARY KEY ("+d+")");for(var f in s)s.hasOwnProperty(f)&&(h.attributes+=", FOREIGN KEY ("+this.quoteIdentifier(f)+") "+s[f]);return i._.template(n)(h).trim()+";"},describeTableQuery:function(e,t){var r=["SELECT","c.COLUMN_NAME AS 'Name',","c.DATA_TYPE AS 'Type',","c.CHARACTER_MAXIMUM_LENGTH AS 'Length',","c.IS_NULLABLE as 'IsNull',","COLUMN_DEFAULT AS 'Default',","tc.CONSTRAINT_TYPE AS 'Constraint'","FROM","INFORMATION_SCHEMA.TABLES t","INNER JOIN","INFORMATION_SCHEMA.COLUMNS c ON t.TABLE_NAME = c.TABLE_NAME AND t.TABLE_SCHEMA = c.TABLE_SCHEMA","LEFT JOIN","INFORMATION_SCHEMA.KEY_COLUMN_USAGE cu ON t.TABLE_NAME = cu.TABLE_NAME AND cu.COLUMN_NAME = c.COLUMN_NAME AND t.TABLE_SCHEMA = cu.TABLE_SCHEMA","LEFT JOIN","INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc ON t.TABLE_NAME = tc.TABLE_NAME AND cu.COLUMN_NAME = c.COLUMN_NAME AND tc.CONSTRAINT_TYPE = 'PRIMARY KEY'","WHERE t.TABLE_NAME =",n(e)].join(" ");return t&&(r+="AND t.TABLE_SCHEMA ="+n(t)),r},renameTableQuery:function(e,t){return i._.template("EXEC sp_rename <%= before %>, <%= after %>;")({before:this.quoteTable(e),after:this.quoteTable(t)})},showTablesQuery:function(){return"SELECT TABLE_NAME, TABLE_SCHEMA FROM INFORMATION_SCHEMA.TABLES;"},dropTableQuery:function(e){var t={table:this.quoteTable(e)};return i._.template("IF OBJECT_ID('<%= table %>', 'U') IS NOT NULL DROP TABLE <%= table %>")(t).trim()+";"},addColumnQuery:function(e,t,r){r.field=t;var n=i._.template("<%= key %> <%= definition %>")({key:this.quoteIdentifier(t),definition:this.attributeToSQL(r,{context:"addColumn"})});return i._.template("ALTER TABLE <%= table %> ADD <%= attribute %>;")({table:this.quoteTable(e),attribute:n})},removeColumnQuery:function(e,t){return i._.template("ALTER TABLE <%= tableName %> DROP COLUMN <%= attributeName %>;")({tableName:this.quoteTable(e),attributeName:this.quoteIdentifier(t)})},changeColumnQuery:function(e,t){var r="ALTER TABLE <%= tableName %> <%= query %>;",n=[],o=[];for(var s in t){var a=t[s];a.match(/REFERENCES/)?o.push(i._.template("<%= fkName %> FOREIGN KEY (<%= attrName %>) <%= definition %>")({fkName:this.quoteIdentifier(s+"_foreign_idx"),attrName:this.quoteIdentifier(s),definition:a.replace(/.+?(?=REFERENCES)/,"")})):n.push(i._.template("<%= attrName %> <%= definition %>")({attrName:this.quoteIdentifier(s),definition:a}))}var u="";return n.length&&(u+="ALTER COLUMN "+n.join(", "),u+=o.length?" ":""),o.length&&(u+="ADD CONSTRAINT "+o.join(", ")),i._.template(r)({tableName:this.quoteTable(e),query:u})},renameColumnQuery:function(e,t,r){var n=Object.keys(r)[0];return i._.template("EXEC sp_rename '<%= tableName %>.<%= before %>', '<%= after %>', 'COLUMN';")({tableName:this.quoteTable(e),before:t,after:n})},bulkInsertQuery:function(e,t,r,n){r=r||{},n=n||{};var o,s="INSERT INTO <%= table %> (<%= attributes %>)<%= output %> VALUES <%= tuples %>;",a="INSERT INTO <%= table %><%= output %> DEFAULT VALUES",u=[],l=[],c=!1,p=[];r.returning&&(o=" OUTPUT INSERTED.*"),i._.forEach(t,function(e){var t=Object.keys(e),r=n[t[0]];if(1===t.length&&r&&r.autoIncrement&&null===e[t[0]])return void p.push(a);i._.forOwn(e,function(e,t){if(null!==e&&n[t]&&n[t].autoIncrement&&(c=!0),-1===l.indexOf(t)){if(null===e&&n[t].autoIncrement)return;l.push(t)}})}),l.length>0&&(i._.forEach(t,function(e){u.push("("+l.map(function(t){return this.escape(e[t])}.bind(this)).join(",")+")")}.bind(this)),p.push(s));var h={table:this.quoteTable(e),attributes:l.map(function(e){return this.quoteIdentifier(e)}.bind(this)).join(","),tuples:u,output:o},d=i._.template(p.join(";"))(h);return c&&(d=["SET IDENTITY_INSERT",this.quoteTable(e),"ON;",d,"SET IDENTITY_INSERT",this.quoteTable(e),"OFF;"].join(" ")),d},upsertQuery:function(e,t,r,n,o,s){var a="MERGE INTO <%= tableNameQuoted %> WITH(HOLDLOCK) AS <%= targetTableAlias %> USING (<%= sourceTableQuery %>) AS <%= sourceTableAlias%>(<%=insertKeysQuoted%>) ON <%= joinCondition %>";a+=" WHEN MATCHED THEN UPDATE SET <%= updateSnippet %> WHEN NOT MATCHED THEN INSERT <%= insertSnippet %> OUTPUT $action, INSERTED.*;";var u,l=this.quoteTable(e+"_target"),c=this.quoteTable(e+"_source"),p=[],h=[],d=[],f=this.quoteTable(e),m=!1;for(var y in o)o[y].primaryKey&&p.push(o[y].field||y),o[y].unique&&d.push(o[y].field||y),o[y].autoIncrement&&h.push(o[y].field||y);var g=Object.keys(r),E=Object.keys(t),v=i._.map(E,function(e){return this.quoteIdentifier(e)}.bind(this)).join(", "),b=i._.map(E,function(e){return this.escape(t[e])}.bind(this)).join(", "),A="VALUES("+b+")";h.forEach(function(e){r[e]&&null!==r[e]&&(m=!0)});var T=n.$or.filter(function(e){var t=!0;for(var r in e)if(!e[r]){t=!1;break}return t}),N=function(e){return i._.map(e,function(e){return e=this.quoteIdentifier(e),l+"."+e+" = "+c+"."+e}.bind(this))};if(0===T.length)throw new Error("Primary Key or Unique key should be passed to upsert query");for(y in T){var I=Object.keys(T[y]);if(-1!==p.indexOf(I[0])){u=N.bind(this)(p).join(" AND ");break}}u||(u=N.bind(this)(d).join(" AND "));var w=g.filter(function(e){return-1===h.indexOf(e)});w=i._.map(w,function(e){var t=this.escape(r[e]);return e=this.quoteIdentifier(e),l+"."+e+" = "+t}.bind(this)).join(", ");var O="("+v+") VALUES("+b+")",_={tableNameQuoted:f,targetTableAlias:l,sourceTableQuery:A,sourceTableAlias:c,insertKeysQuoted:v,joinCondition:u,updateSnippet:w,insertSnippet:O};return a=i._.template(a)(_),m&&(a=["SET IDENTITY_INSERT",this.quoteTable(e),"ON;",a,"SET IDENTITY_INSERT",this.quoteTable(e),"OFF;"].join(" ")),a},deleteQuery:function(e,t,r){r=r||{};var n=this.quoteTable(e);if(!0===r.truncate)return"TRUNCATE TABLE "+n;t=this.getWhereConditions(t);var o="",s="DELETE<%= limit %> FROM <%= table %><%= where %>; SELECT @@ROWCOUNT AS AFFECTEDROWS;";i._.isUndefined(r.limit)&&(r.limit=1),r.limit&&(o=" TOP("+this.escape(r.limit)+")");var a={limit:o,table:n,where:t};return a.where&&(a.where=" WHERE "+a.where),i._.template(s)(a)},showIndexesQuery:function(e){return i._.template("EXEC sys.sp_helpindex @objname = N'<%= tableName %>';")({tableName:this.quoteTable(e)})},removeIndexQuery:function(e,t){var r="DROP INDEX <%= indexName %> ON <%= tableName %>",n=t;"string"!=typeof n&&(n=i.inflection.underscore(e+"_"+t.join("_")));var o={tableName:this.quoteIdentifiers(e),indexName:n};return i._.template(r)(o)},attributeToSQL:function(e){i._.isPlainObject(e)||(e={type:e}),e.references&&(e=i.formatReferences(e),e.Model&&e.Model.tableName===e.references.model&&(this.sequelize.log("MSSQL does not support self referencial constraints, we will remove it but we recommend restructuring your query"),e.onDelete="",e.onUpdate=""));var t;return e.type instanceof o.ENUM?(e.type.values&&!e.values&&(e.values=e.type.values),t=e.type.toSql(),t+=" CHECK ("+e.field+" IN("+i._.map(e.values,function(e){return this.escape(e)}.bind(this)).join(", ")+"))"):(t=e.type.toString(),!1===e.allowNull?t+=" NOT NULL":e.primaryKey||i.defaultValueSchemable(e.defaultValue)||(t+=" NULL"),e.autoIncrement&&(t+=" IDENTITY(1,1)"),"TEXT"!==e.type&&!0!==e.type._binary&&i.defaultValueSchemable(e.defaultValue)&&(t+=" DEFAULT "+this.escape(e.defaultValue)),!0===e.unique&&(t+=" UNIQUE"),e.primaryKey&&(t+=" PRIMARY KEY"),e.references&&(t+=" REFERENCES "+this.quoteTable(e.references.model),e.references.key?t+=" ("+this.quoteIdentifier(e.references.key)+")":t+=" ("+this.quoteIdentifier("id")+")",e.onDelete&&(t+=" ON DELETE "+e.onDelete.toUpperCase()),e.onUpdate&&(t+=" ON UPDATE "+e.onUpdate.toUpperCase())),t)},attributesToSQL:function(e,t){var r,n,o={},s=[];for(r in e)n=e[r],n.references&&(n=i.formatReferences(e[r]),-1!==s.indexOf(n.references.model.toString())?(n.onDelete="",n.onUpdate=""):(s.push(n.references.model.toString()),n.onUpdate="")),r&&!n.field&&(n.field=r),o[n.field||r]=this.attributeToSQL(n,t);return o},findAutoIncrementField:function(e){var t=[];for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)){var n=e.attributes[r];n&&n.autoIncrement&&t.push(r)}return t},createTrigger:function(){l("createTrigger")},dropTrigger:function(){l("dropTrigger")},renameTrigger:function(){l("renameTrigger")},createFunction:function(){l("createFunction")},dropFunction:function(){l("dropFunction")},renameFunction:function(){l("renameFunction")},quoteIdentifier:function(e,t){return"*"===e?e:"["+e.replace(/[\[\]']+/g,"")+"]"},getForeignKeysQuery:function(e){var t=e.tableName||e,r=["SELECT","constraint_name = C.CONSTRAINT_NAME","FROM","INFORMATION_SCHEMA.TABLE_CONSTRAINTS C","WHERE C.CONSTRAINT_TYPE = 'FOREIGN KEY'","AND C.TABLE_NAME =",n(t)].join(" ");return e.schema&&(r+=" AND C.TABLE_SCHEMA ="+n(e.schema)),r},getForeignKeyQuery:function(e,t){var r=e.tableName||e,i=["SELECT","constraint_name = TC.CONSTRAINT_NAME","FROM","INFORMATION_SCHEMA.TABLE_CONSTRAINTS TC","JOIN INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE CCU","ON TC.CONSTRAINT_NAME = CCU.CONSTRAINT_NAME","WHERE TC.CONSTRAINT_TYPE = 'FOREIGN KEY'","AND TC.TABLE_NAME =",n(r),"AND CCU.COLUMN_NAME =",n(t)].join(" ");return e.schema&&(i+=" AND TC.TABLE_SCHEMA ="+n(e.schema)),i},getPrimaryKeyConstraintQuery:function(e,t){var r=n(e.tableName||e);return["SELECT K.TABLE_NAME AS tableName,","K.COLUMN_NAME AS columnName,","K.CONSTRAINT_NAME AS constraintName","FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C","JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K","ON C.TABLE_NAME = K.TABLE_NAME","AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG","AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA","AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME","WHERE C.CONSTRAINT_TYPE = 'PRIMARY KEY'","AND K.COLUMN_NAME =",n(t),"AND K.TABLE_NAME =",r+";"].join(" ")},dropForeignKeyQuery:function(e,t){return i._.template("ALTER TABLE <%= table %> DROP <%= key %>")({table:this.quoteTable(e),key:this.quoteIdentifier(t)})},getDefaultConstraintQuery:function(e,t){return i._.template("SELECT name FROM SYS.DEFAULT_CONSTRAINTS WHERE PARENT_OBJECT_ID = OBJECT_ID('<%= table %>', 'U') AND PARENT_COLUMN_ID = (SELECT column_id FROM sys.columns WHERE NAME = ('<%= column %>') AND object_id = OBJECT_ID('<%= table %>', 'U'));")({table:this.quoteTable(e),column:t})},dropConstraintQuery:function(e,t){return i._.template("ALTER TABLE <%= table %> DROP CONSTRAINT <%= constraint %>;")({table:this.quoteTable(e),constraint:this.quoteIdentifier(t)})},setAutocommitQuery:function(e){return""},setIsolationLevelQuery:function(e,t){if(!t.parent)return"SET TRANSACTION ISOLATION LEVEL "+e+";"},generateTransactionId:function(){return a(10).toString("hex")},startTransactionQuery:function(e,t){return e.parent?"SAVE TRANSACTION "+this.quoteIdentifier(e.name)+";":"BEGIN TRANSACTION;"},commitTransactionQuery:function(e){if(!e.parent)return"COMMIT TRANSACTION;"},rollbackTransactionQuery:function(e,t){return e.parent?"ROLLBACK TRANSACTION "+this.quoteIdentifier(e.name)+";":"ROLLBACK TRANSACTION;"},selectFromTableFragment:function(e,t,r,n,i,o){var s="",a="SELECT "+r.join(", ")+" FROM "+n;if(u.valid(this.sequelize.options.databaseVersion)&&u.lt(this.sequelize.options.databaseVersion,"11.0.0")){if(e.limit&&(s="TOP "+e.limit+" "),e.offset){var l=e.offset||0,c=e.hasIncludeWhere||e.hasIncludeRequired||e.hasMultiAssociation,p={mainQueryOrder:[]};e.order&&(p=this.getQueryOrders(e,t,c)),p.mainQueryOrder.length||p.mainQueryOrder.push(this.quoteIdentifier(t.primaryKeyField));var h=i||"OffsetTable",d=o?" WHERE "+o:"";return"SELECT TOP 100 PERCENT "+r.join(", ")+" FROM (SELECT "+s+"* FROM (SELECT ROW_NUMBER() OVER (ORDER BY "+p.mainQueryOrder.join(", ")+") as row_num, *  FROM "+n+" AS "+h+d+") AS "+h+" WHERE row_num > "+l+") AS "+h}a="SELECT "+s+r.join(", ")+" FROM "+n}return i&&(a+=" AS "+i),a},addLimitAndOffset:function(e,t){if(u.valid(this.sequelize.options.databaseVersion)&&u.lt(this.sequelize.options.databaseVersion,"11.0.0"))return"";var r="",n=e.offset||0,i=e.hasIncludeWhere||e.hasIncludeRequired||e.hasMultiAssociation,o={};return e.order&&(o=this.getQueryOrders(e,t,i)),(e.limit||e.offset)&&((!e.order||e.include&&!o.subQueryOrder.length)&&(r+=e.order&&!i?", ":" ORDER BY ",r+=this.quoteIdentifier(t.primaryKeyField)),(e.offset||e.limit)&&(r+=" OFFSET "+this.escape(n)+" ROWS"),e.limit&&(r+=" FETCH NEXT "+this.escape(e.limit)+" ROWS ONLY")),r},booleanValue:function(e){return e?1:0}};e.exports=i._.extend(i._.clone(s),c)},function(e,t,r){"use strict";var n=function(e,t,r){var n=this;r=r||{};var i=n.QueryGenerator.getDefaultConstraintQuery(e,t);return n.sequelize.query(i,{raw:!0,logging:r.logging}).spread(function(t){if(t.length){var i=n.QueryGenerator.dropConstraintQuery(e,t[0].name);return n.sequelize.query(i,{raw:!0,logging:r.logging})}}).then(function(){var i=n.QueryGenerator.getForeignKeyQuery(e,t);return n.sequelize.query(i,{raw:!0,logging:r.logging})}).spread(function(t){if(t.length){var i=n.QueryGenerator.dropForeignKeyQuery(e,t[0].constraint_name);return n.sequelize.query(i,{raw:!0,logging:r.logging})}}).then(function(){var i=n.QueryGenerator.getPrimaryKeyConstraintQuery(e,t);return n.sequelize.query(i,{raw:!0,logging:r.logging})}).spread(function(t){if(t.length){var i=n.QueryGenerator.dropConstraintQuery(e,t[0].constraintName);return n.sequelize.query(i,{raw:!0,logging:r.logging})}}).then(function(){var i=n.QueryGenerator.removeColumnQuery(e,t);return n.sequelize.query(i,{raw:!0,logging:r.logging})})};e.exports={removeColumn:n}},function(e,t,r){"use strict";var n=r(3),i=r(5),o=r(29),s=r(6),a=r(30)("mssql"),u=r(0),l=function(e,t,r){this.connection=e,this.instance=r.instance,this.model=r.model,this.sequelize=t,this.options=n._.extend({logging:console.log,plain:!1,raw:!1},r||{}),this.checkLoggingOption()};n.inherit(l,o),l.prototype.getInsertIdField=function(){return"id"},l.formatBindParameters=o.formatBindParameters,l.prototype._run=function(e,t,r){var i=this;this.sql=t;var o=this.sequelize.options.benchmark||this.options.benchmark;if(o)var s=Date.now();else this.sequelize.log("Executing ("+(i.connection.uuid||"default")+"): "+this.sql,this.options);return new n.Promise(function(r,n){if(u.startsWith(i.sql,"BEGIN TRANSACTION"))e.beginTransaction(function(e){e?n(i.formatError(e)):r(i.formatResults())},i.options.transaction.name);else if(u.startsWith(i.sql,"COMMIT TRANSACTION"))e.commitTransaction(function(e){e?n(i.formatError(e)):r(i.formatResults())});else if(u.startsWith(i.sql,"ROLLBACK TRANSACTION"))e.rollbackTransaction(function(e){e?n(i.formatError(e)):r(i.formatResults())},i.options.transaction.name);else if(u.startsWith(i.sql,"SAVE TRANSACTION"))e.saveTransaction(function(e){e?n(i.formatError(e)):r(i.formatResults())},i.options.transaction.name);else{var l=[],c=new e.lib.Request(i.sql,function(e){o&&i.sequelize.log("Executed ("+(i.connection.uuid||"default")+"): "+i.sql,Date.now()-s,i.options),e?(e.sql=t,n(i.formatError(e))):r(i.formatResults(l))});c.on("row",function(e){var t={};e.forEach(function(e){var r=e.metadata.type.id,n=e.value,i=a.get(r);null!==n&!!i&&(n=i(n)),t[e.metadata.colName]=n}),l.push(t)}),e.execSql(c)}})},l.prototype.run=function(e,t){var r=this;return i.using(this.connection.lock(),function(n){return r._run(n,e,t)})},l.prototype.formatResults=function(e){var t=this.instance;if(this.isInsertQuery(e)&&(this.handleInsertQuery(e),!this.instance))if(this.options.plain){var r=e[0];t=r[Object.keys(r)[0]]}else t=e;return this.isShowTablesQuery()?t=this.handleShowTablesQuery(e):this.isDescribeQuery()?(t={},e.forEach(function(e){e.Default&&(e.Default=e.Default.replace("('","").replace("')","").replace(/'/g,"")),t[e.Name]={type:e.Type.toUpperCase(),allowNull:"YES"===e.IsNull,defaultValue:e.Default,primaryKey:"PRIMARY KEY"===e.Constraint}})):this.isShowIndexesQuery()?t=this.handleShowIndexesQuery(e):this.isSelectQuery()?t=this.handleSelectQuery(e):this.isUpsertQuery()?t="INSERT"===e[0].$action?1:2:this.isCallQuery()?t=e[0]:this.isBulkUpdateQuery()?t=e.length:this.isBulkDeleteQuery()?t=e[0]&&e[0].AFFECTEDROWS:this.isVersionQuery()?t=e[0].version:this.isForeignKeysQuery()?t=e:this.isRawQuery()&&(t=[e,e]),t},l.prototype.handleShowTablesQuery=function(e){return e.map(function(e){return{tableName:e.TABLE_NAME,schema:e.TABLE_SCHEMA}})},l.prototype.formatError=function(e){var t;if(t=e.message.match(/Violation of UNIQUE KEY constraint '((.|\s)*)'. Cannot insert duplicate key in object '.*'.(:? The duplicate key value is \((.*)\).)?/),(t=t||e.message.match(/Cannot insert duplicate key row in object .* with unique index '(.*)'/))&&t.length>1){var r={},i="Validation error",o=this.model&&this.model.uniqueKeys[t[1]];if(o&&o.msg&&(i=o.msg),t[2]){var a=t[2].split(",").map(Function.prototype.call,String.prototype.trim);o?r=n._.zipObject(o.fields,a):r[t[1]]=t[2]}var u=[],l=this;return n._.forOwn(r,function(e,t){u.push(new s.ValidationErrorItem(l.getUniqueConstraintErrorMessage(t),"unique violation",t,e))}),new s.UniqueConstraintError({message:i,errors:u,parent:e,fields:r})}return t=e.message.match(/Failed on step '(.*)'.Could not create constraint. See previous errors./)||e.message.match(/The DELETE statement conflicted with the REFERENCE constraint "(.*)". The conflict occurred in database "(.*)", table "(.*)", column '(.*)'./)||e.message.match(/The INSERT statement conflicted with the FOREIGN KEY constraint "(.*)". The conflict occurred in database "(.*)", table "(.*)", column '(.*)'./)||e.message.match(/The UPDATE statement conflicted with the FOREIGN KEY constraint "(.*)". The conflict occurred in database "(.*)", table "(.*)", column '(.*)'./),t&&t.length>0?new s.ForeignKeyConstraintError({fields:null,index:t[1],parent:e}):new s.DatabaseError(e)},l.prototype.isShowOrDescribeQuery=function(){var e=!1;return e=e||0===this.sql.toLowerCase().indexOf("select c.column_name as 'name', c.data_type as 'type', c.is_nullable as 'isnull'"),e=e||0===this.sql.toLowerCase().indexOf("select tablename = t.name, name = ind.name,"),e=e||0===this.sql.toLowerCase().indexOf("exec sys.sp_helpindex @objname")},l.prototype.isShowIndexesQuery=function(){return 0===this.sql.toLowerCase().indexOf("exec sys.sp_helpindex @objname")},l.prototype.handleShowIndexesQuery=function(e){return e=u.reduce(e,function(e,t){return t.index_name in e||(e[t.index_name]=t,t.fields=[]),n._.forEach(t.index_keys.split(","),function(r){var n=r.trim();-1!==n.indexOf("(-)")&&(n=n.replace("(-)","")),e[t.index_name].fields.push({attribute:n,length:void 0,order:-1!==r.indexOf("(-)")?"DESC":"ASC",collate:void 0})}),delete t.index_keys,e},{}),n._.map(e,function(e){return{primary:0===e.index_name.toLowerCase().indexOf("pk"),fields:e.fields,name:e.index_name,tableName:void 0,unique:-1!==e.index_description.toLowerCase().indexOf("unique"),type:void 0}})},l.prototype.handleInsertQuery=function(e,t){if(this.instance){var r=this.model.autoIncrementField,n=null,i=null;this.model.rawAttributes.hasOwnProperty(r)&&void 0!==this.model.rawAttributes[r].field&&(n=this.model.rawAttributes[r].field),i=i||e&&e[0][this.getInsertIdField()],i=i||t&&t[this.getInsertIdField()],i=i||e&&e[0][r],i=i||n&&e&&e[0][n],this.instance[r]=i}},e.exports=l},function(e,t,r){"use strict";function n(e){this.resource=e,this.previous=i.resolve(e)}var i=r(5);n.prototype.unwrap=function(){return this.resource},n.prototype.lock=function(){var e,t=this.previous;return this.previous=new i(function(t){e=t}),t.disposer(e)},e.exports=n},function(e,t){function r(e){throw new Error("Cannot find module '"+e+"'.")}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=95},function(e,t,r){"use strict";var n,i=r(26),o=r(3),s=r(5),a=r(6),u=r(4).mysql,l={};n=function(e,t){i.call(this,e,t),this.sequelize=t,this.sequelize.config.port=this.sequelize.config.port||3306;try{t.config.dialectModulePath?this.lib=!function(){var e=new Error('Cannot find module "."');throw e.code="MODULE_NOT_FOUND",e}():this.lib=r(183)}catch(e){if("MODULE_NOT_FOUND"===e.code)throw new Error("Please install mysql package manually");throw e}this.refreshTypeParser(u)},o._.extend(n.prototype,i.prototype),n.prototype.$refreshTypeParser=function(e){e.types.mysql.forEach(function(t){l[t]=e.parse})},n.prototype.$clearTypeParser=function(){l={}},n.$typecast=function(e,t){return l[e.type]?l[e.type](e,this.sequelize.options):t()},n.prototype.connect=function(e){var t=this;return new s(function(r,i){var o={host:e.host,port:e.port,user:e.username,flags:"-FOUND_ROWS",password:e.password,database:e.database,timezone:t.sequelize.options.timezone,typeCast:n.$typecast.bind(t)};e.dialectOptions&&Object.keys(e.dialectOptions).forEach(function(t){o[t]=e.dialectOptions[t]});var s=t.lib.createConnection(o);s.connect(function(n){if(n)if(n.code)switch(n.code){case"ECONNREFUSED":i(new a.ConnectionRefusedError(n));break;case"ER_ACCESS_DENIED_ERROR":i(new a.AccessDeniedError(n));break;case"ENOTFOUND":i(new a.HostNotFoundError(n));break;case"EHOSTUNREACH":i(new a.HostNotReachableError(n));break;case"EINVAL":i(new a.InvalidConnectionError(n));break;default:i(new a.ConnectionError(n))}else i(new a.ConnectionError(n));else e.pool.handleDisconnects&&s.on("error",function(e){"PROTOCOL_CONNECTION_LOST"===e.code&&t.pool.destroy(s)}),r(s)})}).tap(function(e){e.query("SET time_zone = '"+t.sequelize.options.timezone+"'")})},n.prototype.disconnect=function(e){return e._protocol._ended?s.resolve():new s(function(t,r){e.end(function(e){if(e)return r(new a.ConnectionError(e));t()})})},n.prototype.validate=function(e){return e&&-1===["disconnected","protocol_error"].indexOf(e.state)},e.exports=n},function(e,t,r){"use strict";var n=r(76),i=r(0),o=r(42);e.exports=function(e){e.ABSTRACT.prototype.dialectTypes="https://dev.mysql.com/doc/refman/5.7/en/data-types.html",e.DATE.types.mysql=["DATETIME"],e.STRING.types.mysql=["VAR_STRING"],e.CHAR.types.mysql=["STRING"],e.TEXT.types.mysql=["BLOB"],e.INTEGER.types.mysql=["LONG"],e.BIGINT.types.mysql=["LONGLONG"],e.FLOAT.types.mysql=["FLOAT"],e.TIME.types.mysql=["TIME"],e.DATEONLY.types.mysql=["DATE"],e.BOOLEAN.types.mysql=["TINY"],e.BLOB.types.mysql=["TINYBLOB","BLOB","LONGBLOB"],e.DECIMAL.types.mysql=["NEWDECIMAL"],e.UUID.types.mysql=!1,e.ENUM.types.mysql=!1,e.REAL.types.mysql=["DOUBLE"],e.DOUBLE.types.mysql=["DOUBLE"];var t=e.DATE.inherits();t.prototype.toSql=function(){return"DATETIME"+(this._length?"("+this._length+")":"")},t.prototype.$stringify=function(t,r){return t=e.DATE.prototype.$applyTimezone(t,r),this._length?t.format("YYYY-MM-DD HH:mm:ss.SSS"):t.format("YYYY-MM-DD HH:mm:ss")},t.parse=function(e,t){return null===(e=e.string())?e:e=o.tz.zone(t.timezone)?o.tz(e,t.timezone).toDate():new Date(e+" "+t.timezone)};var r=e.UUID.inherits();r.prototype.toSql=function(){return"CHAR(36) BINARY"};var s=["POINT","LINESTRING","POLYGON"],a=e.GEOMETRY.inherits(function(){if(!(this instanceof a))return new a;if(e.GEOMETRY.apply(this,arguments),i.isEmpty(this.type))this.sqlType=this.key;else{if(!i.includes(s,this.type))throw new Error("Supported geometry types are: "+s.join(", "));this.sqlType=this.type}});a.parse=a.prototype.parse=function(e){return null===(e=e.buffer())?null:(e=e.slice(4),n.Geometry.parse(e).toGeoJSON())},a.prototype.toSql=function(){return this.sqlType};var u=e.ENUM.inherits();u.prototype.toSql=function(e){return"ENUM("+i.map(this.values,function(t){return e.escape(t)}).join(", ")+")"},e.GEOMETRY.types.mysql=["GEOMETRY"];var l={ENUM:u,DATE:t,UUID:r,GEOMETRY:a};return i.forIn(l,function(e,t){e.key||(e.key=t),e.extend||(e.extend=function(t){return new e(t.options)})}),l}},function(e,t,r){"use strict";var n=r(0),i=function(e,t,r){var i=this;return r=r||{},i.sequelize.query(i.QueryGenerator.getForeignKeyQuery(e,t),n.assign({raw:!0},r)).spread(function(t){if(t.length&&"PRIMARY"!==t[0].constraint_name)return i.sequelize.query(i.QueryGenerator.dropForeignKeyQuery(e,t[0].constraint_name),n.assign({raw:!0},r))}).then(function(){return i.sequelize.query(i.QueryGenerator.removeColumnQuery(e,t),n.assign({raw:!0},r))})};e.exports={removeColumn:i}},function(e,t,r){"use strict";var n=r(3),i=r(29),o=r(43),s=r(6),a=r(0),u=function(e,t,r){this.connection=e,this.instance=r.instance,this.model=r.model,this.sequelize=t,this.uuid=o.v4(),this.options=n._.extend({logging:console.log,plain:!1,raw:!1},r||{}),this.checkLoggingOption()};n.inherit(u,i),u.formatBindParameters=i.formatBindParameters,u.prototype.run=function(e,t){var r=this;this.sql=e;var i=this.sequelize.options.benchmark||this.options.benchmark;if(i)var o=Date.now();else this.sequelize.log("Executing ("+(this.connection.uuid||"default")+"): "+this.sql,this.options);return new n.Promise(function(t,n){r.connection.query(r.sql,function(s,a){i&&r.sequelize.log("Executed ("+(r.connection.uuid||"default")+"): "+r.sql,Date.now()-o,r.options),s?(s.sql=e,n(r.formatError(s))):t(r.formatResults(a))}).setMaxListeners(100)})},u.prototype.formatResults=function(e){var t=this.instance;return this.isInsertQuery(e)&&(this.handleInsertQuery(e),this.instance||(t=e[this.getInsertIdField()])),this.isSelectQuery()?t=this.handleSelectQuery(e):this.isShowTablesQuery()?t=this.handleShowTablesQuery(e):this.isDescribeQuery()?(t={},e.forEach(function(e){var r=/^enum/i;t[e.Field]={type:r.test(e.Type)?e.Type.replace(r,"ENUM"):e.Type.toUpperCase(),allowNull:"YES"===e.Null,defaultValue:e.Default,primaryKey:"PRI"===e.Key}})):this.isShowIndexesQuery()?t=this.handleShowIndexesQuery(e):this.isCallQuery()?t=e[0]:this.isBulkUpdateQuery()||this.isBulkDeleteQuery()||this.isUpsertQuery()?t=e.affectedRows:this.isVersionQuery()?t=e[0].version:this.isForeignKeysQuery()?t=e:this.isRawQuery()&&(t=[e,e]),t},u.prototype.formatError=function(e){var t;switch(e.errno||e.code){case 1062:t=e.message.match(/Duplicate entry '(.*)' for key '?((.|\s)*?)'?$/);var r=t?t[1].split("-"):void 0,i={},o="Validation error",a=this.model&&this.model.uniqueKeys[t[2]];a?(a.msg&&(o=a.msg),i=n._.zipObject(a.fields,r)):i[t[2]]=t[1];var u=[],l=this;return n._.forOwn(i,function(e,t){u.push(new s.ValidationErrorItem(l.getUniqueConstraintErrorMessage(t),"unique violation",t,e))}),new s.UniqueConstraintError({message:o,errors:u,parent:e,fields:i});case 1451:return t=e.message.match(/FOREIGN KEY \(`(.*)`\) REFERENCES `(.*)` \(`(.*)`\)(?: ON .*)?\)$/),new s.ForeignKeyConstraintError({fields:null,index:t?t[3]:void 0,parent:e});case 1452:return t=e.message.match(/FOREIGN KEY \(`(.*)`\) REFERENCES `(.*)` \(`(.*)`\)(.*)\)$/),new s.ForeignKeyConstraintError({fields:null,index:t?t[1]:void 0,parent:e});default:return new s.DatabaseError(e)}},u.prototype.handleShowIndexesQuery=function(e){return e=a.reduce(e,function(e,t){return t.Key_name in e||(e[t.Key_name]=t,t.fields=[]),e[t.Key_name].fields[t.Seq_in_index-1]={attribute:t.Column_name,length:t.Sub_part||void 0,order:"A"===t.Collation?"ASC":void 0},delete t.column_name,e},{}),n._.map(e,function(e){return{primary:"PRIMARY"===e.Key_name,fields:e.fields,name:e.Key_name,tableName:e.Table,unique:1!==e.Non_unique,type:e.Index_type}})},e.exports=u},function(e,t){function r(e){throw new Error("Cannot find module '"+e+"'.")}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=100},function(e,t,r){"use strict";var n,i=r(26),o=r(3),s=r(5),a=r(6),u=r(24),l=r(4),c=r(42);n=function(e,t){i.call(this,e,t),this.sequelize=t,this.sequelize.config.port=this.sequelize.config.port||5432;try{var n;n=t.config.dialectModulePath?!function(){var e=new Error('Cannot find module "."');throw e.code="MODULE_NOT_FOUND",e}():r(192),this.lib=t.config.native?n.native:n}catch(e){if("MODULE_NOT_FOUND"===e.code)throw new Error("Please install '"+(t.config.dialectModulePath||"pg")+"' module manually");throw e}this.refreshTypeParser(l.postgres)},o._.extend(n.prototype,i.prototype),n.prototype.$refreshTypeParser=function(e){var t=this;e.types.postgres.oids&&e.types.postgres.oids.forEach(function(r){t.lib.types.setTypeParser(r,function(n){return e.parse(n,r,t.lib.types.getTypeParser)})}),e.types.postgres.array_oids&&e.types.postgres.array_oids.forEach(function(r){t.lib.types.setTypeParser(r,function(n){return t.lib.types.arrayParser.create(n,function(n){return e.parse(n,r,t.lib.types.getTypeParser)}).parse()})})},n.prototype.connect=function(e){var t=this,r={};return e.user=e.username,r=o._.pick(e,["user","password","host","database","port"]),e.dialectOptions&&o._.merge(r,o._.pick(e.dialectOptions,["application_name","ssl","client_encoding","binary"])),new s(function(e,n){var i=new t.lib.Client(r),o=!1;i.connect(function(t){if(t)if(t.code)switch(t.code){case"ECONNREFUSED":n(new a.ConnectionRefusedError(t));break;case"ENOTFOUND":n(new a.HostNotFoundError(t));break;case"EHOSTUNREACH":n(new a.HostNotReachableError(t));break;case"EINVAL":n(new a.InvalidConnectionError(t));break;default:n(new a.ConnectionError(t))}else n(new a.ConnectionError(t));else o=!0,e(i)}),i.on("end",function(){o||n(new a.ConnectionTimedOutError(new Error("Connection timed out")))}),i.on("error",function(){i._invalid=!0})}).tap(function(e){var r="";if(0!==t.sequelize.options.databaseVersion&&u.gte(t.sequelize.options.databaseVersion,"8.2.0")&&(r+="SET standard_conforming_strings=on;"),!t.sequelize.config.keepDefaultTimezone){var n=!!c.tz.zone(t.sequelize.options.timezone);r+=n?"SET client_min_messages TO warning; SET TIME ZONE '"+t.sequelize.options.timezone+"';":"SET client_min_messages TO warning; SET TIME ZONE INTERVAL '"+t.sequelize.options.timezone+"' HOUR TO MINUTE;"}return 0===l.HSTORE.types.postgres.oids.length&&(r+="SELECT typname, oid, typarray FROM pg_type WHERE typtype = 'b' AND typname IN ('hstore', 'geometry', 'geography')"),new s(function(n,i){e.query(r).on("error",function(e){i(e)}).on("row",function(e){var r;"geometry"===e.typname?r=l.postgres.GEOMETRY:"hstore"===e.typname?r=l.postgres.HSTORE:"geography"===e.typname&&(r=l.postgres.GEOGRAPHY),r.types.postgres.oids.push(e.oid),r.types.postgres.array_oids.push(e.typarray),t.$refreshTypeParser(r)}).on("end",function(){n()})})})},n.prototype.disconnect=function(e){return new s(function(t,r){e.end(),t()})},n.prototype.validate=function(e){return void 0===e._invalid},e.exports=n},function(e,t,r){"use strict";var n=r(0),i=r(76);e.exports=function(e){var t=e.ABSTRACT.warn.bind(void 0,"http://www.postgresql.org/docs/9.4/static/datatype.html");e.UUID.types.postgres={oids:[2950],array_oids:[2951]},e.JSON.types.postgres={oids:[114],array_oids:[199]},e.JSONB.types.postgres={oids:[3802],array_oids:[3807]},e.DATEONLY.types.postgres={oids:[1082],array_oids:[1182]},e.TIME.types.postgres={oids:[1083],array_oids:[1183]};var o=e.DECIMAL.inherits();o.parse=function(e){return e},e.DECIMAL.types.postgres={oids:[1700],array_oids:[1231]};var s=e.STRING.inherits();s.prototype.toSql=function(){return this._binary?"BYTEA":e.STRING.prototype.toSql.call(this)},e.STRING.types.postgres={oids:[1043],array_oids:[1015]};var a=e.TEXT.inherits();a.prototype.toSql=function(){return this._length&&(t("PostgreSQL does not support TEXT with options. Plain `TEXT` will be used instead."),this._length=void 0),"TEXT"},e.TEXT.types.postgres={oids:[25],array_oids:[1009]};var u=e.CHAR.inherits();u.prototype.toSql=function(){return this._binary?"BYTEA":e.CHAR.prototype.toSql.call(this)},e.CHAR.types.postgres={oids:[18,1042],array_oids:[1002,1014]};var l=e.BOOLEAN.inherits();l.prototype.toSql=function(){return"BOOLEAN"},e.BOOLEAN.types.postgres={oids:[16],array_oids:[1e3]};var c=e.DATE.inherits();c.prototype.toSql=function(){return"TIMESTAMP WITH TIME ZONE"},e.DATE.types.postgres={oids:[1184],array_oids:[1185]};var p=e.INTEGER.inherits(function(){if(!(this instanceof p))return new p;e.INTEGER.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("PostgreSQL does not support INTEGER with options. Plain `INTEGER` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)});p.parse=function(e){return parseInt(e,10)},e.INTEGER.types.postgres={oids:[23],array_oids:[1007]};var h=e.BIGINT.inherits(function(){if(!(this instanceof h))return new h;e.BIGINT.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("PostgreSQL does not support BIGINT with options. Plain `BIGINT` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)});e.BIGINT.types.postgres={oids:[20],array_oids:[1016]};var d=e.REAL.inherits(function(){if(!(this instanceof d))return new d;e.REAL.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("PostgreSQL does not support REAL with options. Plain `REAL` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)});e.REAL.types.postgres={oids:[700],array_oids:[1021]};var f=e.DOUBLE.inherits(function(){if(!(this instanceof f))return new f;e.DOUBLE.apply(this,arguments),(this._length||this.options.length||this._unsigned||this._zerofill)&&(t("PostgreSQL does not support DOUBLE with options. Plain `DOUBLE` will be used instead."),this._length=void 0,this.options.length=void 0,this._unsigned=void 0,this._zerofill=void 0)});e.DOUBLE.types.postgres={oids:[701],array_oids:[1022]};var m=e.FLOAT.inherits(function(){if(!(this instanceof m))return new m;e.FLOAT.apply(this,arguments),this._decimals&&(t("PostgreSQL does not support FLOAT with decimals. Plain `FLOAT` will be used instead."),this._length=void 0,this.options.length=void 0,this._decimals=void 0),this._unsigned&&(t("PostgreSQL does not support FLOAT unsigned. `UNSIGNED` was removed."),this._unsigned=void 0),this._zerofill&&(t("PostgreSQL does not support FLOAT zerofill. `ZEROFILL` was removed."),this._zerofill=void 0)});delete m.parse;var y=e.BLOB.inherits();y.prototype.toSql=function(){return this._length&&(t("PostgreSQL does not support BLOB (BYTEA) with options. Plain `BYTEA` will be used instead."),this._length=void 0),"BYTEA"},y.prototype.$hexify=function(e){return"E'\\\\x"+e+"'"},e.BLOB.types.postgres={oids:[17],array_oids:[1001]};var g=e.GEOMETRY.inherits();g.prototype.toSql=function(){var e=this.key;return this.type&&(e+="("+this.type,this.srid&&(e+=","+this.srid),e+=")"),e},e.GEOMETRY.types.postgres={oids:[],array_oids:[]},g.parse=g.prototype.parse=function(e){var t=new Buffer(e,"hex");return i.Geometry.parse(t).toGeoJSON()},g.prototype.$stringify=function(e,t){return"ST_GeomFromGeoJSON("+t.escape(JSON.stringify(e))+")"};var E=e.GEOGRAPHY.inherits();E.prototype.toSql=function(){var e="GEOGRAPHY";return this.type&&(e+="("+this.type,this.srid&&(e+=","+this.srid),e+=")"),e},e.GEOGRAPHY.types.postgres={oids:[],array_oids:[]},E.parse=E.prototype.parse=function(e){var t=new Buffer(e,"hex");return i.Geometry.parse(t).toGeoJSON()},E.prototype.$stringify=function(e,t){return"ST_GeomFromGeoJSON("+t.escape(JSON.stringify(e))+")"};var v,b=e.HSTORE.inherits(function(){if(!(this instanceof b))return new b;e.HSTORE.apply(this,arguments),v||(v=r(37))});b.parse=function(e){return v||(v=r(37)),v.parse(e)},b.prototype.escape=!1,b.prototype.$stringify=function(e){return v||(v=r(37)),"'"+v.stringify(e)+"'"},e.HSTORE.types.postgres={oids:[],array_oids:[]};var A=e.RANGE.inherits();A.oid_map={3904:23,3905:23,3906:1700,3907:1700,3908:1114,3909:1114,3910:1184,3911:1184,3912:1082,3913:1082,3926:20,3927:20};var T=r(106);A.parse=function(e,t,r){var n=r(A.oid_map[t]);return T.parse(e,n)},A.prototype.escape=!1,A.prototype.$stringify=function(e,t){var r=e.map(function(e){return this.options.subtype.stringify?this.options.subtype.stringify(e,t):t.escape(e)},this);return r.inclusive=e.inclusive,"'"+T.stringify(r)+"'"},e.RANGE.types.postgres={oids:[3904,3906,3908,3910,3912,3926],array_oids:[3905,3907,3909,3911,3913,3927]},e.ARRAY.prototype.escape=!1,e.ARRAY.prototype.$stringify=function(e,t){var r="ARRAY["+e.map(function(e){return this.type&&this.type.stringify&&(e=this.type.stringify(e,t),!1===this.type.escape)?e:t.escape(e)},this).join(",")+"]";return this.type&&(r+="::"+this.toSql()),r};var N={DECIMAL:o,BLOB:y,STRING:s,CHAR:u,TEXT:a,INTEGER:p,BOOLEAN:l,DATE:c,BIGINT:h,REAL:d,"DOUBLE PRECISION":f,FLOAT:m,GEOMETRY:g,GEOGRAPHY:E,HSTORE:b,RANGE:A};return n.forIn(N,function(e,t){e.key||(e.key=t),e.extend||(e.extend=function(t){return new e(t.options)})}),N}},function(e,t,r){"use strict";var n=r(0),i=r(27),o=r(101),s=r(105),a=r(104),u=r(4).postgres,l=function(e){this.sequelize=e,this.connectionManager=new o(this,e),this.connectionManager.initPools(),this.QueryGenerator=n.extend({},a,{options:e.options,_dialect:this,sequelize:e})};l.prototype.supports=n.merge(n.cloneDeep(i.prototype.supports),{"DEFAULT VALUES":!0,EXCEPTION:!0,"ON DUPLICATE KEY":!1,"ORDER NULLS":!0,returnValues:{returning:!0},bulkDefault:!0,schemas:!0,lock:!0,lockOf:!0,lockKey:!0,lockOuterJoinFailure:!0,forShare:"FOR SHARE",index:{concurrently:!0,using:2,where:!0},NUMERIC:!0,ARRAY:!0,GEOMETRY:!0,GEOGRAPHY:!0,JSON:!0,JSONB:!0,deferrableConstraints:!0,searchPath:!0}),o.prototype.defaultVersion="9.4.0",l.prototype.Query=s,l.prototype.DataTypes=u,l.prototype.name="postgres",l.prototype.TICK_CHAR='"',l.prototype.TICK_CHAR_LEFT=l.prototype.TICK_CHAR,l.prototype.TICK_CHAR_RIGHT=l.prototype.TICK_CHAR,e.exports=l},function(e,t,r){"use strict";var n=r(3),i=r(8),o=r(4),s=r(28),a=r(24),u=r(0),l={options:{},dialect:"postgres",setSearchPath:function(e){return n._.template("SET search_path to <%= searchPath%>;")({searchPath:e})},createSchema:function(e){return n._.template("CREATE SCHEMA <%= schema%>;")({schema:e})},dropSchema:function(e){return n._.template("DROP SCHEMA IF EXISTS <%= schema%> CASCADE;")({schema:e})},showSchemasQuery:function(){return"SELECT schema_name FROM information_schema.schemata WHERE schema_name <> 'information_schema' AND schema_name != 'public' AND schema_name !~ E'^pg_';"},versionQuery:function(){return"SHOW SERVER_VERSION"},createTableQuery:function(e,t,r){var i=this;r=n._.extend({},r||{});var o,s=n._.get(i,"sequelize.options.databaseVersion",0),l="CREATE TABLE "+(0===s||a.gte(s,"9.1.0")?"IF NOT EXISTS ":"")+"<%= table %> (<%= attributes%>)<%= comments %>",c="",p=[];r.comment&&n._.isString(r.comment)&&(c+="; COMMENT ON TABLE <%= table %> IS "+this.escape(r.comment));for(var h in t){-1!==(o=t[h].indexOf("COMMENT"))&&(c+="; "+t[h].substring(o),t[h]=t[h].substring(0,o));var d=this.dataTypeMapping(e,h,t[h]);p.push(this.quoteIdentifier(h)+" "+d)}var f={table:this.quoteTable(e),attributes:p.join(", "),comments:n._.template(c)({table:this.quoteTable(e)})};r.uniqueKeys&&n._.each(r.uniqueKeys,function(e){e.singleField||(f.attributes+=", UNIQUE ("+e.fields.map(function(e){return i.quoteIdentifiers(e)}).join(", ")+")")});var m=u.reduce(t,function(e,t,r){return u.includes(t,"PRIMARY KEY")&&e.push(this.quoteIdentifier(r)),e}.bind(this),[]).join(",");return m.length>0&&(f.attributes+=", PRIMARY KEY ("+m+")"),n._.template(l)(f).trim()+";"},dropTableQuery:function(e,t){return t=t||{},n._.template("DROP TABLE IF EXISTS <%= table %><%= cascade %>;")({table:this.quoteTable(e),cascade:t.cascade?" CASCADE":""})},showTablesQuery:function(){return"SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_type LIKE '%TABLE' AND table_name != 'spatial_ref_sys';"},describeTableQuery:function(e,t){return t||(t="public"),n._.template('SELECT tc.constraint_type as "Constraint", c.column_name as "Field", c.column_default as "Default", c.is_nullable as "Null", CASE WHEN c.udt_name = \'hstore\' THEN c.udt_name ELSE c.data_type END as "Type", (SELECT array_agg(e.enumlabel) FROM pg_catalog.pg_type t JOIN pg_catalog.pg_enum e ON t.oid=e.enumtypid WHERE t.typname=c.udt_name) AS "special" FROM information_schema.columns c LEFT JOIN information_schema.key_column_usage cu ON c.table_name = cu.table_name AND cu.column_name = c.column_name LEFT JOIN information_schema.table_constraints tc ON c.table_name = tc.table_name AND cu.column_name = c.column_name AND tc.constraint_type = \'PRIMARY KEY\'  WHERE c.table_name = <%= table %> AND c.table_schema = <%= schema %> ')({table:this.escape(e),schema:this.escape(t)})},parseConditionObject:function(e,t){var r=this;return t=t||[],n._.reduce(e,function(e,i,o){return n._.isObject(i)?e=e.concat(r.parseConditionObject(i,t.concat(o))):e.push({path:t.concat(o),value:i}),e},[])},handleSequelizeMethod:function(e,t,r,o,a){if(!(e instanceof n.json))return s.handleSequelizeMethod.call(this,e,t,r,o,a);if(e.conditions){return u.map(this.parseConditionObject(e.conditions),function(e){return i.format("%s#>>'{%s}' = '%s'",u.first(e.path),u.tail(e.path).join(","),e.value)}).join(" and ")}if(e.path){var l;if(u.some(["->","->>","#>"],u.partial(u.includes,e.path)))l=e.path;else{var c=e.path.split(".");l=i.format("%s#>>'{%s}'",u.first(c),u.tail(c).join(","))}return e.value&&(l+=i.format(" = %s",this.escape(e.value))),l}},addColumnQuery:function(e,t,r){var i,s="ALTER TABLE <%= table %> ADD COLUMN <%= attribute %>;",a=this.attributeToSQL(r,{context:"addColumn"});return(r.type&&r.type instanceof o.ENUM||r instanceof o.ENUM)&&(s=this.pgEnum(e,t,r)+s),i=n._.template("<%= key %> <%= definition %>")({key:this.quoteIdentifier(t),definition:this.dataTypeMapping(e,t,a)}),n._.template(s)({table:this.quoteTable(this.extractTableDetails(e)),attribute:i})},removeColumnQuery:function(e,t){return n._.template("ALTER TABLE <%= tableName %> DROP COLUMN <%= attributeName %>;")({tableName:this.quoteTable(this.extractTableDetails(e)),attributeName:this.quoteIdentifier(t)})},changeColumnQuery:function(e,t){var r="ALTER TABLE <%= tableName %> ALTER COLUMN <%= query %>;",i=[];for(var o in t){var s=this.dataTypeMapping(e,o,t[o]),a="";s.indexOf("NOT NULL")>0?(a+=n._.template(r)({tableName:this.quoteTable(e),query:this.quoteIdentifier(o)+" SET NOT NULL"}),s=s.replace("NOT NULL","").trim()):s.match(/REFERENCES/)||(a+=n._.template(r)({tableName:this.quoteTable(e),query:this.quoteIdentifier(o)+" DROP NOT NULL"})),s.indexOf("DEFAULT")>0?(a+=n._.template(r)({tableName:this.quoteTable(e),query:this.quoteIdentifier(o)+" SET DEFAULT "+s.match(/DEFAULT ([^;]+)/)[1]}),s=s.replace(/(DEFAULT[^;]+)/,"").trim()):s.match(/REFERENCES/)||(a+=n._.template(r)({tableName:this.quoteTable(e),query:this.quoteIdentifier(o)+" DROP DEFAULT"})),t[o].match(/^ENUM\(/)&&(r=this.pgEnum(e,o,t[o])+r,s=s.replace(/^ENUM\(.+\)/,this.quoteIdentifier("enum_"+e+"_"+o)),s+=" USING ("+this.quoteIdentifier(o)+"::"+this.quoteIdentifier(s)+")"),s.match(/UNIQUE;*$/)&&(s=s.replace(/UNIQUE;*$/,""),a+=n._.template(r.replace("ALTER COLUMN",""))({tableName:this.quoteTable(e),query:"ADD CONSTRAINT "+this.quoteIdentifier(o+"_unique_idx")+" UNIQUE ("+this.quoteIdentifier(o)+")"})),s.match(/REFERENCES/)?(s=s.replace(/.+?(?=REFERENCES)/,""),a+=n._.template(r.replace("ALTER COLUMN",""))({tableName:this.quoteTable(e),query:"ADD CONSTRAINT "+this.quoteIdentifier(o+"_foreign_idx")+" FOREIGN KEY ("+this.quoteIdentifier(o)+") "+s})):a+=n._.template(r)({tableName:this.quoteTable(e),query:this.quoteIdentifier(o)+" TYPE "+s}),i.push(a)}return i.join("")},renameColumnQuery:function(e,t,r){var i="ALTER TABLE <%= tableName %> RENAME COLUMN <%= attributes %>;",o=[];for(var s in r)o.push(n._.template("<%= before %> TO <%= after %>")({before:this.quoteIdentifier(t),after:this.quoteIdentifier(s)}));return n._.template(i)({tableName:this.quoteTable(e),attributes:o.join(", ")})},fn:function(e,t,r,i,o){return e=e||"testfunc",o=o||"plpgsql",i=i||"SETOF "+this.quoteTable(t),n._.template("CREATE OR REPLACE FUNCTION pg_temp.<%= fnName %>() RETURNS <%= returns %> AS $func$ BEGIN <%= body %> END; $func$ LANGUAGE <%= language %>; SELECT * FROM pg_temp.<%= fnName %>();")({fnName:e,returns:i,language:o,body:r})},exceptionFn:function(e,t,r,i,o,s,a){o=o||"unique_violation";var u="<%= main %> EXCEPTION WHEN <%= when %> THEN <%= then %>;";return u=n._.template(u)({main:r,when:o,then:i}),this.fn(e,t,u,s,a)},upsertQuery:function(e,t,r,n,i,o){var s=this.insertQuery(e,t,i,o),a=this.updateQuery(e,r,n,o,i);return this.exceptionFn("sequelize_upsert",e,s+" RETURN 1;",a+"; RETURN 2","unique_violation","integer")},deleteQuery:function(e,t,r,i){var o;if(r=r||{},e=this.quoteTable(e),!0===r.truncate)return o="TRUNCATE "+e,r.restartIdentity&&(o+=" RESTART IDENTITY"),r.cascade&&(o+=" CASCADE"),o;n._.isUndefined(r.limit)&&(r.limit=1);var s={table:e,where:this.getWhereConditions(t,null,i,r),limit:r.limit?" LIMIT "+this.escape(r.limit):""};if(r.limit){if(!i)throw new Error("Cannot LIMIT delete without a model.");var a=u.map(u.values(i.primaryKeys),function(e){return this.quoteIdentifier(e.field)}.bind(this)).join(",");s.primaryKeys=i.primaryKeyAttributes.length>1?"("+a+")":a,s.primaryKeysSelection=a,o="DELETE FROM <%= table %> WHERE <%= primaryKeys %> IN (SELECT <%= primaryKeysSelection %> FROM <%= table %><%= where %><%= limit %>)"}else o="DELETE FROM <%= table %><%= where %>";return s.where&&(s.where=" WHERE "+s.where),n._.template(o)(s)},showIndexesQuery:function(e){var t="",r="";return n._.isString(e)||(t=", pg_namespace s",r=n._.template(" AND s.oid = t.relnamespace AND s.nspname = '<%= schemaName %>'")({schemaName:e.schema}),e=e.tableName),n._.template("SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a<%= schemaJoin%> WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = '<%= tableName %>'<%= schemaWhere%> GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;")({tableName:e,schemaJoin:t,schemaWhere:r})},removeIndexQuery:function(e,t){var r=t;return"string"!=typeof r&&(r=n.inflection.underscore(e+"_"+t.join("_"))),n._.template("DROP INDEX IF EXISTS <%= indexName %>")({tableName:this.quoteIdentifiers(e),indexName:this.quoteIdentifiers(r)})},addLimitAndOffset:function(e){var t="";return null!=e.limit&&(t+=" LIMIT "+this.escape(e.limit)),null!=e.offset&&(t+=" OFFSET "+this.escape(e.offset)),t},attributeToSQL:function(e){n._.isPlainObject(e)||(e={type:e});var t="<%= type %>",r={};if(e.type instanceof o.ENUM){if(e.type.values&&!e.values&&(e.values=e.type.values),!(Array.isArray(e.values)&&e.values.length>0))throw new Error("Values for ENUM haven't been defined.");r.type="ENUM("+n._.map(e.values,function(e){return this.escape(e)}.bind(this)).join(", ")+")"}return r.type||(r.type=e.type),e.hasOwnProperty("allowNull")&&!e.allowNull&&(t+=" NOT NULL"),e.autoIncrement&&(t+=" SERIAL"),n.defaultValueSchemable(e.defaultValue)&&(t+=" DEFAULT <%= defaultValue %>",r.defaultValue=this.escape(e.defaultValue,e)),!0===e.unique&&(t+=" UNIQUE"),e.primaryKey&&(t+=" PRIMARY KEY"),e.references&&(e=n.formatReferences(e),t+=" REFERENCES <%= referencesTable %> (<%= referencesKey %>)",r.referencesTable=this.quoteTable(e.references.model),e.references.key?r.referencesKey=this.quoteIdentifiers(e.references.key):r.referencesKey=this.quoteIdentifier("id"),e.onDelete&&(t+=" ON DELETE <%= onDeleteAction %>",r.onDeleteAction=e.onDelete.toUpperCase()),e.onUpdate&&(t+=" ON UPDATE <%= onUpdateAction %>",r.onUpdateAction=e.onUpdate.toUpperCase()),e.references.deferrable&&(t+=" <%= deferrable %>",r.deferrable=e.references.deferrable.toString(this))),n._.template(t)(r)},deferConstraintsQuery:function(e){return e.deferrable.toString(this)},setConstraintQuery:function(e,t){var r="ALL";return e&&(r=e.map(function(e){return this.quoteIdentifier(e)}.bind(this)).join(", ")),"SET CONSTRAINTS "+r+" "+t},setDeferredQuery:function(e){return this.setConstraintQuery(e,"DEFERRED")},setImmediateQuery:function(e){return this.setConstraintQuery(e,"IMMEDIATE")},attributesToSQL:function(e,t){var r,n,i={};for(r in e)n=e[r],i[n.field||r]=this.attributeToSQL(n,t);return i},findAutoIncrementField:function(e){var t=[];for(var r in e.attributes){var n=e.attributes[r];n&&n.autoIncrement&&t.push(r)}return t},createTrigger:function(e,t,r,i,o,s,a){var u=["CREATE <%= constraintVal %>TRIGGER <%= triggerName %>","<%= eventType %> <%= eventSpec %>","ON <%= tableName %>","<%= optionsSpec %>","EXECUTE PROCEDURE <%= functionName %>(<%= paramList %>);"].join("\n\t");return n._.template(u)({constraintVal:this.triggerEventTypeIsConstraint(r),triggerName:t,eventType:this.decodeTriggerEventType(r),eventSpec:this.expandTriggerEventSpec(i),tableName:e,optionsSpec:this.expandOptions(a),functionName:o,paramList:this.expandFunctionParamList(s)})},dropTrigger:function(e,t){return n._.template("DROP TRIGGER <%= triggerName %> ON <%= tableName %> RESTRICT;")({triggerName:t,tableName:e})},renameTrigger:function(e,t,r){return n._.template("ALTER TRIGGER <%= oldTriggerName %> ON <%= tableName %> RENAME TO <%= newTriggerName%>;")({tableName:e,oldTriggerName:t,newTriggerName:r})},createFunction:function(e,t,r,i,o,s){var a=["CREATE FUNCTION <%= functionName %>(<%= paramList %>)","RETURNS <%= returnType %> AS $func$","BEGIN","\t<%= body %>","END;","$func$ language '<%= language %>'<%= options %>;"].join("\n");return n._.template(a)({functionName:e,paramList:this.expandFunctionParamList(t),returnType:r,body:o.replace("\n","\n\t"),language:i,options:this.expandOptions(s)})},dropFunction:function(e,t){return n._.template("DROP FUNCTION <%= functionName %>(<%= paramList %>) RESTRICT;")({functionName:e,paramList:this.expandFunctionParamList(t)})},renameFunction:function(e,t,r){return n._.template("ALTER FUNCTION <%= oldFunctionName %>(<%= paramList %>) RENAME TO <%= newFunctionName %>;")({oldFunctionName:e,paramList:this.expandFunctionParamList(t),newFunctionName:r})},databaseConnectionUri:function(e){return n._.template("<%= protocol %>://<%= user %>:<%= password %>@<%= host %><% if(port) { %>:<%= port %><% } %>/<%= database %><% if(ssl) { %>?ssl=<%= ssl %><% } %>")({user:e.username,password:e.password,database:e.database,host:e.host,port:e.port,protocol:e.protocol,ssl:e.ssl})},pgEscapeAndQuote:function(e){return this.quoteIdentifier(n.removeTicks(this.escape(e),"'"))},expandFunctionParamList:function(e){if(n._.isUndefined(e)||!n._.isArray(e))throw new Error("expandFunctionParamList: function parameters array required, including an empty one for no arguments");return n._.each(e,function(e){var t=[];if(!n._.has(e,"type"))throw new Error("createFunction called with a parameter with no type");return n._.has(e,"direction")&&t.push(e.direction),n._.has(e,"name")&&t.push(e.name),t.push(e.type),t.join(" ")}).join(", ")},expandOptions:function(e){return n._.isUndefined(e)||n._.isEmpty(e)?"":"\n\t"+e.join("\n\t")},decodeTriggerEventType:function(e){var t={after:"AFTER",before:"BEFORE",instead_of:"INSTEAD OF",after_constraint:"AFTER"};if(!n._.has(t,e))throw new Error("Invalid trigger event specified: "+e);return t[e]},triggerEventTypeIsConstraint:function(e){return"after_constraint"===e?"CONSTRAINT ":""},expandTriggerEventSpec:function(e){if(n._.isEmpty(e))throw new Error("no table change events specified to trigger on");return n._.map(e,function(e,t){var r={insert:"INSERT",update:"UPDATE",delete:"DELETE",truncate:"TRUNCATE"};if(!n._.has(r,t))throw new Error("parseTriggerEventSpec: undefined trigger event "+t);var i=r[t];return"UPDATE"===i&&n._.isArray(e)&&e.length>0&&(i+=" OF "+e.join(", ")),i}).join(" OR ")},pgEnumName:function(e,t,r){r=r||{};var n=this.extractTableDetails(e,r),i='"enum_'+n.tableName+"_"+t+'"';return!1!==r.schema&&n.schema&&(i=this.quoteIdentifier(n.schema)+n.delimiter+i),i},pgListEnums:function(e,t,r){var n="",i=this.extractTableDetails(e,r);return i.tableName&&t&&(n=" AND t.typname="+this.pgEnumName(i.tableName,t,{schema:!1}).replace(/"/g,"'")),"SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = '"+i.schema+"'"+n+" GROUP BY 1"},pgEnum:function(e,t,r,n){var i,o=this.pgEnumName(e,t,n);i=r.values?"ENUM('"+r.values.join("', '")+"')":r.toString().match(/^ENUM\(.+\)/)[0];var s="CREATE TYPE "+o+" AS "+i+";";return n&&!0===n.force&&(s=this.pgEnumDrop(e,t)+s),s},pgEnumAdd:function(e,t,r,n){var i=this.pgEnumName(e,t),o="ALTER TYPE "+i+" ADD VALUE ";return a.gte(this.sequelize.options.databaseVersion,"9.3.0")&&(o+="IF NOT EXISTS "),o+=this.escape(r),n.before?o+=" BEFORE "+this.escape(n.before):n.after&&(o+=" AFTER "+this.escape(n.after)),o},pgEnumDrop:function(e,t,r){return"DROP TYPE IF EXISTS "+(r=r||this.pgEnumName(e,t))+"; "},fromArray:function(e){e=e.replace(/^{/,"").replace(/}$/,"");var t=e.match(/("(?:\\.|[^"\\\\])*"|[^,]*)(?:\s*,\s*|\s*$)/gi);return t.length<1?[]:(t=t.map(function(e){return e.replace(/",$/,"").replace(/,$/,"").replace(/(^"|"$)/,"")}),t.slice(0,-1))},padInt:function(e){return e<10?"0"+e.toString():e.toString()},dataTypeMapping:function(e,t,r){return n._.includes(r,"PRIMARY KEY")&&(r=r.replace(/PRIMARY KEY/,"")),n._.includes(r,"SERIAL")&&(n._.includes(r,"BIGINT")?(r=r.replace(/SERIAL/,"BIGSERIAL"),r=r.replace(/BIGINT/,"")):r=r.replace(/INTEGER/,""),r=r.replace(/NOT NULL/,"")),r.match(/^ENUM\(/)&&(r=r.replace(/^ENUM\(.+\)/,this.pgEnumName(e,t))),r},quoteIdentifier:function(e,t){return"*"===e?e:!t&&this.options&&!1===this.options.quoteIdentifiers?n.removeTicks(e,'"'):n.addTicks(e,'"')},getForeignKeysQuery:function(e,t){return"SELECT conname as constraint_name, pg_catalog.pg_get_constraintdef(r.oid, true) as condef FROM pg_catalog.pg_constraint r WHERE r.conrelid = (SELECT oid FROM pg_class WHERE relname = '"+e+"' LIMIT 1) AND r.contype = 'f' ORDER BY 1;"},dropForeignKeyQuery:function(e,t){return"ALTER TABLE "+this.quoteTable(e)+" DROP CONSTRAINT "+this.quoteIdentifier(t)+";"},setAutocommitQuery:function(e,t){if(!t.parent&&e&&!a.gte(this.sequelize.options.databaseVersion,"9.4.0"))return s.setAutocommitQuery.call(this,e,t)}};e.exports=n._.extend(n._.clone(s),l)},function(e,t,r){"use strict";var n=r(3),i=r(29),o=r(14),s=r(5),a=r(6),u=r(0),l=function(e,t,r){this.client=e,this.sequelize=t,this.instance=r.instance,this.model=r.model,this.options=u.extend({logging:console.log,plain:!1,raw:!1},r||{}),this.checkLoggingOption()};n.inherit(l,i),l.formatBindParameters=function(e,t,r){var n=[];if(Array.isArray(t))n=t,e=i.formatBindParameters(e,t,r,{skipValueReplace:!0})[0];else{var o=0,s={},a=function(e,t,r,i,a,u){return void 0!==s[t]?s[t]:void 0!==r[t]?(o+=1,n.push(r[t]),s[t]="$"+o,"$"+o):void 0};e=i.formatBindParameters(e,t,r,a)[0]}return[e,n]},l.prototype.run=function(e,t){this.sql=e,n._.isEmpty(this.options.searchPath)||(this.sql=this.sequelize.queryInterface.QueryGenerator.setSearchPath(this.options.searchPath)+e);var r=this,i=!1,a=t&&t.length?this.client.query(this.sql,t):this.client.query(this.sql),l=[],c=this.sequelize.options.benchmark||this.options.benchmark;if(c)var p=Date.now();else this.sequelize.log("Executing ("+(this.client.uuid||"default")+"): "+this.sql,this.options);return new s(function(t,n){a.on("row",function(e){l.push(e)}),a.on("error",function(t){"ECONNRESET"===t.code&&(r.client._invalid=!0),i=!0,t.sql=e,n(r.formatError(t))}),a.on("end",function(n){c&&r.sequelize.log("Executed ("+(r.client.uuid||"default")+"): "+r.sql,Date.now()-p,r.options),i||t([l,e,n])})}).spread(function(e,t,n){var i=e,s=0===t.indexOf("SELECT table_name FROM information_schema.tables");if(0===t.indexOf("SELECT relname FROM pg_class WHERE oid IN"))return e.map(function(e){return{name:e.relname,tableName:e.relname.split("_")[0]}});if(s)return e.map(function(e){return u.values(e)});if(e[0]&&void 0!==e[0].sequelize_caught_exception){if(null!==e[0].sequelize_caught_exception){throw r.formatError({code:"23505",detail:e[0].sequelize_caught_exception})}e=e.map(function(e){return delete e.sequelize_caught_exception,e})}if(r.isShowIndexesQuery())return i.forEach(function(e){var t,n,i,o=/ON .*? (?:USING .*?\s)?\((.*)\)/gi.exec(e.definition)[1].split(",");i=u.zipObject(e.column_indexes,r.sequelize.queryInterface.QueryGenerator.fromArray(e.column_names)),delete e.column_indexes,delete e.column_names,e.fields=e.indkey.split(" ").map(function(e,r){return(t=i[e])?(n=o[r],{attribute:t,collate:n.match(/COLLATE "(.*?)"/)?/COLLATE "(.*?)"/.exec(n)[1]:void 0,order:-1!==n.indexOf("DESC")?"DESC":-1!==n.indexOf("ASC")?"ASC":void 0,length:void 0}):null}).filter(function(e){return null!==e}),delete e.columns}),i;if(r.isForeignKeysQuery())return n=[],e.forEach(function(e){var t;if(void 0!==e.condef&&(t=e.condef.match(/FOREIGN KEY \((.+)\) REFERENCES (.+)\((.+)\)( ON (UPDATE|DELETE) (CASCADE|RESTRICT))?( ON (UPDATE|DELETE) (CASCADE|RESTRICT))?/))){e.id=e.constraint_name,e.table=t[2],e.from=t[1],e.to=t[3];var r;for(r=5;r<=8;r+=3)/(UPDATE|DELETE)/.test(t[r])&&(e["on_"+t[r].toLowerCase()]=t[r+1])}n.push(e)}),n;if(r.isSelectQuery()){if(!1===r.options.raw&&!1===r.sequelize.options.quoteIdentifiers){var a=u.reduce(r.model.attributes,function(e,t,r){return e[r.toLowerCase()]=r,e},{});e.forEach(function(e){u.keys(e).forEach(function(t){var r=a[t];"string"==typeof r&&r!==t&&(e[r]=e[t],delete e[t])})})}return r.handleSelectQuery(e)}if(o.DESCRIBE===r.options.type)return n={},e.forEach(function(e){if(n[e.Field]={type:e.Type.toUpperCase(),allowNull:"YES"===e.Null,defaultValue:e.Default,special:e.special?r.sequelize.queryInterface.QueryGenerator.fromArray(e.special):[],primaryKey:"PRIMARY KEY"===e.Constraint},"BOOLEAN"===n[e.Field].type&&(n[e.Field].defaultValue={false:!1,true:!0}[n[e.Field].defaultValue],void 0===n[e.Field].defaultValue&&(n[e.Field].defaultValue=null)),"string"==typeof n[e.Field].defaultValue&&(n[e.Field].defaultValue=n[e.Field].defaultValue.replace(/'/g,""),n[e.Field].defaultValue.indexOf("::")>-1)){var t=n[e.Field].defaultValue.split("::");"regclass)"!==t[1].toLowerCase()&&(n[e.Field].defaultValue=t[0])}}),n;if(r.isVersionQuery())return i[0].server_version;if(r.isShowOrDescribeQuery())return i;if(o.BULKUPDATE===r.options.type)return r.options.returning?r.handleSelectQuery(e):parseInt(n.rowCount,10);if(o.BULKDELETE===r.options.type)return parseInt(n.rowCount,10);if(r.isUpsertQuery())return e[0].sequelize_upsert;if(r.isInsertQuery()||r.isUpdateQuery()){if(r.instance&&r.instance.dataValues)for(var l in e[0])if(e[0].hasOwnProperty(l)){var c=e[0][l],p=u.find(r.model.rawAttributes,function(e){return e.fieldName===l||e.field===l});r.instance.dataValues[p&&p.fieldName||l]=c}return r.instance||e&&(r.options.plain&&e[0]||e)||void 0}return r.isRawQuery()?[e,n]:i})},l.prototype.formatError=function(e){var t,r,n,i,o,s,l=this,c=e.code||e.sqlState,p=e.message||e.messagePrimary,h=e.detail||e.messageDetail;switch(c){case"23503":return n=p.match(/violates foreign key constraint \"(.+?)\"/),n=n?n[1]:void 0,r=p.match(/on table \"(.+?)\"/),r=r?r[1]:void 0,new a.ForeignKeyConstraintError({message:p,fields:null,index:n,table:r,parent:e});case"23505":return h&&(t=h.replace(/"/g,"").match(/Key \((.*?)\)=\((.*?)\)/))?(i=u.zipObject(t[1].split(", "),t[2].split(", ")),o=[],s="Validation error",u.forOwn(i,function(e,t){o.push(new a.ValidationErrorItem(l.getUniqueConstraintErrorMessage(t),"unique violation",t,e))}),this.model&&this.model.uniqueKeys&&u.forOwn(this.model.uniqueKeys,function(e){if(u.isEqual(e.fields,Object.keys(i))&&e.msg)return s=e.msg,!1}),new a.UniqueConstraintError({message:s,errors:o,parent:e,fields:i})):new a.UniqueConstraintError({message:p,parent:e});case"23P01":return t=h.match(/Key \((.*?)\)=\((.*?)\)/),t&&(i=u.zipObject(t[1].split(", "),t[2].split(", "))),s="Exclusion constraint error",new a.ExclusionConstraintError({message:s,constraint:e.constraint,fields:i,table:e.table,parent:e});default:return new a.DatabaseError(e)}},l.prototype.isForeignKeysQuery=function(){return/SELECT conname as constraint_name, pg_catalog\.pg_get_constraintdef\(r\.oid, true\) as condef FROM pg_catalog\.pg_constraint r WHERE r\.conrelid = \(SELECT oid FROM pg_class WHERE relname = '.*' LIMIT 1\) AND r\.contype = 'f' ORDER BY 1;/.test(this.sql)},l.prototype.getInsertIdField=function(){return"id"},e.exports=l},function(e,t,r){"use strict";function n(e){return null===e?"":e===1/0||e===-1/0?e.toString().toLowerCase():JSON.stringify(e)}function i(e,t){return e?"infinity"===e?1/0:"-infinity"===e?-1/0:t(e):null}function o(e){if(null===e)return null;if(!a.isArray(e))throw new Error("range must be an array");if(!e.length)return"empty";if(2!==e.length)throw new Error("range array length must be 0 (empty) or 2 (lower and upper bounds)");e.hasOwnProperty("inclusive")&&e.inclusive?!0===e.inclusive&&(e.inclusive=[!0,!0]):e.inclusive=[!1,!1],a.each(e,function(t,r){a.isObject(t)&&(t.hasOwnProperty("inclusive")&&(e.inclusive[r]=!!t.inclusive),t.hasOwnProperty("value")&&(e[r]=t.value))});var t=n(e[0]),r=n(e[1]);return(e.inclusive[0]?"[":"(")+t+","+r+(e.inclusive[1]?"]":")")}function s(e,t){if(null===e)return null;if("empty"===e){var r=[];return r.inclusive=[],r}var n=e.substring(1,e.length-1).split(",",2);return 2!==n.length?e:(n=n.map(function(e){return i(e,t)}),n.inclusive=["["===e[0],"]"===e[e.length-1]],n)}var a=r(0);e.exports={stringify:o,parse:s}},function(e,t){function r(e){throw new Error("Cannot find module '"+e+"'.")}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=107},function(e,t,r){"use strict";var n,i=r(26),o=r(3),s=r(5),a=r(4).sqlite,u=r(6),l=r(30)("sqlite");n=function(e,t){this.sequelize=t,this.config=t.config,this.dialect=e,this.dialectName=this.sequelize.options.dialect,this.connections={},"localhost"===this.sequelize.options.host&&delete this.sequelize.options.host;try{this.lib=!function(){var e=new Error('Cannot find module "."');throw e.code="MODULE_NOT_FOUND",e}().verbose()}catch(e){if("MODULE_NOT_FOUND"===e.code)throw new Error("Please install sqlite3 package manually");throw e}this.refreshTypeParser(a)},o._.extend(n.prototype,i.prototype),n.prototype.$refreshTypeParser=function(e){l.refresh(e)},n.prototype.$clearTypeParser=function(){l.clear()},n.prototype.getConnection=function(e){var t=this;e=e||{},e.uuid=e.uuid||"default",e.inMemory=":memory:"===(t.sequelize.options.storage||t.sequelize.options.host||":memory:")?1:0;var r=t.sequelize.options.dialectOptions;return e.readWriteMode=r&&r.mode,t.connections[e.inMemory||e.uuid]?s.resolve(t.connections[e.inMemory||e.uuid]):new s(function(r,n){t.connections[e.inMemory||e.uuid]=new t.lib.Database(t.sequelize.options.storage||t.sequelize.options.host||":memory:",e.readWriteMode||t.lib.OPEN_READWRITE|t.lib.OPEN_CREATE,function(i){if(i)return n("SQLITE_CANTOPEN"===i.code?new u.ConnectionError(i):new u.ConnectionError(i));r(t.connections[e.inMemory||e.uuid])})}).tap(function(e){!1!==t.sequelize.options.foreignKeys&&e.run("PRAGMA FOREIGN_KEYS=ON")})},n.prototype.releaseConnection=function(e,t){":memory:"===e.filename&&!0!==t||e.uuid&&(e.close(),delete this.connections[e.uuid])},e.exports=n},function(e,t,r){"use strict";var n=r(0);e.exports=function(e){var t=e.ABSTRACT.warn.bind(void 0,"https://www.sqlite.org/datatype3.html");e.DATE.types.sqlite=["DATETIME"],e.STRING.types.sqlite=["VARCHAR","VARCHAR BINARY"],e.CHAR.types.sqlite=["CHAR","CHAR BINARY"],e.TEXT.types.sqlite=["TEXT"],e.INTEGER.types.sqlite=["INTEGER"],e.BIGINT.types.sqlite=["BIGINT"],e.FLOAT.types.sqlite=["FLOAT"],e.TIME.types.sqlite=["TIME"],e.DATEONLY.types.sqlite=["DATE"],e.BOOLEAN.types.sqlite=["TINYINT"],e.BLOB.types.sqlite=["TINYBLOB","BLOB","LONGBLOB"],e.DECIMAL.types.sqlite=["DECIMAL"],e.UUID.types.sqlite=["UUID"],e.ENUM.types.sqlite=!1,e.REAL.types.sqlite=["REAL"],e.DOUBLE.types.sqlite=["DOUBLE PRECISION"],e.GEOMETRY.types.sqlite=!1;var r=e.DATE.inherits();r.parse=function(e,t){return-1===e.indexOf("+")?new Date(e+t.timezone):new Date(e)};var i=e.STRING.inherits();i.prototype.toSql=function(){return this._binary?"VARCHAR BINARY("+this._length+")":e.STRING.prototype.toSql.call(this)};var o=e.TEXT.inherits();o.prototype.toSql=function(){return this._length&&(t("SQLite does not support TEXT with options. Plain `TEXT` will be used instead."),this._length=void 0),"TEXT"};var s=e.CHAR.inherits();s.prototype.toSql=function(){return this._binary?"CHAR BINARY("+this._length+")":e.CHAR.prototype.toSql.call(this)};var a=e.NUMBER.inherits();a.prototype.toSql=function(){var e=this.key;return this._unsigned&&(e+=" UNSIGNED"),this._zerofill&&(e+=" ZEROFILL"),this._length&&(e+="("+this._length,"number"==typeof this._decimals&&(e+=","+this._decimals),e+=")"),e};var u=e.INTEGER.inherits(function(t){var r="object"==typeof t&&t||{length:t};if(!(this instanceof u))return new u(r);e.INTEGER.call(this,r)});u.prototype.key=u.key="INTEGER",u.prototype.toSql=function(){return a.prototype.toSql.call(this)};var l=e.BIGINT.inherits(function(t){var r="object"==typeof t&&t||{length:t};if(!(this instanceof l))return new l(r);e.BIGINT.call(this,r)});l.prototype.key=l.key="BIGINT",l.prototype.toSql=function(){return a.prototype.toSql.call(this)};var c=e.FLOAT.inherits(function(t,r){var n="object"==typeof t&&t||{length:t,decimals:r};if(!(this instanceof c))return new c(n);e.FLOAT.call(this,n)});c.prototype.key=c.key="FLOAT",c.prototype.toSql=function(){return a.prototype.toSql.call(this)};var p=e.DOUBLE.inherits(function(t,r){var n="object"==typeof t&&t||{length:t,decimals:r};if(!(this instanceof p))return new p(n);e.DOUBLE.call(this,n)});p.prototype.key=p.key="DOUBLE PRECISION",p.prototype.toSql=function(){return a.prototype.toSql.call(this)};var h=e.REAL.inherits(function(t,r){var n="object"==typeof t&&t||{length:t,decimals:r};if(!(this instanceof h))return new h(n);e.REAL.call(this,n)});h.prototype.key=h.key="REAL",h.prototype.toSql=function(){return a.prototype.toSql.call(this)},[c,p,h].forEach(function(e){e.parse=function(e){if(n.isString(e)){if("NaN"===e)return NaN;if("Infinity"===e)return 1/0;if("-Infinity"===e)return-1/0}return e}});var d=e.ENUM.inherits();d.prototype.toSql=function(){return"TEXT"};var f={DATE:r,STRING:i,CHAR:s,NUMBER:a,FLOAT:c,REAL:h,"DOUBLE PRECISION":p,INTEGER:u,BIGINT:l,TEXT:o,ENUM:d};return n.forIn(f,function(e,t){e.key||(e.key=t),e.extend||(e.extend=function(t){return new e(t.options)})}),f}},function(e,t,r){"use strict";var n=r(0),i=r(27),o=r(108),s=r(113),a=r(111),u=r(4).sqlite,l=function(e){this.sequelize=e,this.connectionManager=new o(this,e),this.QueryGenerator=n.extend({},a,{options:e.options,_dialect:this,sequelize:e})};l.prototype.supports=n.merge(n.cloneDeep(i.prototype.supports),{DEFAULT:!1,"DEFAULT VALUES":!0,"UNION ALL":!1,IGNORE:" OR IGNORE",index:{using:!1},transactionOptions:{type:!0},joinTableDependent:!1,groupedLimit:!1,ignoreDuplicates:" OR IGNORE"}),o.prototype.defaultVersion="3.8.0",l.prototype.Query=s,l.prototype.DataTypes=u,l.prototype.name="sqlite",l.prototype.TICK_CHAR="`",l.prototype.TICK_CHAR_LEFT=l.prototype.TICK_CHAR,l.prototype.TICK_CHAR_RIGHT=l.prototype.TICK_CHAR,e.exports=l},function(e,t,r){"use strict";var n=r(3),i=r(31),o=r(0),s=n._.extend(n._.clone(r(28)),n._.clone(r(47))),a={options:{},dialect:"sqlite",createSchema:function(){return n._.template("SELECT name FROM `sqlite_master` WHERE type='table' and name!='sqlite_sequence';")({})},showSchemasQuery:function(){return"SELECT name FROM `sqlite_master` WHERE type='table' and name!='sqlite_sequence';"},versionQuery:function(){return"SELECT sqlite_version() as `version`"},createTableQuery:function(e,t,r){r=r||{};var i="CREATE TABLE IF NOT EXISTS <%= table %> (<%= attributes%>)",o=[],s=n._.values(t).filter(function(e){return n._.includes(e,"PRIMARY KEY")}).length>1,a=[];for(var u in t)if(t.hasOwnProperty(u)){var l=t[u],c=n._.includes(l,"AUTOINCREMENT");c&&(l=l.replace(/BIGINT/,"INTEGER"));var p=l;n._.includes(l,"PRIMARY KEY")&&(n._.includes(l,"INTEGER")&&(p=c?"INTEGER PRIMARY KEY AUTOINCREMENT":"INTEGER PRIMARY KEY"),s&&(o.push(u),p=l.replace(/PRIMARY KEY/,"NOT NULL"))),a.push(this.quoteIdentifier(u)+" "+p)}var h={table:this.quoteTable(e),attributes:a.join(", "),charset:r.charset?"DEFAULT CHARSET="+r.charset:""},d=o.map(function(e){return this.quoteIdentifier(e)}.bind(this)).join(", ");if(r.uniqueKeys){var f=this.quoteIdentifier.bind(this);n._.each(r.uniqueKeys,function(e){e.singleField||(h.attributes+=", UNIQUE ("+e.fields.map(function(e){return f(e)}).join(", ")+")")})}d.length>0&&(h.attributes+=", PRIMARY KEY ("+d+")");var m=n._.template(i)(h).trim()+";";return this.replaceBooleanDefaults(m)},booleanValue:function(e){return e?1:0},addColumnQuery:function(e,t,r){var i="ALTER TABLE <%= table %> ADD <%= attribute %>;",o={};o[t]=r;var s=this.attributesToSQL(o,{context:"addColumn"}),a=n._.template("<%= key %> <%= definition %>")({key:this.quoteIdentifier(t),definition:s[t]}),u=n._.template(i)({table:this.quoteTable(e),attribute:a});return this.replaceBooleanDefaults(u)},showTablesQuery:function(){return"SELECT name FROM `sqlite_master` WHERE type='table' and name!='sqlite_sequence';"},upsertQuery:function(e,t,r,n,i,o){return o.ignore=!0,this.insertQuery(e,t,i,o)+" "+this.updateQuery(e,r,n,o,i)},updateQuery:function(e,t,r,i,s){i=i||{},o.defaults(i,this.options),t=n.removeNullValuesFromHash(t,i.omitNull,i);var a="UPDATE <%= table %> SET <%= values %> <%= where %>",u={},l=[];s&&o.each(s,function(e,t){u[t]=e,e.field&&(u[e.field]=e)});for(var c in t){var p=t[c];l.push(this.quoteIdentifier(c)+"="+this.escape(p,u&&u[c]||void 0,{context:"UPDATE"}))}var h={table:this.quoteTable(e),values:l.join(","),where:this.whereQuery(r)};return n._.template(a)(h).trim()},deleteQuery:function(e,t,r){r=r||{};var i={table:this.quoteTable(e),where:this.getWhereConditions(t)};return i.where&&(i.where=" WHERE "+i.where),n._.template("DELETE FROM <%= table %><%= where %>")(i)},attributesToSQL:function(e){var t={};for(var r in e){var i=e[r],o=i.field||r;if(n._.isObject(i)){var s="<%= type %>",a={type:i.type.toString()};i.hasOwnProperty("allowNull")&&!i.allowNull&&(s+=" NOT NULL"),n.defaultValueSchemable(i.defaultValue)&&(s+=" DEFAULT <%= defaultValue %>",a.defaultValue=this.escape(i.defaultValue,i)),!0===i.unique&&(s+=" UNIQUE"),i.primaryKey&&(s+=" PRIMARY KEY",i.autoIncrement&&(s+=" AUTOINCREMENT")),i.references&&(i=n.formatReferences(i),s+=" REFERENCES <%= referencesTable %> (<%= referencesKey %>)",a.referencesTable=this.quoteTable(i.references.model),i.references.key?a.referencesKey=this.quoteIdentifier(i.references.key):a.referencesKey=this.quoteIdentifier("id"),i.onDelete&&(s+=" ON DELETE <%= onDeleteAction %>",a.onDeleteAction=i.onDelete.toUpperCase()),i.onUpdate&&(s+=" ON UPDATE <%= onUpdateAction %>",a.onUpdateAction=i.onUpdate.toUpperCase())),t[o]=n._.template(s)(a)}else t[o]=i}return t},findAutoIncrementField:function(e){var t=[];for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)){var n=e.attributes[r];n&&n.autoIncrement&&t.push(r)}return t},showIndexesQuery:function(e){return n._.template("PRAGMA INDEX_LIST(<%= tableName %>)")({tableName:this.quoteTable(e)})},removeIndexQuery:function(e,t){var r=t;return"string"!=typeof r&&(r=n.inflection.underscore(e+"_"+t.join("_"))),n._.template("DROP INDEX IF EXISTS <%= indexName %>")({tableName:this.quoteIdentifiers(e),indexName:r})},describeTableQuery:function(e,t,r){var i={};return i.$schema=t,i.$schemaDelimiter=r,i.tableName=e,n._.template("PRAGMA TABLE_INFO(<%= tableName %>);")({tableName:this.quoteTable(this.addSchema(i))})},removeColumnQuery:function(e,t){var r,i;return t=this.attributesToSQL(t),r="object"==typeof e?{tableName:e.tableName+"_backup",schema:e.schema}:e+"_backup",i=[this.createTableQuery(r,t).replace("CREATE TABLE","CREATE TEMPORARY TABLE"),"INSERT INTO <%= backupTableName %> SELECT <%= attributeNames %> FROM <%= tableName %>;","DROP TABLE <%= tableName %>;",this.createTableQuery(e,t),"INSERT INTO <%= tableName %> SELECT <%= attributeNames %> FROM <%= backupTableName %>;","DROP TABLE <%= backupTableName %>;"].join(""),n._.template(i)({tableName:this.quoteTable(e),backupTableName:this.quoteTable(r),attributeNames:n._.keys(t).join(", ")})},renameColumnQuery:function(e,t,r,i){var o,s;return i=this.attributesToSQL(i),o="object"==typeof e?{tableName:e.tableName+"_backup",schema:e.schema}:e+"_backup",s=[this.createTableQuery(o,i).replace("CREATE TABLE","CREATE TEMPORARY TABLE"),"INSERT INTO <%= backupTableName %> SELECT <%= attributeNamesImport %> FROM <%= tableName %>;","DROP TABLE <%= tableName %>;",this.createTableQuery(e,i),"INSERT INTO <%= tableName %> SELECT <%= attributeNamesExport %> FROM <%= backupTableName %>;","DROP TABLE <%= backupTableName %>;"].join(""),n._.template(s)({tableName:this.quoteTable(e),backupTableName:this.quoteTable(o),attributeNamesImport:n._.keys(i).map(function(e){return r===e?this.quoteIdentifier(t)+" AS "+this.quoteIdentifier(e):this.quoteIdentifier(e)}.bind(this)).join(", "),attributeNamesExport:n._.keys(i).map(function(e){return this.quoteIdentifier(e)}.bind(this)).join(", ")})},startTransactionQuery:function(e,t){return e.parent?"SAVEPOINT "+this.quoteIdentifier(e.name)+";":"BEGIN "+e.options.type+" TRANSACTION;"},setAutocommitQuery:function(){return"-- SQLite does not support SET autocommit."},setIsolationLevelQuery:function(e){switch(e){case i.ISOLATION_LEVELS.REPEATABLE_READ:return"-- SQLite is not able to choose the isolation level REPEATABLE READ.";case i.ISOLATION_LEVELS.READ_UNCOMMITTED:return"PRAGMA read_uncommitted = ON;";case i.ISOLATION_LEVELS.READ_COMMITTED:return"PRAGMA read_uncommitted = OFF;";case i.ISOLATION_LEVELS.SERIALIZABLE:return"-- SQLite's default isolation level is SERIALIZABLE. Nothing to do.";default:throw new Error("Unknown isolation level: "+e)}},replaceBooleanDefaults:function(e){return e.replace(/DEFAULT '?false'?/g,"DEFAULT 0").replace(/DEFAULT '?true'?/g,"DEFAULT 1")},quoteIdentifier:function(e){return"*"===e?e:n.addTicks(e,"`")},getForeignKeysQuery:function(e,t){return n._.template("PRAGMA foreign_key_list(<%= tableName %>)")({tableName:e})}};e.exports=n._.extend({},s,a)},function(e,t,r){"use strict";var n=r(3),i=r(5),o=function(e,t,r){var o=this;return r=r||{},this.describeTable(e,r).then(function(s){delete s[t];var a=o.QueryGenerator.removeColumnQuery(e,s),u=a.split(";").filter(function(e){return""!==e});return i.each(u,function(e){return o.sequelize.query(e+";",n._.assign({raw:!0},r))})})},s=function(e,t,r){var o=n._.keys(t)[0],s=this;return r=r||{},this.describeTable(e,r).then(function(a){a[o]=t[o];var u=s.QueryGenerator.removeColumnQuery(e,a),l=u.split(";").filter(function(e){return""!==e});return i.each(l,function(e){return s.sequelize.query(e+";",n._.assign({raw:!0},r))})})},a=function(e,t,r,o){var s=this;return o=o||{},this.describeTable(e,o).then(function(a){a[r]=n._.clone(a[t]),delete a[t];var u=s.QueryGenerator.renameColumnQuery(e,t,r,a),l=u.split(";").filter(function(e){return""!==e});return i.each(l,function(e){return s.sequelize.query(e+";",n._.assign({raw:!0},o))})})};e.exports={removeColumn:o,changeColumn:s,renameColumn:a}},function(e,t,r){"use strict";var n=r(3),i=r(0),o=r(5),s=r(29),a=r(14),u=r(6),l=r(30)("sqlite"),c=function(e,t,r){this.database=e,this.sequelize=t,this.instance=r.instance,this.model=r.model,this.options=i.extend({logging:console.log,plain:!1,raw:!1},r||{}),this.checkLoggingOption()};n.inherit(c,s),c.prototype.getInsertIdField=function(){return"lastID"},c.formatBindParameters=function(e,t,r){var n=[];return Array.isArray(t)?(n={},t.forEach(function(e,t){n["$"+(t+1)]=e}),e=s.formatBindParameters(e,t,r,{skipValueReplace:!0})[0]):(n={},"object"==typeof t&&Object.keys(t).forEach(function(e){n["$"+e]=t[e]}),e=s.formatBindParameters(e,t,r,{skipValueReplace:!0})[0]),[e,n]},c.prototype.$collectModels=function(e,t){var r={};return e&&e.forEach(function(e){var n;n=t?t+"."+e.as:e.as,r[n]=e.model,e.include&&i.merge(r,this.$collectModels(e.include,n))},this),r},c.prototype.run=function(e,t){var r=this;this.sql=e;var n=r.getDatabaseMethod();"exec"===n&&(e=s.formatBindParameters(e,r.options.bind,r.options.dialect,{skipUnescape:!0})[0],this.sql=e);var u=this.sequelize.options.benchmark||this.options.benchmark;if(u)var c=Date.now();else this.sequelize.log("Executing ("+(this.database.uuid||"default")+"): "+this.sql,this.options);return new o(function(e){var s={};r.database.serialize(function(){var p=function(){return 0===r.sql.indexOf("-- ")?e():(e(new o(function(e,o){var p=function(t,n){if(u&&r.sequelize.log("Executed ("+(r.database.uuid||"default")+"): "+r.sql,Date.now()-c,r.options),t)t.sql=r.sql,o(r.formatError(t));else{var p=this,h=r.instance;if(r.isInsertQuery(n,p)&&(r.handleInsertQuery(n,p),r.instance||(h=p[r.getInsertIdField()])),-1!==r.sql.indexOf("sqlite_master"))h=n.map(function(e){return e.name});else if(r.isSelectQuery()){if(!r.options.raw){var d=r.$collectModels(r.options.include);n=n.map(function(e){return i.mapValues(e,function(e,t){var n;if(-1!==t.indexOf(".")){var o=t.lastIndexOf(".");n=d[t.substr(0,o)],t=t.substr(o+1)}else n=r.options.model;var a=n.getTableName().toString().replace(/`/g,""),u=s[a]||{};!u||t in u||i.forOwn(n.rawAttributes,function(e,r){if(t===r&&e.field)return t=e.field,!1});var c=u[t];if(c){-1!==c.indexOf("(")&&(c=c.substr(0,c.indexOf("("))),c=c.replace("UNSIGNED","").replace("ZEROFILL",""),c=c.trim().toUpperCase();var p=l.get(c);if(null!==e&&p)return p(e,{timezone:r.sequelize.options.timezone})}return e})})}h=r.handleSelectQuery(n)}else if(r.isShowOrDescribeQuery())h=n;else if(-1!==r.sql.indexOf("PRAGMA INDEX_LIST"))h=r.handleShowIndexesQuery(n);else if(-1!==r.sql.indexOf("PRAGMA INDEX_INFO"))h=n;else if(-1!==r.sql.indexOf("PRAGMA TABLE_INFO")){h={};var f;n.forEach(function(e){f=null===e.dflt_value?void 0:"NULL"===e.dflt_value?null:e.dflt_value,h[e.name]={type:e.type,allowNull:0===e.notnull,defaultValue:f,primaryKey:1===e.pk},"TINYINT(1)"===h[e.name].type&&(h[e.name].defaultValue={0:!1,1:!0}[h[e.name].defaultValue]),"string"==typeof h[e.name].defaultValue&&(h[e.name].defaultValue=h[e.name].defaultValue.replace(/'/g,""))})}else-1!==r.sql.indexOf("PRAGMA foreign_keys;")?h=n[0]:-1!==r.sql.indexOf("PRAGMA foreign_keys")?h=n:-1!==r.sql.indexOf("PRAGMA foreign_key_list")?h=n:-1!==[a.BULKUPDATE,a.BULKDELETE].indexOf(r.options.type)?h=p.changes:r.options.type===a.UPSERT?h=void 0:r.options.type===a.VERSION?h=n[0].version:r.options.type===a.RAW&&(h=[n,p]);e(h)}};"exec"===n?r.database[n](r.sql,p):(t||(t=[]),r.database[n](r.sql,t,p))})),null)};if("all"===r.getDatabaseMethod()){var h=[];return r.options&&r.options.tableNames?h=r.options.tableNames:/FROM `(.*?)`/i.exec(r.sql)&&h.push(/FROM `(.*?)`/i.exec(r.sql)[1]),h=i.filter(h,function(e){return!(e in s)&&"sqlite_master"!==e}),h.length?o.map(h,function(e){return new o(function(t){e=e.replace(/`/g,""),s[e]={},r.database.all("PRAGMA table_info(`"+e+"`)",function(r,n){r||n.forEach(function(t){s[e][t.name]=t.type}),t()})})}).then(p):p()}return p()})})},c.prototype.formatError=function(e){var t;switch(e.code){case"SQLITE_CONSTRAINT":if(null!==(t=e.message.match(/FOREIGN KEY constraint failed/)))return new u.ForeignKeyConstraintError({parent:e});var r=[];t=e.message.match(/columns (.*?) are/),null!==t&&t.length>=2?r=t[1].split(", "):null!==(t=e.message.match(/UNIQUE constraint failed: (.*)/))&&t.length>=2&&(r=t[1].split(", ").map(function(e){return e.split(".")[1]}));var n=[],o=this,s="Validation error";return r.forEach(function(e){n.push(new u.ValidationErrorItem(o.getUniqueConstraintErrorMessage(e),"unique violation",e,o.instance&&o.instance[e]))}),this.model&&i.forOwn(this.model.uniqueKeys,function(e){if(i.isEqual(e.fields,r)&&e.msg)return s=e.msg,!1}),new u.UniqueConstraintError({message:s,errors:n,parent:e,fields:r});case"SQLITE_BUSY":return new u.TimeoutError(e);default:return new u.DatabaseError(e)}},c.prototype.handleShowIndexesQuery=function(e){var t=this;return this.sequelize.Promise.map(e.reverse(),function(e){return e.fields=[],e.primary=!1,e.unique=!!e.unique,t.run("PRAGMA INDEX_INFO(`"+e.name+"`)").then(function(t){return t.forEach(function(t){e.fields[t.seqno]={attribute:t.name,length:void 0,order:void 0}}),e})})},c.prototype.getDatabaseMethod=function(){return this.isUpsertQuery()?"exec":this.isInsertQuery()||this.isUpdateQuery()||this.isBulkUpdateQuery()||-1!==this.sql.toLowerCase().indexOf("CREATE TEMPORARY TABLE".toLowerCase())||this.options.type===a.BULKDELETE?"run":"all"},e.exports=c},function(e,t,r){"use strict";function n(e,t){t=c.clone(t)||{},t.fields&&!t.skip&&(t.skip=s._.difference(Object.keys(e.Model.attributes),t.fields)),this.options=s._.defaults(t,{skip:[]}),this.modelInstance=e,this.validator=i,this.errors=[],this.inProgress=!1,o(e)}var i=r(52).validator,o=r(52).extendModelValidations,s=r(3),a=r(6),u=r(5),l=r(4),c=r(0);n.RAW_KEY_NAME="__raw",n.prototype.validate=function(){if(this.inProgress)throw new Error("Validations already in progress.");this.inProgress=!0;var e=this;return u.all([e._builtinValidators(),e._customValidators()].map(function(e){return e.reflect()})).then(function(){return e.errors.length?new a.ValidationError(null,e.errors):null})},n.prototype.hookValidate=function(){var e=this;return e.modelInstance.Model.runHooks("beforeValidate",e.modelInstance,e.options).then(function(){return e.validate().then(function(t){if(t)return e.modelInstance.Model.runHooks("validationFailed",e.modelInstance,e.options,t).then(function(e){throw e||t})})}).then(function(){return e.modelInstance.Model.runHooks("afterValidate",e.modelInstance,e.options)}).return(e.modelInstance)},n.prototype._builtinValidators=function(){var e=this,t=[];return s._.forIn(this.modelInstance.rawAttributes,function(r,n){if(!(e.options.skip.indexOf(n)>=0)){var i=e.modelInstance.dataValues[n];r._autoGenerated||r.autoIncrement||e._validateSchema(r,n,i),e.modelInstance.validators.hasOwnProperty(n)&&t.push(e._builtinAttrValidate.call(e,i,n).reflect())}}),u.all(t)},n.prototype._customValidators=function(){var e=[],t=this;return s._.each(this.modelInstance.$modelOptions.validate,function(r,n){if(!(t.options.skip.indexOf(n)>=0)){var i=t._invokeCustomValidator(r,n).catch(function(){}).reflect();e.push(i)}}),u.all(e)},n.prototype._builtinAttrValidate=function(e,t){var r=this;if(null===e||void 0===e)return u.resolve();var n=[];return s._.forIn(this.modelInstance.validators[t],function(i,o){if(-1!==["isUrl","isURL","isEmail"].indexOf(o)&&("object"==typeof i&&null!==i&&i.msg?i={msg:i.msg}:!0===i&&(i={})),"function"==typeof i)return n.push(r._invokeCustomValidator(i,o,!0,e,t).reflect());var s=r._invokeBuiltinValidator(e,i,o,t);s.catch(function(){}),n.push(s.reflect())}),u.all(n).then(this._handleReflectedResult.bind(this,t))},n.prototype._invokeCustomValidator=u.method(function(e,t,r,n,i){var o,s=null,a=!1,l=e.length,c=1,p=t;return r&&(c=2,o=n,p=i),l===c&&(a=!0),a?(s=r?u.promisify(e.bind(this.modelInstance,o)):u.promisify(e.bind(this.modelInstance)),s().catch(this._pushError.bind(this,!1,p))):u.try(e.bind(this.modelInstance,o)).catch(this._pushError.bind(this,!1,p))}),n.prototype._invokeBuiltinValidator=u.method(function(e,t,r,n){var o=this,s=String(e);if("function"!=typeof i[r])throw new Error("Invalid validator function: "+r);var a=o._extractValidatorArgs(t,r,n);if(!i[r].apply(i,[s].concat(a)))throw new Error(t.msg||"Validation "+r+" failed")}),n.prototype._extractValidatorArgs=function(e,t,r){var n=e.args||e,i="string"!=typeof n&&("isAlpha"===t||"isAlphanumeric"===t||"isMobilePhone"===t);return n=Array.isArray(n)?n.slice(0):"isImmutable"===t?[n,r]:i||"isIP"===t?[]:[n]},n.prototype._validateSchema=function(e,t,r){var n;!1!==e.allowNull||null!==r&&void 0!==r||(n=new a.ValidationErrorItem(t+" cannot be null","notNull Violation",t,r),this.errors.push(n)),(e.type===l.STRING||e.type instanceof l.STRING||e.type===l.TEXT||e.type instanceof l.TEXT)&&(Array.isArray(r)||c.isObject(r)&&!r._isSequelizeMethod&&!Buffer.isBuffer(r))&&(n=new a.ValidationErrorItem(t+" cannot be an array or an object","string violation",t,r),this.errors.push(n))},n.prototype._handleReflectedResult=function(e,t){var r=this;t.forEach(function(t){if(t.isRejected()){var n=t.error();r._pushError(!0,e,n)}})},n.prototype._pushError=function(e,t,r){var i=r.message||r||"Validation error",o=new a.ValidationErrorItem(i,"Validation error",t,r);o[n.RAW_KEY_NAME]=r,this.errors.push(o)},e.exports=n,e.exports.InstanceValidator=n,e.exports.default=n},function(e,t,r){"use strict";var n=r(200),i=r(3),o=r(0),s=function(e){this.models=[],this.sequelize=e};s.prototype.addModel=function(e){return this.models.push(e),this.sequelize.models[e.name]=e,e},s.prototype.removeModel=function(e){this.models=this.models.filter(function(t){return t.name!==e.name}),delete this.sequelize.models[e.name]},s.prototype.getModel=function(e,t){t=o.defaults(t||{},{attribute:"name"});var r=this.models.filter(function(r){return r[t.attribute]===e});return r?r[0]:null},s.prototype.__defineGetter__("all",function(){return this.models}),s.prototype.forEachModel=function(e,t){var r,s,a={},u=new n;t=o.defaults(t||{},{reverse:!0}),this.models.forEach(function(e){var t=[],r=e.getTableName();o.isObject(r)&&(r=r.schema+"."+r.tableName),a[r]=e;for(var n in e.rawAttributes)if(e.rawAttributes.hasOwnProperty(n)){var l=e.rawAttributes[n];l.references&&(l=i.formatReferences(l),s=l.references.model,o.isObject(s)&&(s=s.schema+"."+s.tableName),t.push(s))}t=t.filter(function(e){return r!==e}),u.add(r,t)}),r=u.sort(),t.reverse&&(r=r.reverse()),r.forEach(function(t){e(a[t],t)})},e.exports=s,e.exports.ModelManager=s,e.exports.default=s},function(e,t,r){"use strict";var n=r(3),i=r(0),o=r(4),s=r(112),a=r(92),u=r(98),l=r(31),c=r(5),p=r(14),h=function(e){this.sequelize=e,this.QueryGenerator=this.sequelize.dialect.QueryGenerator};h.prototype.createSchema=function(e,t){t=t||{};var r=this.QueryGenerator.createSchema(e);return this.sequelize.query(r,t)},h.prototype.dropSchema=function(e,t){t=t||{};var r=this.QueryGenerator.dropSchema(e);return this.sequelize.query(r,t)},h.prototype.dropAllSchemas=function(e){e=e||{};var t=this;return this.QueryGenerator._dialect.supports.schemas?this.showAllSchemas(e).map(function(r){return t.dropSchema(r,e)}):this.sequelize.drop(e)},h.prototype.showAllSchemas=function(e){var t=this;e=i.assign({},e,{raw:!0,type:this.sequelize.QueryTypes.SELECT});var r=t.QueryGenerator.showSchemasQuery();return this.sequelize.query(r,e).then(function(e){return n._.flatten(n._.map(e,function(e){return e.schema_name?e.schema_name:e}))})},h.prototype.databaseVersion=function(e){return this.sequelize.query(this.QueryGenerator.versionQuery(),i.assign({},e,{type:p.VERSION}))},h.prototype.createTable=function(e,t,r,s){var a=Object.keys(t),u=a.length,l=this,h="",d=0;if(r=i.clone(r)||{},t=n._.mapValues(t,function(e){return n._.isPlainObject(e)||(e={type:e,allowNull:!0}),e=l.sequelize.normalizeAttribute(e)}),"postgres"===l.sequelize.options.dialect){var f=[];for(d=0;d<u;d++)t[a[d]].type instanceof o.ENUM&&(h=l.QueryGenerator.pgListEnums(e,t[a[d]].field||a[d],r),f.push(l.sequelize.query(h,i.assign({},r,{plain:!0,raw:!0,type:p.SELECT}))));return c.all(f).then(function(n){var p=[],f=0;for(d=0;d<u;d++)if(t[a[d]].type instanceof o.ENUM)if(n[f]){if(n[f]&&s){var m=l.QueryGenerator.fromArray(n[f].enum_value),y=s.rawAttributes[a[d]].values;y.forEach(function(t,n){var o=i.clone(r);o.before=null,o.after=null,-1===m.indexOf(t)&&(y[n+1]?o.before=y[n+1]:y[n-1]&&(o.after=y[n-1]),o.supportsSearchPath=!1,p.push(l.sequelize.query(l.QueryGenerator.pgEnumAdd(e,a[d],t,o),o)))}),f++}}else h=l.QueryGenerator.pgEnum(e,t[a[d]].field||a[d],t[a[d]],r),p.push(l.sequelize.query(h,i.assign({},r,{raw:!0})));return!e.schema&&(r.schema||s&&s.$schema)&&(e=l.QueryGenerator.addSchema({tableName:e,$schema:!!s&&s.$schema||r.schema})),t=l.QueryGenerator.attributesToSQL(t,{context:"createTable"}),h=l.QueryGenerator.createTableQuery(e,t,r),c.all(p).then(function(){return l.sequelize.query(h,r)})})}return!e.schema&&(r.schema||s&&s.$schema)&&(e=l.QueryGenerator.addSchema({tableName:e,$schema:!!s&&s.$schema||r.schema})),t=l.QueryGenerator.attributesToSQL(t,{context:"createTable"}),h=l.QueryGenerator.createTableQuery(e,t,r),l.sequelize.query(h,r)},h.prototype.dropTable=function(e,t){t=i.clone(t)||{},t.cascade=t.cascade||t.force||!1;var r=this.QueryGenerator.dropTableQuery(e,t),n=this;return this.sequelize.query(r,t).then(function(){var s=[];if("postgres"===n.sequelize.options.dialect){var a=n.sequelize.modelManager.getModel(e,{attribute:"tableName"});if(a){var u=(t&&t.schema&&"public"!==t.schema?t.schema+"_":"")+e,l=Object.keys(a.rawAttributes),p=l.length,h=0;for(h=0;h<p;h++)a.rawAttributes[l[h]].type instanceof o.ENUM&&(r=n.QueryGenerator.pgEnumDrop(u,l[h]),t.supportsSearchPath=!1,s.push(n.sequelize.query(r,i.assign({},t,{raw:!0}))))}}return c.all(s).get(0)})},h.prototype.dropAllTables=function(e){var t,r=this;e=e||{},t=e.skip||[];var o=function(n){return c.each(n,function(n){if(-1===t.indexOf(n.tableName||n))return r.dropTable(n,i.assign({},e,{cascade:!0}))})};return r.showAllTables(e).then(function(t){return"sqlite"===r.sequelize.options.dialect?r.sequelize.query("PRAGMA foreign_keys;",e).then(function(n){return 1===n.foreign_keys?r.sequelize.query("PRAGMA foreign_keys = OFF",e).then(function(){return o(t).then(function(){return r.sequelize.query("PRAGMA foreign_keys = ON",e)})}):o(t)}):r.getForeignKeysForTables(t,e).then(function(i){var s=[];return t.forEach(function(t){var o=t;n._.isObject(t)&&(o=t.schema+"."+t.tableName),i[o].forEach(function(n){var i=r.QueryGenerator.dropForeignKeyQuery(t,n);s.push(r.sequelize.query(i,e))})}),c.all(s).then(function(){return o(t)})})})},h.prototype.dropAllEnums=function(e){if("postgres"!==this.sequelize.getDialect())return c.resolve();e=e||{};var t=this;return this.pgListEnums(null,e).map(function(r){return t.sequelize.query(t.QueryGenerator.pgEnumDrop(null,null,t.QueryGenerator.pgEscapeAndQuote(r.enum_name)),i.assign({},e,{raw:!0}))})},h.prototype.pgListEnums=function(e,t){t=t||{};var r=this.QueryGenerator.pgListEnums(e);return this.sequelize.query(r,i.assign({},t,{plain:!1,raw:!0,type:p.SELECT}))},h.prototype.renameTable=function(e,t,r){r=r||{};var n=this.QueryGenerator.renameTableQuery(e,t);return this.sequelize.query(n,r)},h.prototype.showAllTables=function(e){var t=this;e=i.assign({},e,{raw:!0,type:p.SHOWTABLES});var r=t.QueryGenerator.showTablesQuery();return t.sequelize.query(r,e).then(function(e){return n._.flatten(e)})},h.prototype.describeTable=function(e,t){var r=null,o=null;"string"==typeof t?r=t:"object"==typeof t&&null!==t&&(r=t.schema||null,o=t.schemaDelimiter||null),"object"==typeof e&&null!==e&&(r=e.schema,e=e.tableName);var s=this.QueryGenerator.describeTableQuery(e,r,o);return this.sequelize.query(s,i.assign({},t,{type:p.DESCRIBE})).then(function(t){return n._.isEmpty(t)?c.reject('No description found for "'+e+'" table. Check the table name and schema; remember, they _are_ case sensitive.'):c.resolve(t)})},h.prototype.addColumn=function(e,t,r,n){if(!e||!t||!r)throw new Error("addColumn takes atleast 3 arguments (table, attribute name, attribute definition)");return n=n||{},r=this.sequelize.normalizeAttribute(r),this.sequelize.query(this.QueryGenerator.addColumnQuery(e,t,r),n)},h.prototype.removeColumn=function(e,t,r){switch(r=r||{},this.sequelize.options.dialect){case"sqlite":return s.removeColumn.call(this,e,t,r);case"mssql":return a.removeColumn.call(this,e,t,r);case"mysql":case"mariadb":return u.removeColumn.call(this,e,t,r);default:var n=this.QueryGenerator.removeColumnQuery(e,t);return this.sequelize.query(n,r)}},h.prototype.changeColumn=function(e,t,r,i){var a={};if(i=i||{},n._.values(o).indexOf(r)>-1?a[t]={type:r,allowNull:!0}:a[t]=r,a[t].type=this.sequelize.normalizeDataType(a[t].type),"sqlite"===this.sequelize.options.dialect)return s.changeColumn.call(this,e,a,i);var u=this.QueryGenerator.attributesToSQL(a),l=this.QueryGenerator.changeColumnQuery(e,u);return this.sequelize.query(l,i)},h.prototype.renameColumn=function(e,t,r,n){return n=n||{},this.describeTable(e,n).then(function(i){i=i[t]||{};var o={};if(o[r]={attribute:r,type:i.type,allowNull:i.allowNull,defaultValue:i.defaultValue},null!==i.defaultValue||i.allowNull||delete o[r].defaultValue,"sqlite"===this.sequelize.options.dialect)return s.renameColumn.call(this,e,t,r,n);var a=this.QueryGenerator.renameColumnQuery(e,t,this.QueryGenerator.attributesToSQL(o));return this.sequelize.query(a,n)}.bind(this))},h.prototype.addIndex=function(e,t,r,o){Array.isArray(t)||(o=r,r=t,t=r.fields),o||(o=e),r=n.cloneDeep(r),r.fields=t;var s=this.QueryGenerator.addIndexQuery(e,r,o);return this.sequelize.query(s,i.assign({},r,{supportsSearchPath:!1}))},h.prototype.showIndex=function(e,t){var r=this.QueryGenerator.showIndexesQuery(e,t);return this.sequelize.query(r,i.assign({},t,{type:p.SHOWINDEXES}))},h.prototype.nameIndexes=function(e,t){return this.QueryGenerator.nameIndexes(e,t)},h.prototype.getForeignKeysForTables=function(e,t){var r=this;return t=t||{},0===e.length?c.resolve({}):c.map(e,function(e){return r.sequelize.query(r.QueryGenerator.getForeignKeysQuery(e,r.sequelize.config.database),t).get(0)}).then(function(t){var r={};return e.forEach(function(e,i){n._.isObject(e)&&(e=e.schema+"."+e.tableName),r[e]=n._.compact(t[i]).map(function(e){return e.constraint_name})}),r})},h.prototype.removeIndex=function(e,t,r){r=r||{};var n=this.QueryGenerator.removeIndexQuery(e,t);return this.sequelize.query(n,r)},h.prototype.insert=function(e,t,r,i){i=n.cloneDeep(i),i.hasTrigger=e&&e.Model.options.hasTrigger;var o=this.QueryGenerator.insertQuery(t,r,e&&e.Model.rawAttributes,i);return i.type=p.INSERT,i.instance=e,this.sequelize.query(o,i).then(function(t){return e&&(t.isNewRecord=!1),t})},h.prototype.upsert=function(e,t,r,o,s,a){var u,l=[],c=[],h=Object.keys(t);a=i.clone(a),n._.isEmpty(o)||l.push(o),c=n._.map(s.options.uniqueKeys,function(e){return e.fields}),n._.each(s.options.indexes,function(e){!0===e.unique&&(u=n._.map(e.fields,function(e){return n._.isPlainObject(e)?e.attribute:e}),c.push(u))}),c.forEach(function(e){n._.intersection(h,e).length===e.length&&(o={},e.forEach(function(e){o[e]=t[e]}),l.push(o))}),o={$or:l},a.type=p.UPSERT,a.raw=!0;var d=this.QueryGenerator.upsertQuery(e,t,r,o,s.rawAttributes,a);return this.sequelize.query(d,a).then(function(e){return void 0===e?e:1===e})},h.prototype.bulkInsert=function(e,t,r,n){r=i.clone(r)||{},r.type=p.INSERT;var o=this.QueryGenerator.bulkInsertQuery(e,t,r,n);return this.sequelize.query(o,r)},h.prototype.update=function(e,t,r,n,o){o=i.clone(o||{}),o.hasTrigger=!!(e&&e.$modelOptions&&e.$modelOptions.hasTrigger);var s=this,a=s.QueryGenerator.updateQuery(t,r,n,o,e.Model.rawAttributes);if(o.type=p.UPDATE,e.Model&&e.Model.associations)for(var u=Object.keys(e.Model.associations),l=u.length,c=0;c<l;c++)e.Model.associations[u[c]].options&&e.Model.associations[u[c]].options.onUpdate&&"restrict"===e.Model.associations[u[c]].options.onUpdate&&!0;return o.instance=e,this.sequelize.query(a,o)},h.prototype.bulkUpdate=function(e,t,r,i,o){i=n.cloneDeep(i),"object"==typeof r&&(r=n.cloneDeep(r));var s=this.QueryGenerator.updateQuery(e,t,r,i,o),a=n._.isObject(e)?e:{tableName:e},u=n._.find(this.sequelize.modelManager.models,{tableName:a.tableName});return i.model=u,this.sequelize.query(s,i)},h.prototype.delete=function(e,t,r,n){var o=this,s=[],a=o.QueryGenerator.deleteQuery(t,r,null,e.Model);if(n=i.clone(n)||{},e.Model&&e.Model.associations)for(var u,l=Object.keys(e.Model.associations),p=l.length,h=0;h<p;h++)u=e.Model.associations[l[h]],u.options&&u.options.onDelete&&"cascade"===u.options.onDelete.toLowerCase()&&!0===u.options.useHooks&&s.push(u.accessors.get);return c.each(s,function(t){return e[t](n).then(function(e){return e?(Array.isArray(e)||(e=[e]),c.each(e,function(e){return e.destroy(n)})):c.resolve()})}).then(function(){return n.instance=e,o.sequelize.query(a,n)})},h.prototype.bulkDelete=function(e,t,r,o){r=n.cloneDeep(r),r=i.defaults(r,{limit:null}),"object"==typeof t&&(t=n.cloneDeep(t));var s=this.QueryGenerator.deleteQuery(e,t,r,o);return this.sequelize.query(s,r)},h.prototype.select=function(e,t,r){return r=n.cloneDeep(r),r.type=p.SELECT,r.model=e,this.sequelize.query(this.QueryGenerator.selectQuery(t,r,e),r)},h.prototype.increment=function(e,t,r,n,o){var s=this.QueryGenerator.incrementQuery(t,r,n,o.attributes);return o=i.clone(o)||{},o.type=p.UPDATE,o.instance=e,this.sequelize.query(s,o)},h.prototype.rawSelect=function(e,t,r,s){t.schema&&(e=this.QueryGenerator.addSchema({tableName:e,$schema:t.schema})),t=n.cloneDeep(t),t=i.defaults(t,{raw:!0,plain:!0,type:p.SELECT});var a=this.QueryGenerator.selectQuery(e,t,s);if(void 0===r)throw new Error("Please pass an attribute selector!");return this.sequelize.query(a,t).then(function(e){if(!t.plain)return e;var i=e?e[r]:null;if(t&&t.dataType){var s=t.dataType;s instanceof o.DECIMAL||s instanceof o.FLOAT?i=parseFloat(i):s instanceof o.INTEGER||s instanceof o.BIGINT?i=parseInt(i,10):s instanceof o.DATE?n._.isNull(i)||n._.isDate(i)||(i=new Date(i)):o.STRING}return i})},h.prototype.createTrigger=function(e,t,r,n,i,o,s,a){var u=this.QueryGenerator.createTrigger(e,t,r,n,i,o,s);return a=a||{},u?this.sequelize.query(u,a):c.resolve()},h.prototype.dropTrigger=function(e,t,r){var n=this.QueryGenerator.dropTrigger(e,t);return r=r||{},n?this.sequelize.query(n,r):c.resolve()},h.prototype.renameTrigger=function(e,t,r,n){var i=this.QueryGenerator.renameTrigger(e,t,r);return n=n||{},i?this.sequelize.query(i,n):c.resolve()},h.prototype.createFunction=function(e,t,r,n,i,o){var s=this.QueryGenerator.createFunction(e,t,r,n,i,o);return o=o||{},s?this.sequelize.query(s,o):c.resolve()},h.prototype.dropFunction=function(e,t,r){var n=this.QueryGenerator.dropFunction(e,t);return r=r||{},n?this.sequelize.query(n,r):c.resolve()},h.prototype.renameFunction=function(e,t,r,n){var i=this.QueryGenerator.renameFunction(e,t,r);return n=n||{},i?this.sequelize.query(i,n):c.resolve()},h.prototype.quoteIdentifier=function(e,t){return this.QueryGenerator.quoteIdentifier(e,t)},h.prototype.quoteTable=function(e){return this.QueryGenerator.quoteTable(e)},h.prototype.quoteIdentifiers=function(e,t){return this.QueryGenerator.quoteIdentifiers(e,t)},h.prototype.escape=function(e){return this.QueryGenerator.escape(e)},h.prototype.setAutocommit=function(e,t,r){if(!(e&&e instanceof l))throw new Error("Unable to set autocommit for a transaction without transaction object!");if(e.parent)return c.resolve();r=i.assign({},r,{transaction:e.parent||e});var n=this.QueryGenerator.setAutocommitQuery(t,{parent:e.parent});return n?this.sequelize.query(n,r):c.resolve()},h.prototype.setIsolationLevel=function(e,t,r){if(!(e&&e instanceof l))throw new Error("Unable to set isolation level for a transaction without transaction object!");if(e.parent)return c.resolve();r=i.assign({},r,{transaction:e.parent||e});var n=this.QueryGenerator.setIsolationLevelQuery(t,{parent:e.parent});return n?this.sequelize.query(n,r):c.resolve()},h.prototype.startTransaction=function(e,t){if(!(e&&e instanceof l))throw new Error("Unable to start a transaction without transaction object!");t=i.assign({},t,{transaction:e.parent||e}),t.transaction.name=e.parent?e.name:void 0;var r=this.QueryGenerator.startTransactionQuery(e);return this.sequelize.query(r,t)},h.prototype.deferConstraints=function(e,t){t=i.assign({},t,{transaction:e.parent||e});var r=this.QueryGenerator.deferConstraintsQuery(t);return r?this.sequelize.query(r,t):c.resolve()},h.prototype.commitTransaction=function(e,t){if(!(e&&e instanceof l))throw new Error("Unable to commit a transaction without transaction object!");if(e.parent)return c.resolve();t=i.assign({},t,{transaction:e.parent||e,supportsSearchPath:!1});var r=this.QueryGenerator.commitTransactionQuery(e),n=this.sequelize.query(r,t);return e.finished="commit",n},h.prototype.rollbackTransaction=function(e,t){if(!(e&&e instanceof l))throw new Error("Unable to rollback a transaction without transaction object!");t=i.assign({},t,{transaction:e.parent||e,supportsSearchPath:!1}),t.transaction.name=e.parent?e.name:void 0;var r=this.QueryGenerator.rollbackTransactionQuery(e),n=this.sequelize.query(r,t);return e.finished="rollback",n},e.exports=h},function(e,t,r){"use strict";var n=r(201),i=r(7),o=r(194),s=r(3),a=r(50),u=r(4),l=r(85),c=r(115),p=r(116),h=r(31),d=r(14),f=r(6),m=r(5),y=r(48),g=r(49),E=r(83),v=r(0),b=function(e,t,i,o){var a;if(1===arguments.length&&"object"==typeof e)o=e,a=v.pick(o,"host","port","database","username","password");else if(1===arguments.length&&"string"==typeof e||2===arguments.length&&"object"==typeof t){a={},o=t||{};var u=n.parse(arguments[0]);u.pathname&&(a.database=u.pathname.replace(/^\//,"")),o.dialect=u.protocol.replace(/:$/,""),o.host=u.hostname,u.port&&(o.port=u.port),u.auth&&(a.username=u.auth.split(":")[0],a.password=u.auth.split(":")[1])}else o=o||{},a={database:e,username:t,password:i};if(b.runHooks("beforeInit",a,o),this.options=s._.extend({dialect:"mysql",dialectModulePath:null,host:"localhost",protocol:"tcp",define:{},query:{},sync:{},timezone:"+00:00",logging:console.log,omitNull:!1,native:!1,replication:!1,ssl:void 0,pool:{},quoteIdentifiers:!0,hooks:{},retry:{max:5,match:["SQLITE_BUSY: database is locked"]},transactionType:h.TYPES.DEFERRED,isolationLevel:h.ISOLATION_LEVELS.REPEATABLE_READ,databaseVersion:0,typeValidation:!1,benchmark:!1},o||{}),"postgresql"===this.options.dialect&&(this.options.dialect="postgres"),"sqlite"===this.options.dialect&&"+00:00"!==this.options.timezone)throw new Error("Setting a custom timezone is not supported by SQLite, dates are always returned as UTC. Please remove the custom timezone parameter.");!0===this.options.logging&&(console.log("DEPRECATION WARNING: The logging-option should be either a function or false. Default: console.log"),this.options.logging=console.log),this.options.hooks=this.replaceHookAliases(this.options.hooks),(["",null,!1].indexOf(a.password)>-1||void 0===a.password)&&(a.password=null),this.config={database:a.database,username:a.username,password:a.password,host:a.host||this.options.host,port:a.port||this.options.port,pool:this.options.pool,protocol:this.options.protocol,native:this.options.native,ssl:this.options.ssl,replication:this.options.replication,dialectModulePath:this.options.dialectModulePath,keepDefaultTimezone:this.options.keepDefaultTimezone,dialectOptions:this.options.dialectOptions};var l;switch(this.getDialect()){case"mariadb":l=r(86);break;case"mssql":l=r(90);break;case"mysql":l=r(46);break;case"postgres":l=r(103);break;case"sqlite":l=r(110);break;default:throw new Error("The dialect "+this.getDialect()+" is not supported. Supported dialects: mariadb, mssql, mysql, postgres, and sqlite.")}this.dialect=new l(this),this.dialect.QueryGenerator.typeValidation=o.typeValidation,this.models={},this.modelManager=new c(this),this.connectionManager=this.dialect.connectionManager,this.importCache={},this.test={$trackRunningQueries:!1,$runningQueries:0,trackRunningQueries:function(){this.$trackRunningQueries=!0},verifyNoRunningQueries:function(){if(this.$runningQueries>0)throw new Error("Expected 0 running queries. "+this.$runningQueries+" queries still running")}},b.runHooks("afterInit",this)};b.version=r(119).version,b.options={hooks:{}},b.prototype.Sequelize=b,b.prototype.Utils=b.Utils=s,b.prototype.Promise=b.Promise=m,b.prototype.QueryTypes=b.QueryTypes=d,b.prototype.Validator=b.Validator=r(44),b.prototype.Model=b.Model=a,b.DataTypes=u;for(var A in u)b[A]=u[A];Object.defineProperty(b.prototype,"connectorManager",{get:function(){return this.transactionManager.getConnectorManager()}}),b.prototype.Transaction=b.Transaction=h,b.prototype.Deferrable=b.Deferrable=l,b.prototype.Instance=b.Instance=g,b.prototype.Association=b.Association=E,y.applyTo(b),b.prototype.Error=b.Error=f.BaseError,b.prototype.ValidationError=b.ValidationError=f.ValidationError,b.prototype.ValidationErrorItem=b.ValidationErrorItem=f.ValidationErrorItem,b.prototype.DatabaseError=b.DatabaseError=f.DatabaseError,b.prototype.TimeoutError=b.TimeoutError=f.TimeoutError,b.prototype.UniqueConstraintError=b.UniqueConstraintError=f.UniqueConstraintError,b.prototype.ExclusionConstraintError=b.ExclusionConstraintError=f.ExclusionConstraintError,b.prototype.ForeignKeyConstraintError=b.ForeignKeyConstraintError=f.ForeignKeyConstraintError,b.prototype.ConnectionError=b.ConnectionError=f.ConnectionError,b.prototype.ConnectionRefusedError=b.ConnectionRefusedError=f.ConnectionRefusedError,b.prototype.AccessDeniedError=b.AccessDeniedError=f.AccessDeniedError,b.prototype.HostNotFoundError=b.HostNotFoundError=f.HostNotFoundError,b.prototype.HostNotReachableError=b.HostNotReachableError=f.HostNotReachableError,b.prototype.InvalidConnectionError=b.InvalidConnectionError=f.InvalidConnectionError,b.prototype.ConnectionTimedOutError=b.ConnectionTimedOutError=f.ConnectionTimedOutError,b.prototype.InstanceError=b.InstanceError=f.InstanceError,b.prototype.EmptyResultError=b.EmptyResultError=f.EmptyResultError,b.prototype.refreshTypes=function(){this.connectionManager.refreshTypeParser(u)},b.prototype.getDialect=function(){return this.options.dialect},b.prototype.getQueryInterface=function(){return this.queryInterface=this.queryInterface||new p(this),this.queryInterface},b.prototype.define=function(e,t,r){r=r||{};var n=this.options;n.define&&(r=s.merge(v.cloneDeep(n.define),r)),r=s.merge({name:{plural:s.inflection.pluralize(e),singular:s.inflection.singularize(e)},indexes:[],omitNul:n.omitNull},r),this.isDefined(e)&&this.modelManager.removeModel(this.modelManager.getModel(e)),r.sequelize=this,r.modelName=e,this.runHooks("beforeDefine",t,r),e=r.modelName,delete r.modelName;var i=new a(e,t,r);return i=i.init(this.modelManager),this.modelManager.addModel(i),this.runHooks("afterDefine",i),i},b.prototype.model=function(e){if(!this.isDefined(e))throw new Error(e+" has not been defined");return this.modelManager.getModel(e)},b.prototype.isDefined=function(e){return 0!==this.modelManager.models.filter(function(t){return t.name===e}).length},b.prototype.import=function(e){if(i.normalize(e)!==i.resolve(e)){var t=s.stack()[1].getFileName(),r=i.dirname(t);e=i.resolve(r,e)}if(!this.importCache[e]){var n=arguments.length>1?arguments[1]:!function(){var e=new Error('Cannot find module "."');throw e.code="MODULE_NOT_FOUND",e}();"object"==typeof n&&(n=n.default),this.importCache[e]=n(this,u)}return this.importCache[e]},b.prototype.query=function(e,t){if(arguments.length>2)throw new Error("Sequelize.query was refactored to only use the parameters `sql` and `options`. Please read the changelog about BC.");var r=this;if(t=v.assign({},this.options.query,t),t.instance&&!t.model&&(t.model=t.instance.Model),t.model&&t.mapToModel&&!s._.isEmpty(t.model.fieldAttributeMap)&&(t.fieldMap=t.model.fieldAttributeMap),"object"==typeof e){if(void 0!==e.values){if(void 0!==t.replacements)throw new Error("Both `sql.values` and `options.replacements` cannot be set at the same time");t.replacements=e.values}if(void 0!==e.bind){if(void 0!==t.bind)throw new Error("Both `sql.bind` and `options.bind` cannot be set at the same time");t.bind=e.bind}void 0!==e.query&&(e=e.query)}if(e=e.trim(),t.instance||t.model||(t.raw=!0),t.replacements&&t.bind)throw new Error("Both `replacements` and `bind` cannot be set at the same time");t.replacements&&(e=Array.isArray(t.replacements)?s.format([e].concat(t.replacements),this.options.dialect):s.formatNamedParameters(e,t.replacements,this.options.dialect));var n;if(t.bind){var i=r.dialect.Query.formatBindParameters(e,t.bind,this.options.dialect);e=i[0],n=i[1]}if(t=v.defaults(t,{logging:this.options.hasOwnProperty("logging")?this.options.logging:console.log,searchPath:this.options.hasOwnProperty("searchPath")?this.options.searchPath:"DEFAULT"}),void 0===t.transaction&&b.cls&&(t.transaction=b.cls.get("transaction")),t.type||(t.model||t.nest||t.plain?t.type=d.SELECT:t.type=d.RAW),t.transaction&&t.transaction.finished){var a=new Error(t.transaction.finished+" has been called on this transaction("+t.transaction.id+"), you can no longer use it. (The rejected query is attached as the 'sql' property of this error)");return a.sql=e,m.reject(a)}return this.test.$trackRunningQueries&&this.test.$runningQueries++,r.dialect.supports.searchPath&&this.options.dialectOptions&&this.options.dialectOptions.prependSearchPath&&!1!==t.supportsSearchPath?t.searchPath||(t.searchPath="DEFAULT"):delete t.searchPath,m.resolve(t.transaction?t.transaction.connection:r.connectionManager.getConnection(t)).then(function(i){var a=new r.dialect.Query(i,r,t);return o(function(){return a.run(e,n).finally(function(){if(!t.transaction)return r.connectionManager.releaseConnection(i)})},s._.extend(r.options.retry,t.retry||{}))}).finally(function(){r.test.$trackRunningQueries&&r.test.$runningQueries--})},b.prototype.set=function(e,t){var r;if(t=s._.extend({},this.options.set,"object"==typeof t&&t||{}),-1===["mysql","mariadb"].indexOf(this.options.dialect))throw new Error("sequelize.set is only supported for mysql");if(!(t.transaction&&t.transaction instanceof h))throw new TypeError("options.transaction is required");return t.raw=!0,t.plain=!0,t.type="SET",r="SET "+s._.map(e,function(e,t){return"@"+t+" := "+("string"==typeof e?'"'+e+'"':e)}).join(", "),this.query(r,t)},b.prototype.escape=function(e){return this.getQueryInterface().escape(e)},b.prototype.createSchema=function(e,t){return this.getQueryInterface().createSchema(e,t)},b.prototype.showAllSchemas=function(e){return this.getQueryInterface().showAllSchemas(e)},b.prototype.dropSchema=function(e,t){return this.getQueryInterface().dropSchema(e,t)},b.prototype.dropAllSchemas=function(e){return this.getQueryInterface().dropAllSchemas(e)},b.prototype.sync=function(e){var t=this;return e=v.clone(e)||{},e.hooks=void 0===e.hooks||!!e.hooks,e.logging=void 0!==e.logging&&e.logging,e=s._.defaults(e,this.options.sync,this.options),e.match&&!e.match.test(this.config.database)?m.reject(new Error("Database does not match sync match parameter")):m.try(function(){if(e.hooks)return t.runHooks("beforeBulkSync",e)}).then(function(){if(e.force)return t.drop(e)}).then(function(){var r=[];return t.modelManager.forEachModel(function(e){e&&r.push(e)}),m.each(r,function(t){return t.sync(e)})}).then(function(){if(e.hooks)return t.runHooks("afterBulkSync",e)}).return(t)},b.prototype.truncate=function(e){var t=[];this.modelManager.forEachModel(function(e){e&&t.push(e)},{reverse:!1});var r=function(t){return t.truncate(e)};return e&&e.cascade?m.each(t,r):m.map(t,r)},b.prototype.drop=function(e){var t=[];return this.modelManager.forEachModel(function(e){e&&t.push(e)},{reverse:!1}),m.each(t,function(t){return t.drop(e)})},b.prototype.authenticate=function(e){return this.query("SELECT 1+1 AS result",s._.assign({raw:!0,plain:!0},e)).return()},b.prototype.databaseVersion=function(e){return this.getQueryInterface().databaseVersion(e)},b.prototype.validate=b.prototype.authenticate,b.fn=b.prototype.fn=function(e){return new s.fn(e,s.sliceArgs(arguments,1))},b.col=b.prototype.col=function(e){return new s.col(e)},b.cast=b.prototype.cast=function(e,t){return new s.cast(e,t)},b.literal=b.asIs=b.prototype.asIs=b.prototype.literal=function(e){return new s.literal(e)},b.and=b.prototype.and=function(){return{$and:s.sliceArgs(arguments)}},b.or=b.prototype.or=function(){return{$or:s.sliceArgs(arguments)}},b.json=b.prototype.json=function(e,t){return new s.json(e,t)},b.where=b.condition=b.prototype.condition=b.prototype.where=function(e,t,r){return new s.where(e,t,r)},b.prototype.transaction=function(e,t){"function"==typeof e&&(t=e,e=void 0);var r=new h(this,e),n=b.cls;if(t){var i=function(e,i){r.prepareEnvironment().then(function(){n&&(t=n.bind(t));var i=t(r);if(!i||!i.then)throw new Error("You need to return a promise chain/thenable to the sequelize.transaction() callback");return i.then(function(t){return r.commit().then(function(){e(t)})})}).catch(function(e){if(!r.finished)return r.rollback().finally(function(){i(e)});i(e)})};return n&&(i=n.bind(i,n.createContext())),new m(i)}return r.prepareEnvironment().return(r)},b.prototype.log=function(){var e,t=s.sliceArgs(arguments),r=s._.last(t);r&&s._.isPlainObject(r)&&r.hasOwnProperty("logging")?(e=r,t.splice(t.length-1,1)):e=this.options,e.logging&&(!0===e.logging&&(console.log("DEPRECATION WARNING: The logging-option should be either a function or false. Default: console.log"),e.logging=console.log),(this.options.benchmark||e.benchmark)&&e.logging===console.log&&(t=[t[0]+" Elapsed time: "+t[1]+"ms"]),e.logging.apply(null,t))},b.prototype.close=function(){this.connectionManager.close()},b.prototype.normalizeDataType=function(e){var t="function"==typeof e?new e:e,r=this.dialect.DataTypes||{};return r[t.key]&&(t=r[t.key].extend(t)),t instanceof u.ARRAY&&r[t.type.key]&&(t.type=r[t.type.key].extend(t.type)),t},b.prototype.normalizeAttribute=function(e){if(s._.isPlainObject(e)||(e={type:e}),!e.type)return e;if(e.type=this.normalizeDataType(e.type),e.hasOwnProperty("defaultValue")&&("function"!=typeof e.defaultValue||e.defaultValue!==u.NOW&&e.defaultValue!==u.UUIDV1&&e.defaultValue!==u.UUIDV4||(e.defaultValue=new e.defaultValue)),e.type instanceof u.ENUM&&(e.values?e.type.values=e.type.options.values=e.values:e.values=e.type.values,!e.values.length))throw new Error("Values for ENUM have not been defined.");return e},e.exports=m.Sequelize=b,e.exports.Sequelize=b,e.exports.default=b},function(e,t,r){"use strict";function n(e,t,r){if(r.deprecated){var n=e instanceof r.deprecated||Object.prototype.toString.call(e)===Object.prototype.toString.call(r.deprecated.call());if(n){var i=a.format('%s should not be of type "%s"',a.inspect(e),r.deprecated.name);console.log("DEPRECATION WARNING:",r.deprecationWarning||i)}return n}}function i(e,t){if(e instanceof t||Object.prototype.toString.call(e)===Object.prototype.toString.call(t.call()))return!0;throw new Error(a.format("The parameter (value: %s) is no %s.",e,t.name))}function o(e,t,r){if(r=s.extend({deprecated:!1,index:null,method:null,optional:!1},r||{}),!e&&r.optional)return!0;if(void 0===e)throw new Error("No value has been passed.");if(void 0===t)throw new Error("No expectation has been passed.");return n(e,t,r)||i(e,t,r)}var s=r(0),a=r(8);e.exports=o},function(e,t){e.exports={_args:[[{raw:"sequelize@^3.30.4",scope:null,escapedName:"sequelize",name:"sequelize",rawSpec:"^3.30.4",spec:">=3.30.4 <4.0.0",type:"range"},"C:\\Applications\\analytics"]],_from:"sequelize@>=3.30.4 <4.0.0",_id:"sequelize@3.30.4",_inCache:!0,_location:"/sequelize",_nodeVersion:"6.9.1",_npmOperationalInternal:{host:"packages-18-east.internal.npmjs.com",tmp:"tmp/sequelize-3.30.4.tgz_1490624934959_0.9157454646192491"},_npmUser:{name:"janaameier",email:"janzeh@gmail.com"},_npmVersion:"3.10.8",_phantomChildren:{},_requested:{raw:"sequelize@^3.30.4",scope:null,escapedName:"sequelize",name:"sequelize",rawSpec:"^3.30.4",spec:">=3.30.4 <4.0.0",type:"range"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/sequelize/-/sequelize-3.30.4.tgz",_shasum:"bda2df1e31854b099e4149a111e9fc0a5ca1d1a4",_shrinkwrap:null,_spec:"sequelize@^3.30.4",_where:"C:\\Applications\\analytics",author:{name:"Sascha Depold",email:"sascha@depold.com"},bugs:{url:"https://github.com/sequelize/sequelize/issues"},contributors:[{name:"Sascha Depold",email:"sascha@depold.com"},{name:"Jan Aagaard Meier",email:"janzeh@gmail.com,jmei@itu.dk"},{name:"Daniel Durante",email:"me@danieldurante.com"},{name:"Mick Hansen",email:"mick.kasper.hansen@gmail.com"}],dependencies:{bluebird:"^3.3.4",depd:"^1.1.0",dottie:"^1.0.0","generic-pool":"2.4.2",inflection:"^1.6.0",lodash:"4.12.0",moment:"^2.13.0","moment-timezone":"^0.5.4","retry-as-promised":"^2.0.0",semver:"^5.0.1",shimmer:"1.1.0","terraformer-wkt-parser":"^1.1.0","toposort-class":"^1.0.1",uuid:"^3.0.0",validator:"^5.2.0",wkx:"0.2.0"},description:"Multi dialect ORM for Node.JS/io.js",devDependencies:{chai:"^3.5.0","chai-as-promised":"^5.1.0","chai-datetime":"^1.4.0","chai-spies":"^0.7.0",commander:"^2.6.0","continuation-local-storage":"^3.1.4","cross-env":"^2.0.1",dox:"~0.8.0",git:"^0.1.5",hints:"^0.2.0",istanbul:"^0.4.3",jshint:"^2.9.2","lcov-result-merger":"^1.2.0",mocha:"^2.4.2",mysql:"~2.10.1",pg:"^4.4.6","pg-hstore":"^2.3.1","pg-native":"^1.8.0","pg-types":"^1.11.0",rimraf:"^2.5.4",sinon:"^1.17.4","sinon-chai":"^2.8.0",sqlite3:"^3.1.4",tedious:"^1.13.2","uuid-validate":"^0.0.2",watchr:"~2.4.11"},directories:{},dist:{shasum:"bda2df1e31854b099e4149a111e9fc0a5ca1d1a4",tarball:"https://registry.npmjs.org/sequelize/-/sequelize-3.30.4.tgz"},engines:{node:">=0.6.21"},gitHead:"0d1a558ae182062d264eecd3cdfa1e962b06fb8c",homepage:"https://github.com/sequelize/sequelize#readme",keywords:["mysql","sqlite","postgresql","postgres","mssql","orm","nodejs","object relational mapper"],license:"MIT",main:"index",maintainers:[{name:"sdepold",email:"sascha@depold.com"},{name:"durango",email:"me@danieldurante.com"},{name:"mickhansen",email:"mick.kasper.hansen@gmail.com"},{name:"janaameier",email:"janzeh@gmail.com"}],name:"sequelize",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+https://github.com/sequelize/sequelize.git"},scripts:{"build-docker":"docker-compose build",cover:"rimraf coverage && npm run teaser && npm run cover-unit && npm run cover-integration && npm run merge-coverage","cover-integration":"cross-env COVERAGE=true node_modules/.bin/istanbul cover ./node_modules/mocha/bin/_mocha --report lcovonly -- -t 60000 --ui tdd \"test/integration/**/*.test.js\" && node -e \"require('fs').renameSync('coverage/lcov.info', 'coverage/integration.info')\"","cover-unit":"cross-env COVERAGE=true node_modules/.bin/istanbul cover ./node_modules/mocha/bin/_mocha --report lcovonly -- -t 30000 --ui tdd \"test/unit/**/*.test.js\" && node -e \"require('fs').renameSync('coverage/lcov.info', 'coverage/unit.info')\"",docs:"node docs/docs-generator.js",jshint:"jshint lib test","merge-coverage":'lcov-result-merger "coverage/*.info" "coverage/lcov.info"',sscce:'docker-compose run sequelize /bin/sh -c "node sscce.js"',"sscce-mysql":"cross-env DIALECT=mysql npm run sscce","sscce-postgres":"cross-env DIALECT=postgres npm run sscce","sscce-sqlite":"cross-env DIALECT=sqlite npm run sscce",teaser:"echo ''; node -pe \"Array(20 + process.env.DIALECT.length + 3).join('#')\"; echo '# Running tests for '$DIALECT' #'; node -pe \"Array(20 + process.env.DIALECT.length + 3).join('#')\";echo '';",test:"npm run jshint && npm run teaser && npm run test-unit && npm run test-integration","test-all":"npm run test-mysql && npm run test-sqlite && npm run test-postgres && npm run test-postgres-native && npm run test-mariadb && npm run test-mssql","test-docker":'docker-compose run sequelize /bin/sh -c "npm run test-all"',"test-docker-integration":'docker-compose run sequelize /bin/sh -c "npm run test-integration-all"',"test-docker-unit":'docker-compose run sequelize /bin/sh -c "npm run test-unit-all"',"test-integration":'mocha --globals setImmediate,clearImmediate --ui tdd --check-leaks --colors -t 30000 --reporter spec "test/integration/**/*.test.js"',"test-integration-all":"npm run test-integration-mysql && npm run test-integration-postgres && npm run test-integration-postgres-native && npm run test-integration-mssql && npm run test-integration-sqlite && npm run test-integration-mariadb","test-integration-mariadb":"cross-env DIALECT=mariadb npm run test-integration","test-integration-mssql":"cross-env DIALECT=mssql npm run test-integration","test-integration-mysql":"cross-env DIALECT=mysql npm run test-integration","test-integration-postgres":"cross-env DIALECT=postgres npm run test-integration","test-integration-postgres-native":"cross-env DIALECT=postgres-native npm run test-integration","test-integration-sqlite":"cross-env DIALECT=sqlite npm run test-integration","test-mariadb":"cross-env DIALECT=mariadb npm test","test-mssql":"cross-env DIALECT=mssql npm test","test-mysql":"cross-env DIALECT=mysql npm test","test-pgsql":"npm run test-postgres","test-postgres":"cross-env DIALECT=postgres npm test","test-postgres-native":"cross-env DIALECT=postgres-native npm test","test-postgresn":"npm run test-postgres-native","test-sqlite":"cross-env DIALECT=sqlite npm test","test-unit":'mocha --globals setImmediate,clearImmediate --ui tdd --check-leaks --colors -t 30000 --reporter spec "test/unit/**/*.js"',"test-unit-all":"npm run test-unit-mysql && npm run test-unit-postgres && npm run test-unit-postgres-native && npm run test-unit-mssql && npm run test-unit-sqlite && npm run test-unit-mariadb","test-unit-mariadb":"cross-env DIALECT=mariadb npm run test-unit","test-unit-mssql":"cross-env DIALECT=mssql npm run test-unit","test-unit-mysql":"cross-env DIALECT=mysql npm run test-unit","test-unit-postgres":"cross-env DIALECT=postgres npm run test-unit","test-unit-postgres-native":"cross-env DIALECT=postgres-native npm run test-unit","test-unit-sqlite":"cross-env DIALECT=sqlite npm run test-unit"},version:"3.30.4"}},function(e,t,r){"use strict";(function(t){var n=r(7);r(45);e.exports={devtool:"#inline-source-map",entry:{app:["./client/app/main.js"]},output:{path:n.resolve(t,"..","server","public","app"),publicPath:"/app/",filename:"[name].js",chunkFilename:"[chunkhash].js"},module:{noParse:/es6-promise\.js$/,rules:[{test:/\.css$/,loaders:["style-loader","css-loader"]},{test:/\.js$/,loader:"babel-loader",exclude:[/node_modules/,/vendor/]},{test:/\.gif$/,loader:"url-loader",options:{name:"images/[name]-[hash:6].[ext]",limit:1e4}},{test:/\.png$/,loader:"url-loader",options:{name:"images/[name]-[hash:6].[ext]",limit:1e4}},{test:/\.jpg$/,loader:"file-loader",options:{name:"images/[name]-[hash:6].[ext]"}},{test:/\.(woff2?|svg)$/,loader:"url-loader",options:{limit:1e4,prefix:"font/"}},{test:/\.(ttf|eot)$/,loader:"file-loader",options:{prefix:"font/"}}]},resolve:{extensions:[".vue",".js",".json"],mainFiles:["index"],alias:{images:n.resolve(t,"..","client","images"),vue$:"vue/dist/vue.common.js"}},performance:{hints:!1},plugins:[]}}).call(t,"build")},function(e,t,r){"use strict";var n=(r(7),r(45)),i=r(205),o=r(120);o.entry.app.unshift("webpack-hot-middleware/client"),e.exports=i(o,{devtool:"#inline-source-map",module:{rules:[{test:/\.s[c|a]ss$/,loaders:["style-loader","css-loader","postcss-loader","sass-loader"]},{test:/\.vue$/,loader:"vue-loader"}]},performance:{hints:!1},plugins:[new n.HotModuleReplacementPlugin,new n.NoErrorsPlugin]})},function(e,t,r){"use strict";var n=(r(2),r(1),r(9)),i=(r(0),r(17).meta_report),o=r(17).meta_subreport,s=(r(11),r(75)),a={user:"partnerapi@mediamath.com",password:"h0n348ad93r",api_key:"4d56c81d0d6b14f43e28a0d7fb0caf35"};new s.T1Connection(a);e.exports={settings:{name:"report_type",version:1,namespace:"report_type",rest:!0,ws:!0,graphql:!0,permission:n.PERM_LOGGEDIN,role:"user",modelPropFilter:"code type address name description status lastCommunication createdAt updatedAt"},actions:{find:{cache:!0,handler:function(e){return e.queryPageSort(query).exec().then(function(e){})}},list:{cache:!0,handler:function(e){return e.params.sub_report?(console.log(e.params),o.findAll(e.params).then(function(e){return e}).catch(function(e){console.log(e)})):i.findAll().then(function(e){return e}).catch(function(e){console.log(e)})}},get:{cache:!0,handler:function(e){if(e.params.categories)return new Promise(function(e,t){e(global_data.top10Categories())}).then(function(e){return e}).catch(function(e){console.log("error",e)})}},create:function(e){return{}},update:function(e){return{}},remove:function(e){return{}}},methods:{validateParams:function(e,t){if((t||e.hasParam("name"))&&e.validateParam("name").trim().notEmpty(e.t("app:DeviceNameCannotBeBlank")).end(),(t||e.hasParam("status"))&&e.validateParam("status").isNumber(),e.validateParam("description").trim().end(),e.validateParam("address").trim().end(),e.validateParam("type").trim().end(),e.hasValidationErrors())throw e.errorBadRequest(n.ERR_VALIDATION_ERROR,e.validationErrors)}},init:function(e){},socket:{afterConnection:function(e,t){}}}},function(e,t,r){"use strict";var n=(r(2),r(1),r(9)),i=(r(0),r(17).product);r(11);e.exports={settings:{name:"product",version:1,namespace:"products",rest:!0,ws:!0,graphql:!0,permission:n.PERM_LOGGEDIN,role:"user",collection:i,modelPropFilter:"code type address name description status lastCommunication createdAt updatedAt"},actions:{find:{cache:!0,handler:function(e){return e.queryPageSort(query).exec().then(function(e){})}},list:{cache:!0,handler:function(e){return e.params.q?(console.log("searching"),i.search(e.params).then(function(e){return e}).catch(function(e){console.log(e)})):(console.log("here",e.params),i.findAll(e.params).then(function(e){return e}).catch(function(e){console.log("err",e)}))}},get:{cache:!0,handler:function(e){if(e.params.categories)return new Promise(function(e,t){e(global_data.top10Categories())}).then(function(e){return e}).catch(function(e){console.log("error",e)})}},create:function(e){return{}},update:function(e){return{}},remove:function(e){return{}}},methods:{validateParams:function(e,t){if((t||e.hasParam("name"))&&e.validateParam("name").trim().notEmpty(e.t("app:DeviceNameCannotBeBlank")).end(),(t||e.hasParam("status"))&&e.validateParam("status").isNumber(),e.validateParam("description").trim().end(),e.validateParam("address").trim().end(),e.validateParam("type").trim().end(),e.hasValidationErrors())throw e.errorBadRequest(n.ERR_VALIDATION_ERROR,e.validationErrors)}},init:function(e){},socket:{afterConnection:function(e,t){}}}},function(e,t,r){"use strict";var n=(r(2),r(1),r(9)),i=(r(0),r(17).query_template);r(11);e.exports={settings:{name:"query_templates",version:1,namespace:"query_templates",rest:!0,ws:!0,graphql:!0,permission:n.PERM_LOGGEDIN,role:"user",modelPropFilter:"code type address name description status lastCommunication createdAt updatedAt"},actions:{find:{cache:!0,handler:function(e){return e.queryPageSort(query).exec().then(function(e){})}},list:{cache:!0,handler:function(e){return i.findAll().then(function(e){return e}).catch(function(e){console.log("err",e)})}}},methods:{validateParams:function(e,t){if((t||e.hasParam("name"))&&e.validateParam("name").trim().notEmpty(e.t("app:DeviceNameCannotBeBlank")).end(),(t||e.hasParam("status"))&&e.validateParam("status").isNumber(),e.validateParam("description").trim().end(),e.validateParam("address").trim().end(),e.validateParam("type").trim().end(),e.hasValidationErrors())throw e.errorBadRequest(n.ERR_VALIDATION_ERROR,e.validationErrors)}},init:function(e){},socket:{afterConnection:function(e,t){}}}},function(e,t,r){"use strict";var n=(r(2),r(1),r(9)),i=(r(0),r(17).report_requests);r(11);e.exports={settings:{name:"report_requests",version:1,namespace:"report_requests",rest:!0,ws:!0,graphql:!0,permission:n.PERM_LOGGEDIN,role:"user",modelPropFilter:"code type address name description status lastCommunication createdAt updatedAt"},actions:{find:{cache:!0,handler:function(e){return e.queryPageSort(query).exec().then(function(e){})}},list:{cache:!0,handler:function(e){return e.params.limit=10,e.params.order=[["request_date","DESC"]],i.findAll(e.params).then(function(e){return e}).catch(function(e){console.log(e)})}},get:{cache:!0,handler:function(e){if(e.params.categories)return new Promise(function(e,t){e(global_data.top10Categories())}).then(function(e){return e}).catch(function(e){console.log("error",e)})}},create:function(e){return{}},update:function(e){return{}},remove:function(e){return{}}},methods:{},init:function(e){},socket:{afterConnection:function(e,t){}}}},function(e,t,r){"use strict";var n=(r(2),r(1),r(9)),i=r(0),o=r(33),s=void 0;e.exports={settings:{name:"session",version:1,namespace:"session",rest:!0,ws:!0,graphql:!0,permission:n.PERM_LOGGEDIN,role:"user"},actions:{me:function(e){return Promise.resolve(e.user).then(function(e){return s.toJSON(e)})},onlineUsers:function(e){return Promise.resolve().then(function(){return s.toJSON(i.map(o.userSockets,function(e){return e.request.user}))})}},init:function(e){s=this.services("persons")},graphql:{query:"\n\t\t\tme: Person\n\t\t\tonlineUsers: [Person]\n\t\t",mutation:"\n\t\t",resolvers:{Query:{me:"me",onlineUsers:"onlineUsers"}}}}},function(e,t,r){"use strict";var n=r(7),i=r(61),o=r(81);e.exports={app:{title:i.title,version:i.version,description:i.description,keywords:i.keywords.join(","),url:"http://localhost:"+(process.env.PORT||3e3)+"/",contactEmail:"hello@vem-app.com"},ip:process.env.NODE_IP||"0.0.0.0",port:process.env.PORT||3e3,rootPath:global.rootPath,dataFolder:n.join(global.rootPath,"data"),uploadLimit:2097152,sessions:{cookie:{maxAge:6048e5,httpOnly:!0,secure:!1},name:"sessionId",sessionSecret:"cvsoSsx324ntp",collection:"sessions"},test:!1,db:{uri:process.env.MONGO_URI||"mongodb://localhost/"+i.config.dbName+"-dev",options:{user:"",pass:"",server:{socketOptions:{keepAlive:1}}}},redis:{enabled:!1,uri:process.env.REDIS_URI||"redis://localhost:6379",options:null},sequelize:{adama:new o("adama_prod","analytics","CQvF8dZzw29Yrny",{host:"ewr-t1dbqa-x1.mediamath.com",dialect:"postgres",pool:{max:5,min:0,idle:1e4},define:{freezeTableName:!0},logging:console.log}),dag:new o("Dag","mm_analytics","Gar1h_m3ren6h1",{host:"darkplace.cn3mythbkvex.us-east-1.rds.amazonaws.com",dialect:"postgres",port:5432,pool:{max:10,min:0,idle:1e4},define:{freezeTableName:!0},logging:console.log})},cacheTimeout:300,mailer:{from:"noreply@vem-app.com"},features:{disableSignUp:!1,verificationRequired:!0},authKeys:{google:{clientID:null,clientSecret:null},facebook:{clientID:null,clientSecret:null},github:{clientID:null,clientSecret:null},twitter:{clientID:null,clientSecret:null}},logging:{console:{enabled:!1,level:"info"},file:{enabled:!1,path:n.join(global.rootPath,"logs"),level:"info",json:!1,exceptionFile:!0},graylog:{enabled:!1},papertrail:{enabled:!1,host:null,port:null,level:"debug",program:"vem"},logentries:{enabled:!1,token:null},loggly:{enabled:!1,token:null,subdomain:null},logsene:{enabled:!1,token:null},logzio:{enabled:!1,token:null}},agendaTimer:"one minute"}},function(e,t,r){"use strict";var n=r(61);e.exports={app:{},db:{uri:process.env.MONGO_URI||"mongodb://localhost/"+n.config.dbName,options:{user:process.env.MONGO_USERNAME||"",pass:process.env.MONGO_PASSWORD||""}}}},function(e,t,r){"use strict";r(2),r(1),r(11),r(13),r(160)},function(e,t,r){"use strict";var n=r(2),i=(r(1),r(10)),o=r(7),s=r(13),a=r(12);e.exports=function(e){function t(e){return e.keys().map(function(t){n.info("  Loading passport strategy file "+o.basename(t)+"...");var r=e(t);return r(),r})}e.use(i.initialize()),e.use(i.session()),i.serializeUser(function(e,t){return t(null,e.id)}),i.deserializeUser(function(e,t){a.findOne({_id:e},"-password",function(e,r){return e?t(e):1!==r.status?t(null,!1):t(null,r)})}),n.info(""),n.info(s.bold("Search passport strategies..."));t(r(157))}},function(e,t,r){"use strict";var n=r(10),i=r(190).Strategy,o=r(12);e.exports=function(){n.use(new i({passReqToCallback:!0},function(e,t,r){return o.findOne({apiKey:t},function(t,n){return t?r(t):n?n.verified?1!==n.status?r(null,!1,{message:e.t("UserDisabledOrDeleted")}):r(null,n):r(null,!1,{message:e.t("PleaseActivateAccount")}):r(null,!1,{message:e.t("UnknowAPIKey")})})}))}},function(e,t,r){"use strict";var n=(r(2),r(1)),i=r(22),o=r(10),s=r(186).Strategy;r(12);e.exports=function(){n.authKeys.facebook.clientID&&n.authKeys.facebook.clientSecret&&o.use("facebook",new s({clientID:n.authKeys.facebook.clientID,clientSecret:n.authKeys.facebook.clientSecret,callbackURL:"/auth/facebook/callback",profileFields:["name","email","link","locale","timezone"],passReqToCallback:!0},function(e,t,r,n,o){i.linkToSocialAccount({req:e,accessToken:t,refreshToken:r,profile:n,done:o,provider:"facebook",email:n._json.email,userData:{name:n.name.givenName+" "+n.name.familyName,gender:n._json.gender,picture:"https://graph.facebook.com/"+n.id+"/picture?type=large",location:n._json.location?n._json.location.name:null}})}))}},function(e,t,r){"use strict";var n=r(2),i=r(1),o=r(22),s=r(10),a=r(187).Strategy;r(12);e.exports=function(){i.authKeys.github.clientID&&i.authKeys.github.clientSecret&&s.use("github",new a({clientID:i.authKeys.github.clientID,clientSecret:i.authKeys.github.clientSecret,callbackURL:"/auth/github/callback",scope:["user:email"],passReqToCallback:!0},function(e,t,r,i,s){n.info("Received profile: ",i);var a=void 0;i.emails&&i.emails.length>0&&((a=i.emails.find(function(e){return e.primary}))||(a=i.emails[0])),o.linkToSocialAccount({req:e,accessToken:t,refreshToken:r,profile:i,done:s,provider:"github",username:i.username,email:a?a.value:null,userData:{name:i.displayName,gender:null,picture:i._json.avatar_url,location:i._json.location}})}))}},function(e,t,r){"use strict";var n=(r(2),r(1)),i=r(22),o=r(10),s=r(188).OAuth2Strategy;r(12);e.exports=function(){n.authKeys.google.clientID&&n.authKeys.google.clientSecret&&o.use("google",new s({clientID:n.authKeys.google.clientID,clientSecret:n.authKeys.google.clientSecret,callbackURL:"/auth/google/callback",passReqToCallback:!0},function(e,t,r,n,o){i.linkToSocialAccount({req:e,accessToken:t,refreshToken:r,profile:n,done:o,provider:"google",email:n.emails[0].value,userData:{name:n.displayName,gender:n.gender,picture:n.photos&&n.photos.length>0?n.photos[0].value.replace("sz=50","sz=200"):null,location:null}})}))}},function(e,t,r){"use strict";var n=r(10),i=r(189).Strategy,o=r(12);e.exports=function(){n.use(new i({usernameField:"username",passwordField:"password",passReqToCallback:!0},function(e,t,r,n){return o.findOne({$or:[{username:t},{email:t}]},function(t,i){return t?n(t):i?i.verified?1!==i.status?n(null,!1,{message:e.t("UserDisabledOrDeleted")}):i.passwordLess?n(null,!1,{message:e.t("PasswordlessAccountLeaveEmpty")}):void i.comparePassword(r,function(t,r){return t?n(t):!0!==r?n(null,!1,{message:e.t("InvalidPassword")}):n(null,i)}):n(null,!1,{message:e.t("PleaseActivateAccount")}):n(null,!1,{message:e.t("UnknowUsernameOrEmail")})})}))}},function(e,t,r){"use strict";var n=(r(2),r(1)),i=r(22),o=r(10),s=r(191).Strategy;r(12);e.exports=function(){n.authKeys.twitter.clientID&&n.authKeys.twitter.clientSecret&&o.use("twitter",new s({consumerKey:n.authKeys.twitter.clientID,consumerSecret:n.authKeys.twitter.clientSecret,callbackURL:"/auth/twitter/callback",passReqToCallback:!0},function(e,t,r,n,o){i.linkToSocialAccount({req:e,accessToken:t,refreshToken:r,profile:n,done:o,provider:"twitter",email:n.username+"@twitter.com",username:n.username,userData:{name:n.displayName,gender:null,picture:n._json.profile_image_url_https,location:n._json.location}})}))}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(r(1),r(2)),s=(r(32),r(0),function(){function e(t,r){var i=this;n(this,e),this.cache={},this.prefix=t?t+":":"",this.ttl=r,r&&(this.timer=setInterval(function(){i.checkTTL()},3e4))}return i(e,[{key:"get",value:function(e){var t=this;return new Promise(function(r,n){var i=t.cache[t.prefix+e];i?(o.debug("[Cacher] GET "+t.prefix+e),r(i.data),i.expire=Date.now()+1e3*t.ttl):r(null)})}},{key:"set",value:function(e,t){return this.cache[this.prefix+e]={data:t,expire:Date.now()+1e3*this.ttl},o.debug("[Cacher] SET "+this.prefix+e),Promise.resolve(t)}},{key:"del",value:function(e){return delete this.cache[this.prefix+e],o.debug("[Cacher] DEL "+this.prefix+e),Promise.resolve()}},{key:"clean",value:function(e){return o.debug("[Cacher] CLEAR "+this.prefix+"*"),this.cache={},Promise.resolve()}},{key:"checkTTL",value:function(){var e=this,t=this,r=Date.now();Object.keys(this.cache).forEach(function(n){var i=e.cache[n];i.expire&&i.expire<r&&(o.debug("[Cacher] EXPIRED "+n),delete t.cache[n])})}}]),e}());e.exports=s},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(r(1),r(2)),s=r(32),a=r(0),u=function(){function e(t,r){n(this,e),o.debug("Redis Cacher created. Prefix: "+t),this.prefix=t?t+":":"",this.ttl=r}return i(e,[{key:"get",value:function(e){return s.get(this.prefix+e).then(function(e){if(e)try{return JSON.parse(e)}catch(e){o.error("Redis result parse error!",e)}return e})}},{key:"set",value:function(e,t){return a.isObject(t)&&(t=JSON.stringify(t)),this.ttl?s.setex(this.prefix+e,this.ttl,t):s.set(this.prefix+e,t)}},{key:"del",value:function(e){return s.del(this.prefix+e,function(e){e&&o.error("Redis `del` error!",e)}),Promise.resolve()}},{key:"clean",value:function(e){var t=this;return function r(n,i){s.scan(n,"MATCH",t.prefix+(e||"*"),"COUNT",100,function(e,t){if(e)return i(e);var n=parseInt(t[0]),o=t[1];if(!n&&!o.length)return i(null);s.del(o,function(e){return e?i(e):n?void r(n,i):i(null)})})}(0,function(e){e&&o.error("Redis `scanDel` error!",e)}),Promise.resolve()}}]),e}();e.exports=u},function(e,t,r){"use strict";var n=(r(1),r(2),r(32),r(0),r(137)),i=r(138);e.exports=function(e,t,r){switch(e){case"redis":return new i(t,r);default:return new n(t,r)}}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(r(2),r(1),r(23)),s=r(39),a=r(9),u=(r(33),r(0)),l=(r(74),void 0),c=function(){function e(t){n(this,e),this.id=s(),this.createdAt=Date.now(),this.service=t,this.io=t.io,this.app=null,this.req=null,this.res=null,this.action=null,this.t=null,this.user=null,this.socket=null,this.params=[],this.model=null,this.modelID=null,this.provider="internal",this.validationErrors=[],l||(l=r(16))}return i(e,[{key:"services",value:function(e){return l.get(e)}},{key:"copy",value:function(t,r){var n=u.defaults(new e(this.service),this);return n.provider="internal",n.params=!0===r?u.defaults(this.params,t):t,n}},{key:"responseTime",value:function(){return Date.now()-this.createdAt}},{key:"resolveModel",value:function(){var e=this;if(u.isFunction(this.service.modelResolver)){var t=this.service.$settings.idParamName||"id",r=this.params[t];if(null!=r)return this.service.modelResolver.call(this.service,this,r).then(function(t){return e.model=t,t})}return Promise.resolve(null)}},{key:"assertModelIsExist",value:function(e){if(!this.model)throw this.errorBadRequest(a.ERR_MODEL_NOT_FOUND,e);return!0}},{key:"checkPermission",value:function(){var e=this,t=this.action.permission||this.service.$settings.permission||a.PERM_LOGGEDIN;return t==a.PERM_PUBLIC?Promise.resolve():Promise.resolve().then(function(){}).then(function(){}).then(function(){if(t==a.PERM_OWNER&&u.isFunction(e.service.$schema.ownerChecker))return e.service.$schema.ownerChecker(e).catch(function(t){if(u.isObject(t))throw t;e.errorForbidden(a.ERR_ONLY_OWNER_CAN_EDIT_AND_DELETE,e.t("app:YouAreNotTheOwner"))})})}},{key:"broadcast",value:function(e,t){}},{key:"emitUser",value:function(e,t){}},{key:"emit",value:function(e,t,r){}},{key:"hasParam",value:function(e,t){return null!=this.params[e]}},{key:"validateParam",value:function(e,t){var r=this,n={name:e,value:null,errors:[]};n.noError=function(){return 0==n.errors.length},n.addError=function(e){n.errors.push(e),r.validationErrors.push(e)},n.end=function(){return n.noError()&&(r.params[n.name]=n.value),n.value},n.throw=function(){if(!n.noError())throw new Error(n.errors.join(" "));return n.value},n.notEmpty=function(t){return null!=n.value&&""!==n.value||n.addError(t||"Parameter '"+e+"' is empty!"),u.isArray(n.value)&&0==n.value.length&&n.addError(t||"Parameter '"+e+"' is empty!"),n},n.isNumber=function(e){return null==n.value||u.isNumber(n.value)},n.trim=function(){return n.noError()&&null!=n.value&&(n.value=n.value.trim()),n};var i=this.params[e];return null!=i&&(n.value=i),n}},{key:"hasValidationErrors",value:function(){return this.validationErrors.length>0}},{key:"errorBadRequest",value:function(e,t){var r=new Error(t);throw r=u.defaults(o.BAD_REQUEST),e&&(r.type=e),t&&(r.message=t),r}},{key:"errorForbidden",value:function(e,t){var r=new Error(t);throw r=u.defaults(o.FORBIDDEN),e&&(r.type=e),t&&(r.message=t),r}},{key:"errorUnauthorized",value:function(e,t){var r=new Error(t);throw r=u.defaults(o.UNAUTHORIZED),e&&(r.type=e),t&&(r.message=t),r}},{key:"notifyChanges",value:function(e,t,r){var n={status:200,event:e,data:t};if(this.user){var i=this.services("persons");n.user=i.toJSON(this.user)}this.emit(e,n,r)}},{key:"queryPageSort",value:function(e){return this.params&&(this.params.limit&&e.limit(this.params.limit),this.params.offset&&e.skip(this.params.offset),this.params.sort&&e.sort(this.params.sort.replace(/,/," "))),e}},{key:"isAuthenticated",value:function(e){return null!=this.user}},{key:"hasRole",value:function(e){return this.user&&-1!=this.user.roles.indexOf(e)}},{key:"isAdmin",value:function(){return this.user&&this.hasRole(a.ROLE_ADMIN)}}],[{key:"CreateFromREST",value:function(t,r,n,i,o){var s=new e(t);return s.provider="rest",s.app=n,s.req=i,s.res=o,s.t=i.t,s.user=i.user,s.params=u.defaults({},i.query,i.params,i.body),s.action=r,s}},{key:"CreateFromSocket",value:function(t,r,n,i,o){return new e(t)}},{key:"CreateFromGraphQL",value:function(t,r,n,i,o){var s=new e(t);return s.provider="graphql",s.t=o.t,s.params=i,s.user=o.user,s.action=r,o.ctx=s,s}},{key:"CreateToServiceInit",value:function(t){var r=new e(t);return r.provider="",r.app=t.$app,r}}]),e}();e.exports=c},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(2),s=r(1),a=(r(33),r(9)),u=r(0),l=r(74),c=r(139),p=void 0,h=function(e){o.warn("[Service warn]: "+e)},d=function(e){throw new Error("[Service warn]: "+e)},f=function(){function e(t,i,o){n(this,e);var l=this;t=t||{},l.$schema=t,l.$app=i,l.$db=o,p||(p=r(16)),t.settings||d("No settings of service '"+l.name+"'! Please create a settings object in service schema!");var f=u.defaultsDeep(t.settings,{version:1,namespace:"",internal:!1,rest:!1,ws:!1,graphql:!1,permission:a.PERM_LOGGEDIN,role:a.ROLE_USER,idParamName:"code",modelPropFilter:null});if(l.$settings=f,l.name=f.name,l.version=f.version,l.namespace=f.namespace,l.collection=f.collection,l.name||d("No name of service '"+l.name+"'! Please set in settings of service schema!"),!l.namespace&&(f.rest||f.ws||f.graphql)&&d("No namespace of service '"+l.name+"'! Please set in settings of service schema!"),s.cacheTimeout){var m=s.redis.enabled?"redis":"memory";l.$cacher=new c(m,l.name,s.cacheTimeout)}var y=function(e,t){return function(r){var n=l.getCacheKey(e.name,r.params);return l.getFromCache(n).then(function(e){return null!=e?e:t(r).then(function(e){return l.putToCache(n,e),e})})}};t.actions&&u.isObject(t.actions)&&(l.actions={},u.forIn(t.actions,function(e,t){if(u.isFunction(e)&&(e={handler:e,name:t}),u.isFunction(e.handler)){var r=e.handler.bind(l);e.cache&&(r=y(e,r)),l.actions[t]=r}l.actions[t].settings=e,l.actions[t].settings.name=l.actions[t].settings.name||t,delete l.actions[t].settings.handler})),t.methods&&u.isObject(t.methods)&&u.forIn(t.methods,function(e,t){return-1!=["name","version","namespace","collection","actions"].indexOf(t)?void h("Invalid method name '"+t+"' in '"+l.name+"' service! Skipping..."):-1!=["toJSON","getByID","modelResolver"].indexOf(t)?void h("This method name '"+t+"' is prohibited under 'methods' object. If you want to override the built-in method, please declare in the root of service schema! Skipping..."):void(l[t]=e.bind(l))}),["toJSON","getByID","modelResolver"].forEach(function(e){u.isFunction(t[e])&&(l["__"+e]=l[e],l[e]=t[e].bind(l))})}return i(e,[{key:"toJSON",value:function(e,t){var r=function(e){var r=e.toJSON();return null!=t?u.pick(r,t):r};return null==t&&(t=this.$settings.modelPropFilter),u.isString(t)&&(t=t.split(" ")),u.isArray(e)?u.map(e,function(e){return r(e,t)}):u.isObject(e)?r(e):void 0}},{key:"populateModels",value:function(e,t){if(t=t||this.$settings.modelPopulates,null!=e&&t){var r=[];if(u.forIn(t,function(t,n){if(u.isString(t)){var i=p.get(t);if(i&&u.isFunction(i.getByID)){(u.isArray(e)?e:[e]).forEach(function(e){r.push(i.getByID(e[n]).then(function(t){e[n]=t}))})}}}),r.length>0)return Promise.all(r).then(function(){return e})}return Promise.resolve(e)}},{key:"getByID",value:function(e){var t=this;if(null==this.collection||null==e)return Promise.resolve();if(u.isArray(e)&&0==e.length)return Promise.resolve([]);var r=s.cacheTimeout?this.getCacheKey("model",e):null;return Promise.resolve().then(function(){return r?t.getFromCache(r):null}).then(function(n){if(n)return n;var i=void 0;return i=u.isArray(e)?t.collection.find({_id:{$in:e}}):t.collection.findById(e),i.exec().then(function(e){return t.toJSON(e)}).then(function(e){return t.populateModels(e)}).then(function(e){return r&&t.putToCache(r,e),e})})}},{key:"modelResolver",value:function(e,t){if(null==this.collection)return Promise.resolve();var r=void 0;return r=u.isFunction(this.collection.schema.methods.decodeID)?this.collection.schema.methods.decodeID(t):t,e.modelID=r,null==r||""==r?e.errorBadRequest(a.ERR_INVALID_CODE,e.t("app:InvalidCode")):this.getByID(r)}},{key:"decodeID",value:function(e){if(u.isFunction(this.collection.schema.methods.decodeID))return this.collection.schema.methods.decodeID(e);throw new Error("'decodeID' method not implemented in '"+this.name+"' service!")}},{key:"encodeID",value:function(e){if(u.isFunction(this.collection.schema.methods.encodeID))return this.collection.schema.methods.encodeID(e);throw new Error("'encodeID' method not implemented in '"+this.name+"' service!")}},{key:"getCacheKey",value:function(e,t){return(e?e+":":"")+(t?l(t):"")}},{key:"getFromCache",value:function(e){return this.$cacher?this.$cacher.get(e):Promise.resolve(null)}},{key:"putToCache",value:function(e,t){return this.$cacher?this.$cacher.set(e,t):Promise.resolve()}},{key:"clearCache",value:function(){return this.$cacher?this.$cacher.clean():Promise.resolve()}},{key:"notifyModelChanges",value:function(e,t,r){e.notifyChanges(t,r,this.$settings.role),p.emit(this.name+":"+t,{ctx:e,payload:r}),this.clearCache()}},{key:"services",value:function(e){return p.get(e)}}]),e}();e.exports=f},function(e,t,r){"use strict";var n=r(174),i=r(1);e.exports=function(e,t){return new n(e+i.hashSecret,t||10)}},function(e,t,r){"use strict";function n(){var e={};return i.authKeys&&(i.authKeys.google&&i.authKeys.google.clientID&&(e.google=!0),i.authKeys.facebook&&i.authKeys.facebook.clientID&&(e.facebook=!0),i.authKeys.github&&i.authKeys.github.clientID&&(e.github=!0),i.authKeys.twitter&&i.authKeys.twitter.clientID&&(e.twitter=!0)),Object.keys(e).length>0?e:null}var i=r(1),o=r(2),s=r(9),a=r(39),u=r(34),l=r(62),c=(r(10),r(35),r(23)),p=r(53);e.exports=function(e,t){e.get("/login",function(e,t){if(null!=e.user)return t.redirect("/");t.render("account/login",{socialAuth:n()})}),e.get("/logout",function(e,t){e.logout(),e.session.destroy(),t.redirect("/")}),e.get("/signup",function(e,t){if(!0===i.features.disableSignUp)return t.redirect("/login");t.render("account/signup",{socialAuth:n()})}),e.post("/signup",function(e,t){if(!0===i.features.disableSignUp)return t.redirect("/");e.assert("name",e.t("NameCannotBeEmpty")).notEmpty(),e.assert("email",e.t("EmailCannotBeEmpty")).notEmpty(),e.assert("email",e.t("EmailIsNotValid")).isEmail(),e.sanitize("email").normalizeEmail({remove_dots:!1}),e.body.username||(e.body.username=e.body.email),e.sanitize("passwordless").toBoolean();var r=!0===e.body.passwordless;r||(e.assert("password",e.t("PasswordCannotBeEmpty")).notEmpty(),e.assert("password",e.t("PasswordTooShort")).len(6));var n=e.validationErrors();if(n)return e.flash("error",n),t.redirect("/signup");l.waterfall([function(e){i.features.verificationRequired?u.randomBytes(25,function(t,r){e(t,t?null:r.toString("hex"))}):e(null,null)},function(t,n){r?u.randomBytes(25,function(e,r){n(e,t,e?null:r.toString("hex"))}):n(null,t,e.body.password)},function(t,n,i){var o=new User({fullName:e.body.name,email:e.body.email,username:e.body.username,password:n,passwordLess:r,roles:[s.ROLE_USER],provider:"local"});t?(o.verified=!1,o.verifyToken=t):o.verified=!0,o.save(function(t,r){if(t&&11e3===t.code){var n=t.message.split(".$")[1];n=n.split(" dup key")[0],n=n.substring(0,n.lastIndexOf("_")),"email"==n?e.flash("error",{msg:e.t("EmailIsExists")}):e.flash("error",{msg:e.t("UsernameIsExists")})}i(t,r)})},function(r,n){if(r.verified){var o=e.t("mailSubjectWelcome",i);t.render("mail/welcome",{name:r.fullName},function(e,t){if(e)return n(e);p.send(r.email,o,t,function(e,t){n(null,r)})})}else{var s=e.t("mailSubjectActivate",i);t.render("mail/accountVerify",{name:r.fullName,validateLink:"http://"+e.headers.host+"/verify/"+r.verifyToken},function(t,i){if(t)return n(t);p.send(r.email,s,i,function(t,i){t?e.flash("error",{msg:e.t("UnableToSendEmail",r)}):e.flash("info",{msg:e.t("emailSentVerifyLink")}),n(t,r)})})}}],function(r,n){if(r)return o.error(r),t.redirect("back");n.verified?e.login(n,function(e){return e&&o.error(e),t.redirect("/")}):t.redirect("/login")})}),e.get("/verify/:token",function(e,t){if(e.isAuthenticated())return t.redirect("/");l.waterfall([function(t){User.findOne({verifyToken:e.params.token}).exec(function(r,n){return r?t(r):n?(n.verified=!0,n.verifyToken=void 0,n.lastLogin=Date.now(),void n.save(function(r){if(r)return e.flash("error",{msg:e.t("UnableModifyAccountDetails")}),t(r);t(null,n)})):(e.flash("error",{msg:e.t("AccountVerificationExpired")}),t("Verification is invalid!"))})},function(r,n){var o=e.t("mailSubjectWelcome",i);t.render("mail/welcome",{name:r.fullName},function(e,t){if(e)return n(e);p.send(r.email,o,t,function(e,t){n(null,r)})})},function(t,r){e.login(t,function(e){r(e,t)})}],function(e){if(e)return o.error(e),t.redirect("/signup");t.redirect("/")})}),e.get("/passwordless/:token",function(e,t){if(e.isAuthenticated())return t.redirect("/");l.waterfall([function(t){User.findOne({passwordLessToken:e.params.token}).exec(function(r,n){return r?t(r):n?(n.passwordLessToken=void 0,n.verified||(n.verified=!0,n.verifyToken=void 0),n.lastLogin=Date.now(),void n.save(function(r){if(r)return e.flash("error",{msg:e.t("UnableModifyAccountDetails")}),t(r);t(null,n)})):(e.flash("error",{msg:e.t("PasswordlessTokenExpired")}),t("Token is invalid!"))})},function(t,r){e.login(t,function(e){r(e,t)})}],function(e){if(e)return o.error(e),t.redirect("/login");t.redirect("/")})}),e.get("/forgot",function(e,t){if(e.isAuthenticated())return t.redirect("/");t.render("account/forgot")}),e.post("/forgot",function(e,t){e.assert("email",e.t("EmailIsNotValid")).isEmail(),e.assert("email",e.t("EmailCannotBeEmpty")).notEmpty(),e.sanitize("email").normalizeEmail({remove_dots:!1});var r=e.validationErrors();if(r)return e.flash("error",r),t.redirect("back");l.waterfall([function(e){u.randomBytes(25,function(t,r){e(t,t?null:r.toString("hex"))})},function(t,r){User.findOne({email:e.body.email},function(n,i){return i?1!==i.status?(e.flash("error",{msg:e.t("UserDisabledOrDeleted")}),r(e.t("UserDisabledOrDeleted"))):(i.resetPasswordToken=t,i.resetPasswordExpires=Date.now()+36e5,void i.save(function(e){r(e,t,i)})):(e.flash("error",{msg:e.t("EmailNotAssociatedToAccount",e.body)}),r("Email address "+e.body.email+" is not registered!"))})},function(r,n,o){var s=e.t("mailSubjectResetPassword",i);t.render("mail/passwordReset",{name:n.fullName,resetLink:"http://"+e.headers.host+"/reset/"+r},function(t,r){if(t)return o(t);p.send(n.email,s,r,function(t,r){t?e.flash("error",{msg:e.t("UnableToSendEmail",n)}):e.flash("info",{msg:e.t("emailSentPasswordResetLink",n)}),o(t)})})}],function(e){e&&o.error(e),t.redirect("back")})}),e.get("/reset/:token",function(e,t,r){if(e.isAuthenticated())return t.redirect("/");User.findOne({resetPasswordToken:e.params.token}).where("resetPasswordExpires").gt(Date.now()).exec(function(n,i){return n?r(n):i?void t.render("account/reset"):(e.flash("error",{msg:e.t("PasswordResetTokenExpired")}),t.redirect("/forgot"))})}),e.post("/reset/:token",function(e,t,r){e.assert("password",e.t("PasswordTooShort")).len(6),e.assert("confirm",e.t("PasswordNotMatched")).equals(e.body.password);var n=e.validationErrors();if(n)return e.flash("error",n),t.redirect("back");l.waterfall([function(t){User.findOne({resetPasswordToken:e.params.token}).where("resetPasswordExpires").gt(Date.now()).exec(function(r,n){return r?t(r):n?(n.passwordLess&&(n.passwordLess=!1),n.password=e.body.password,n.resetPasswordToken=void 0,n.resetPasswordExpires=void 0,n.lastLogin=Date.now(),void n.save(function(r){if(r)return t(r);e.login(n,function(e){t(e,n)})})):(e.flash("error",{msg:e.t("PasswordResetTokenExpired")}),t("Password reset token is invalid or has expired."))})},function(r,n){var o=e.t("mailSubjectPasswordChanged",i);t.render("mail/passwordChange",{name:r.fullName},function(t,i){if(t)return n(t);p.send(r.email,o,i,function(t,i){t?e.flash("error",{msg:e.t("UnableToSendEmail",r)}):e.flash("info",{msg:e.t("PasswordChanged")}),n(t)})})}],function(e){if(e)return o.error(e),t.redirect("back");t.redirect("/")})}),e.get("/generateAPIKey",function(e,t){if(!e.isAuthenticated())return c.json(t,null,c.UNAUTHORIZED);User.findById(e.user.id).exec(function(r,n){return r?c.json(t,null,c.SERVER_ERROR):n?(n.apiKey=a(),void n.save(function(e){return e?c.json(t,null,c.SERVER_ERROR):c.json(t,n)})):c.json(t,null,c.NOT_FOUND,e.t("InvalidUser"))})}),e.get("/unlink/:provider",function(e,t){return e.isAuthenticated()?e.params.provider&&-1!==["facebook","twitter","google","github"].indexOf(e.params.provider)?void User.findById(e.user.id).exec(function(r,n){return r?c.json(t,null,c.SERVER_ERROR):n?(n.socialLinks[e.params.provider]=void 0,void n.save(function(e){return e?c.json(t,null,c.SERVER_ERROR):c.json(t,n)})):c.json(t,null,c.NOT_FOUND,e.t("InvalidUser"))}):c.json(t,null,c.BAD_REQUEST,e.t("InvalidOAuthProvider")):c.json(t,null,c.UNAUTHORIZED)})}},function(e,t,r){"use strict";var n=r(1),i=(r(2),r(34),r(62),r(10),r(35)),o=(r(53),r(12),r(23),r(75));e.exports=function(e,t){var r=i.Router();r.post("/local",function(e,t,r){console.log(e.body);var i={user:e.body.user,password:e.body.password,api_key:n.t1API.api_key},s=new o.T1Connection(i);s.ensureAuthenticated().then(function(r){s.cookieAuthed?(console.log(s),e.user=e.user||{},e.user.t1conn=s,t.send({auth:!0})):(console.log(s),t.send({auth:!1,message:"Authentication Failed. Please try again."}))}).catch(function(e){console.log("error",e)})}),e.use("/auth",r)}},function(e,t,r){"use strict";var n=r(1),i=r(2),o=r(23);e.exports=function(e,t){e.use(function(e,t,r,n){return e?(i.error(e.stack),r.status(e.status||500),t.accepts("html")?r.render("500",{url:t.originalUrl,error:e}):t.accepts("json")?o.json(r,null,o.SERVER_ERROR,e.message):void 0):n()}),e.use(function(e,t){if(t.status(404),n.isTestMode()||i.warn("404 error! URL:",e.url),e.accepts("html")){var r=new Error("404 Page Not Found");return r.status=404,t.render("404",{url:e.originalUrl,error:r})}if(e.accepts("json"))return o.json(t,null,o.NOT_FOUND)})}},function(e,t,r){"use strict";r(1),r(2);e.exports=function(e,t){e.get("/health",function(e,t){t.sendStatus(200)})}},function(e,t,r){"use strict";r(1),r(2),r(7);e.exports=function(e,t){e.get("/",function(e,t){console.log(e.params),t.render("main")}),r(146)(e,t),r(143)(e,t),r(144)(e,t),r(16).registerRoutes(e,t),r(145)(e,t)}},function(e,t,r){"use strict";var n=r(2),i=r(1),o=(r(9),r(70)),s=r(71).htmlToText;e.exports={settings:{name:"mailer",internal:!0},methods:{send:function(e,t,a){return new Promise(function(u,l){n.info("Sending email to "+e+" with subject "+t+"...");var c={from:i.mailer.from,to:e,subject:t,html:a},p=void 0;if("smtp"==i.mailer.transport)p=o.createTransport(i.mailer.smtp);else if("mailgun"==i.mailer.transport){var h=r(72);p=o.createTransport(h({auth:{api_key:i.mailer.mailgun.apiKey,domain:i.mailer.mailgun.domain}}))}else if("sendgrid"==i.mailer.transport){var d=r(73);p=o.createTransport(d({auth:{api_key:i.mailer.sendgrid.apiKey}}))}p?(p.use("compile",s()),p.sendMail(c,function(e,t){e?(n.warn("Unable to send email: ",e),l(e)):(n.info("Email message sent.",t.response),u(t))})):l(new Error("Unable to send email! Invalid mailer transport: "+i.mailer.transport))})}},init:function(e){}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return(0,s.default)(e,"Received null or undefined error."),{message:e.message,locations:e.locations,path:e.path}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatError=i;var o=r(152),s=n(o)},function(e,t,r){"use strict";function n(e,t,r){if(e&&e.path)return e;var n=e?e.message||String(e):"An unknown error occurred.";return new i.GraphQLError(n,e&&e.nodes||t,e&&e.source,e&&e.positions,r,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.locatedError=n;var i=r(40)},function(e,t,r){"use strict";function n(e,t,r){var n=(0,s.getLocation)(e,t);return new a.GraphQLError("Syntax Error "+e.name+" ("+n.line+":"+n.column+") "+r+"\n\n"+i(e,n),void 0,e,[t])}function i(e,t){var r=t.line,n=(r-1).toString(),i=r.toString(),s=(r+1).toString(),a=s.length,u=e.body.split(/\r\n|[\n\r]/g);return(r>=2?o(a,n)+": "+u[r-2]+"\n":"")+o(a,i)+": "+u[r-1]+"\n"+Array(2+a+t.column).join(" ")+"^\n"+(r<u.length?o(a,s)+": "+u[r]+"\n":"")}function o(e,t){return Array(e-t.length+1).join(" ")+t}Object.defineProperty(t,"__esModule",{value:!0}),t.syntaxError=n;var s=r(58),a=r(40)},function(e,t,r){"use strict";function n(e,t){if(!e)throw new Error(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";function n(e,t){var r="string"==typeof e?new oe.Source(e):e;return a((0,ae.createLexer)(r,t||{}))}function i(e,t){var r="string"==typeof e?new oe.Source(e):e,n=(0,ae.createLexer)(r,t||{});ee(n,ae.TokenKind.SOF);var i=T(n,!1);return ee(n,ae.TokenKind.EOF),i}function o(e,t){var r="string"==typeof e?new oe.Source(e):e,n=(0,ae.createLexer)(r,t||{});ee(n,ae.TokenKind.SOF);var i=q(n);return ee(n,ae.TokenKind.EOF),i}function s(e){var t=ee(e,ae.TokenKind.NAME);return{kind:ue.NAME,value:t.value,loc:W(e,t)}}function a(e){var t=e.token;ee(e,ae.TokenKind.SOF);var r=[];do{r.push(u(e))}while(!Z(e,ae.TokenKind.EOF));return{kind:ue.DOCUMENT,definitions:r,loc:W(e,t)}}function u(e){if(X(e,ae.TokenKind.BRACE_L))return l(e);if(X(e,ae.TokenKind.NAME))switch(e.token.value){case"query":case"mutation":case"subscription":return l(e);case"fragment":return b(e);case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"extend":case"directive":return D(e)}throw re(e)}function l(e){var t=e.token;if(X(e,ae.TokenKind.BRACE_L))return{kind:ue.OPERATION_DEFINITION,operation:"query",name:null,variableDefinitions:null,directives:[],selectionSet:f(e),loc:W(e,t)};var r=c(e),n=void 0;return X(e,ae.TokenKind.NAME)&&(n=s(e)),{kind:ue.OPERATION_DEFINITION,operation:r,name:n,variableDefinitions:p(e),directives:R(e),selectionSet:f(e),loc:W(e,t)}}function c(e){var t=ee(e,ae.TokenKind.NAME);switch(t.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw re(e,t)}function p(e){return X(e,ae.TokenKind.PAREN_L)?ie(e,ae.TokenKind.PAREN_L,h,ae.TokenKind.PAREN_R):[]}function h(e){var t=e.token;return{kind:ue.VARIABLE_DEFINITION,variable:d(e),type:(ee(e,ae.TokenKind.COLON),q(e)),defaultValue:Z(e,ae.TokenKind.EQUALS)?T(e,!0):null,loc:W(e,t)}}function d(e){var t=e.token;return ee(e,ae.TokenKind.DOLLAR),{kind:ue.VARIABLE,name:s(e),loc:W(e,t)}}function f(e){var t=e.token;return{kind:ue.SELECTION_SET,selections:ie(e,ae.TokenKind.BRACE_L,m,ae.TokenKind.BRACE_R),loc:W(e,t)}}function m(e){return X(e,ae.TokenKind.SPREAD)?v(e):y(e)}function y(e){var t=e.token,r=s(e),n=void 0,i=void 0;return Z(e,ae.TokenKind.COLON)?(n=r,i=s(e)):(n=null,i=r),{kind:ue.FIELD,alias:n,name:i,arguments:g(e),directives:R(e),selectionSet:X(e,ae.TokenKind.BRACE_L)?f(e):null,loc:W(e,t)}}function g(e){return X(e,ae.TokenKind.PAREN_L)?ie(e,ae.TokenKind.PAREN_L,E,ae.TokenKind.PAREN_R):[]}function E(e){var t=e.token;return{kind:ue.ARGUMENT,name:s(e),value:(ee(e,ae.TokenKind.COLON),T(e,!1)),loc:W(e,t)}}function v(e){var t=e.token;if(ee(e,ae.TokenKind.SPREAD),X(e,ae.TokenKind.NAME)&&"on"!==e.token.value)return{kind:ue.FRAGMENT_SPREAD,name:A(e),directives:R(e),loc:W(e,t)};var r=null;return"on"===e.token.value&&(e.advance(),r=k(e)),{kind:ue.INLINE_FRAGMENT,typeCondition:r,directives:R(e),selectionSet:f(e),loc:W(e,t)}}function b(e){var t=e.token;return te(e,"fragment"),{kind:ue.FRAGMENT_DEFINITION,name:A(e),typeCondition:(te(e,"on"),k(e)),directives:R(e),selectionSet:f(e),loc:W(e,t)}}function A(e){if("on"===e.token.value)throw re(e);return s(e)}function T(e,t){var r=e.token;switch(r.kind){case ae.TokenKind.BRACKET_L:return w(e,t);case ae.TokenKind.BRACE_L:return O(e,t);case ae.TokenKind.INT:return e.advance(),{kind:ue.INT,value:r.value,loc:W(e,r)};case ae.TokenKind.FLOAT:return e.advance(),{kind:ue.FLOAT,value:r.value,loc:W(e,r)};case ae.TokenKind.STRING:return e.advance(),{kind:ue.STRING,value:r.value,loc:W(e,r)};case ae.TokenKind.NAME:return"true"===r.value||"false"===r.value?(e.advance(),{kind:ue.BOOLEAN,value:"true"===r.value,loc:W(e,r)}):"null"===r.value?(e.advance(),{kind:ue.NULL,loc:W(e,r)}):(e.advance(),{kind:ue.ENUM,value:r.value,loc:W(e,r)});case ae.TokenKind.DOLLAR:if(!t)return d(e)}throw re(e)}function N(e){return T(e,!0)}function I(e){return T(e,!1)}function w(e,t){var r=e.token,n=t?N:I;return{kind:ue.LIST,values:ne(e,ae.TokenKind.BRACKET_L,n,ae.TokenKind.BRACKET_R),loc:W(e,r)}}function O(e,t){var r=e.token;ee(e,ae.TokenKind.BRACE_L);for(var n=[];!Z(e,ae.TokenKind.BRACE_R);)n.push(_(e,t));return{kind:ue.OBJECT,fields:n,loc:W(e,r)}}function _(e,t){var r=e.token;return{kind:ue.OBJECT_FIELD,name:s(e),value:(ee(e,ae.TokenKind.COLON),T(e,t)),loc:W(e,r)}}function R(e){for(var t=[];X(e,ae.TokenKind.AT);)t.push(S(e));return t}function S(e){var t=e.token;return ee(e,ae.TokenKind.AT),{kind:ue.DIRECTIVE,name:s(e),arguments:g(e),loc:W(e,t)}}function q(e){var t=e.token,r=void 0;return Z(e,ae.TokenKind.BRACKET_L)?(r=q(e),ee(e,ae.TokenKind.BRACKET_R),r={kind:ue.LIST_TYPE,type:r,loc:W(e,t)}):r=k(e),Z(e,ae.TokenKind.BANG)?{kind:ue.NON_NULL_TYPE,type:r,loc:W(e,t)}:r}function k(e){var t=e.token;return{kind:ue.NAMED_TYPE,name:s(e),loc:W(e,t)}}function D(e){if(X(e,ae.TokenKind.NAME))switch(e.token.value){case"schema":return C(e);case"scalar":return M(e);case"type":return x(e);case"interface":return F(e);case"union":return Q(e);case"enum":return V(e);case"input":return G(e);case"extend":return $(e);case"directive":return H(e)}throw re(e)}function C(e){var t=e.token;te(e,"schema");var r=R(e),n=ie(e,ae.TokenKind.BRACE_L,L,ae.TokenKind.BRACE_R);return{kind:ue.SCHEMA_DEFINITION,directives:r,operationTypes:n,loc:W(e,t)}}function L(e){var t=e.token,r=c(e);ee(e,ae.TokenKind.COLON);var n=k(e);return{kind:ue.OPERATION_TYPE_DEFINITION,operation:r,type:n,loc:W(e,t)}}function M(e){var t=e.token;te(e,"scalar");var r=s(e),n=R(e);return{kind:ue.SCALAR_TYPE_DEFINITION,name:r,directives:n,loc:W(e,t)}}function x(e){var t=e.token;te(e,"type");var r=s(e),n=P(e),i=R(e),o=ne(e,ae.TokenKind.BRACE_L,K,ae.TokenKind.BRACE_R);return{kind:ue.OBJECT_TYPE_DEFINITION,name:r,interfaces:n,directives:i,fields:o,loc:W(e,t)}}function P(e){var t=[];if("implements"===e.token.value){e.advance();do{t.push(k(e))}while(X(e,ae.TokenKind.NAME))}return t}function K(e){var t=e.token,r=s(e),n=U(e);ee(e,ae.TokenKind.COLON);var i=q(e),o=R(e);return{kind:ue.FIELD_DEFINITION,name:r,arguments:n,type:i,directives:o,loc:W(e,t)}}function U(e){return X(e,ae.TokenKind.PAREN_L)?ie(e,ae.TokenKind.PAREN_L,j,ae.TokenKind.PAREN_R):[]}function j(e){var t=e.token,r=s(e);ee(e,ae.TokenKind.COLON);var n=q(e),i=null;Z(e,ae.TokenKind.EQUALS)&&(i=N(e));var o=R(e);return{kind:ue.INPUT_VALUE_DEFINITION,name:r,type:n,defaultValue:i,directives:o,loc:W(e,t)}}function F(e){var t=e.token;te(e,"interface");var r=s(e),n=R(e),i=ne(e,ae.TokenKind.BRACE_L,K,ae.TokenKind.BRACE_R);return{kind:ue.INTERFACE_TYPE_DEFINITION,name:r,directives:n,fields:i,loc:W(e,t)}}function Q(e){var t=e.token;te(e,"union");var r=s(e),n=R(e);ee(e,ae.TokenKind.EQUALS);var i=B(e);return{kind:ue.UNION_TYPE_DEFINITION,name:r,directives:n,types:i,loc:W(e,t)}}function B(e){var t=[];do{t.push(k(e))}while(Z(e,ae.TokenKind.PIPE));return t}function V(e){var t=e.token;te(e,"enum");var r=s(e),n=R(e),i=ie(e,ae.TokenKind.BRACE_L,z,ae.TokenKind.BRACE_R);return{kind:ue.ENUM_TYPE_DEFINITION,name:r,directives:n,values:i,loc:W(e,t)}}function z(e){var t=e.token,r=s(e),n=R(e);return{kind:ue.ENUM_VALUE_DEFINITION,name:r,directives:n,loc:W(e,t)}}function G(e){var t=e.token;te(e,"input");var r=s(e),n=R(e),i=ne(e,ae.TokenKind.BRACE_L,j,ae.TokenKind.BRACE_R);return{kind:ue.INPUT_OBJECT_TYPE_DEFINITION,name:r,directives:n,fields:i,loc:W(e,t)}}function $(e){var t=e.token;te(e,"extend");var r=x(e);return{kind:ue.TYPE_EXTENSION_DEFINITION,definition:r,loc:W(e,t)}}function H(e){var t=e.token;te(e,"directive"),ee(e,ae.TokenKind.AT);var r=s(e),n=U(e);te(e,"on");var i=Y(e);return{kind:ue.DIRECTIVE_DEFINITION,name:r,arguments:n,locations:i,loc:W(e,t)}}function Y(e){var t=[];do{t.push(s(e))}while(Z(e,ae.TokenKind.PIPE));return t}function W(e,t){if(!e.options.noLocation)return new J(t,e.lastToken,e.source)}function J(e,t,r){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=r}function X(e,t){return e.token.kind===t}function Z(e,t){var r=e.token.kind===t;return r&&e.advance(),r}function ee(e,t){var r=e.token;if(r.kind===t)return e.advance(),r;throw(0,se.syntaxError)(e.source,r.start,"Expected "+t+", found "+(0,ae.getTokenDesc)(r))}function te(e,t){var r=e.token;if(r.kind===ae.TokenKind.NAME&&r.value===t)return e.advance(),r;throw(0,se.syntaxError)(e.source,r.start,'Expected "'+t+'", found '+(0,ae.getTokenDesc)(r))}function re(e,t){var r=t||e.token;return(0,se.syntaxError)(e.source,r.start,"Unexpected "+(0,ae.getTokenDesc)(r))}function ne(e,t,r,n){ee(e,t);for(var i=[];!Z(e,n);)i.push(r(e));return i}function ie(e,t,r,n){ee(e,t);for(var i=[r(e)];!Z(e,n);)i.push(r(e));return i}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=n,t.parseValue=i,t.parseType=o,t.parseConstValue=N,t.parseTypeReference=q,t.parseNamedType=k;var oe=r(59),se=r(54),ae=r(57),ue=r(56);J.prototype.toJSON=J.prototype.inspect=function(){return{start:this.start,end:this.end}}},function(e,t,r){"use strict";function n(e){return(0,u.visit)(e,{leave:l})}function i(e,t){return e?e.filter(function(e){return e}).join(t||""):""}function o(e){return e&&0!==e.length?a("{\n"+i(e,"\n"))+"\n}":"{}"}function s(e,t,r){return t?e+t+(r||""):""}function a(e){return e&&e.replace(/\n/g,"\n  ")}Object.defineProperty(t,"__esModule",{value:!0}),t.print=n;var u=r(60),l={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return i(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,r=e.name,n=s("(",i(e.variableDefinitions,", "),")"),o=i(e.directives," "),a=e.selectionSet;return r||o||n||"query"!==t?i([t,i([r,n]),o,a]," "):a},VariableDefinition:function(e){return e.variable+": "+e.type+s(" = ",e.defaultValue)},SelectionSet:function(e){return o(e.selections)},Field:function(e){var t=e.alias,r=e.name,n=e.arguments,o=e.directives,a=e.selectionSet;return i([s("",t,": ")+r+s("(",i(n,", "),")"),i(o," "),a]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+s(" ",i(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,r=e.directives,n=e.selectionSet;return i(["...",s("on ",t),i(r," "),n]," ")},FragmentDefinition:function(e){var t=e.name,r=e.typeCondition,n=e.directives,o=e.selectionSet;return"fragment "+t+" on "+r+" "+s("",i(n," ")," ")+o},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e){var t=e.value;return JSON.stringify(t)},BooleanValue:function(e){var t=e.value;return JSON.stringify(t)},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+i(e.values,", ")+"]"},ObjectValue:function(e){return"{"+i(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+s("(",i(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:function(e){var t=e.directives,r=e.operationTypes;return i(["schema",i(t," "),o(r)]," ")},OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:function(e){return i(["scalar",e.name,i(e.directives," ")]," ")},ObjectTypeDefinition:function(e){var t=e.name,r=e.interfaces,n=e.directives,a=e.fields;return i(["type",t,s("implements ",i(r,", ")),i(n," "),o(a)]," ")},FieldDefinition:function(e){var t=e.name,r=e.arguments,n=e.type,o=e.directives;return t+s("(",i(r,", "),")")+": "+n+s(" ",i(o," "))},InputValueDefinition:function(e){var t=e.name,r=e.type,n=e.defaultValue,o=e.directives;return i([t+": "+r,s("= ",n),i(o," ")]," ")},InterfaceTypeDefinition:function(e){var t=e.name,r=e.directives,n=e.fields;return i(["interface",t,i(r," "),o(n)]," ")},UnionTypeDefinition:function(e){var t=e.name,r=e.directives,n=e.types;return i(["union",t,i(r," "),"= "+i(n," | ")]," ")},EnumTypeDefinition:function(e){var t=e.name,r=e.directives,n=e.values;return i(["enum",t,i(r," "),o(n)]," ")},EnumValueDefinition:function(e){return i([e.name,i(e.directives," ")]," ")},InputObjectTypeDefinition:function(e){var t=e.name,r=e.directives,n=e.fields;return i(["input",t,i(r," "),o(n)]," ")},TypeExtensionDefinition:function(e){return"extend "+e.definition},DirectiveDefinition:function(e){var t=e.name,r=e.arguments,n=e.locations;return"directive @"+t+s("(",i(r,", "),")")+" on "+i(n," | ")}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,configurable:!1,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,configurable:!1,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){function n(e){return r(i(e))}function i(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./meta_reports/service.js":122,"./products/service.js":123,"./query_templates/service.js":124,"./report_requests/service.js":125,"./session/service.js":126};n.keys=function(){return Object.keys(o)},n.resolve=i,e.exports=n,n.id=156},function(e,t,r){function n(e){return r(i(e))}function i(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./apikey.js":131,"./facebook.js":132,"./github.js":133,"./google.js":134,"./local.js":135,"./twitter.js":136};n.keys=function(){return Object.keys(o)},n.resolve=i,e.exports=n,n.id=157},function(e,t,r){function n(e){return r(i(e))}function i(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./mailer.js":148};n.keys=function(){return Object.keys(o)},n.resolve=i,e.exports=n,n.id=158},function(e,t){e.exports=require("../config.js")},function(e,t){e.exports=require("agenda")},function(e,t){e.exports=require("bcrypt-nodejs")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cli-table2")},function(e,t){e.exports=require("clui")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("csurf")},function(e,t){e.exports=require("depd")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("express-flash")},function(e,t){e.exports=require("express-list-endpoints")},function(e,t){e.exports=require("express-validator")},function(e,t){e.exports=require("generic-pool")},function(e,t){e.exports=require("graphql")},function(e,t){e.exports=require("hashids")},function(e,t){e.exports=require("helmet")},function(e,t){e.exports=require("helmet-crossdomain")},function(e,t){e.exports=require("inflection")},function(e,t){e.exports=require("ioredis")},function(e,t){e.exports=require("le_node")},function(e,t){e.exports=require("method-override")},function(e,t){e.exports=require("mongoose-auto-increment")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("mysql")},function(e,t){e.exports=require("netjet")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("passport-facebook")},function(e,t){e.exports=require("passport-github")},function(e,t){e.exports=require("passport-google-oauth")},function(e,t){e.exports=require("passport-local")},function(e,t){e.exports=require("passport-localapikey-update")},function(e,t){e.exports=require("passport-twitter")},function(e,t){e.exports=require("pg")},function(e,t){e.exports=require("pretty-bytes")},function(e,t){e.exports=require("retry-as-promised")},function(e,t){e.exports=require("sequelize")},function(e,t){e.exports=require("serve-favicon")},function(e,t){e.exports=require("shimmer")},function(e,t){e.exports=require("socket.io")},function(e,t){e.exports=require("terraformer-wkt-parser")},function(e,t){e.exports=require("toposort-class")},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("uuid-token-generator")},function(e,t){e.exports=require("webpack-dev-middleware")},function(e,t){e.exports=require("webpack-hot-middleware")},function(e,t){e.exports=require("webpack-merge")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("winston-loggly-bulk")},function(e,t){e.exports=require("winston-papertrail")},function(e,t,r){"use strict";global.WEBPACK_BUNDLE=!1;var n=r(1),i=r(2),o=r(11),s=r(13);i.info(),i.info(s.bold("---------------------[ Server starting at %s ]---------------------------"),o().format("YYYY-MM-DD HH:mm:ss.SSS")),i.info(),i.info(s.bold("Application root path: ")+global.rootPath);var a=(r(78),r(17)),u=r(77)(a);r(79),u.listen(n.port,n.ip,function(){i.info(""),i.info(n.app.title+" v"+n.app.version+" application started!"),i.info("----------------------------------------------"),i.info("Environment:\t"+s.underline.bold(process.env.NODE_ENV)),i.info("IP:\t\t"+n.ip),i.info("Port:\t\t"+n.port),i.info("Database:\t\t"+n.sequelize.dag),i.info("Redis:\t\t"+(n.redis.enabled?n.redis.uri:"Disabled")),i.info(""),r(80)(),i.info("----------------------------------------------");r(16)}),e.exports=u}]);